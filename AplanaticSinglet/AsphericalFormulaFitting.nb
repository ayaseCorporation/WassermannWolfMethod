(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     93084,       2318]
NotebookOptionsPosition[     81160,       2104]
NotebookOutlinePosition[     81600,       2122]
CellTagsIndexPosition[     81557,       2119]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["AsphericalFormulaFitting", "Title",
 CellChangeTimes->{{3.817423978837092*^9, 3.817423987461358*^9}, 
   3.823494720450263*^9, {3.82349475279921*^9, 3.823494757850711*^9}, {
   3.823494815858748*^9, 
   3.823494824775649*^9}},ExpressionUUID->"978ba157-4da5-4fa2-839b-\
0bb1fbadd14c"],

Cell["\<\
Takatoshi Yamada@AYASE Co.,Ltd.
e - mail : takatoshi.yamada@ayasecorporation.com
web cite : https : // www.ayasecorporation.com\
\>", "Author",
 CellChangeTimes->{{3.817423896747398*^9, 3.8174239195219517`*^9}, {
   3.817432333562894*^9, 3.817432334218192*^9}, 3.853965488712582*^9, 
   3.854145247402973*^9},ExpressionUUID->"c34abfc9-223c-44da-8acf-\
1d08fcfdb7f6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Package definitions", "Title",
 InitializationCell->True,
 CellChangeTimes->{{3.799464463020203*^9, 
  3.799464469352387*^9}},ExpressionUUID->"7e217897-b1dc-464d-8e04-\
e38a42bcceaa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeginPackage", "[", 
   RowBox[{"\"\<AplanaticSinglet`AsphericalFormulaFitting`\>\"", ",", 
    RowBox[{"{", "\"\<AplanaticSinglet`RayTrace2D`\>\"", "}"}]}], "]"}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.799376616843014*^9, 3.7993766174281387`*^9}, {
   3.799463892374659*^9, 3.799463901385004*^9}, {3.799463943191332*^9, 
   3.7994639601568813`*^9}, {3.8012811158639307`*^9, 
   3.8012811169214573`*^9}, {3.8174240039931507`*^9, 3.817424033523466*^9}, 
   3.818461706512961*^9, 3.818462988174159*^9, 3.818716671788349*^9, 
   3.823494762813017*^9, 
   3.8234948312028008`*^9},ExpressionUUID->"89e3ab7b-a414-485d-8402-\
cc4d4d0d969f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "AsphericalFormulaFittingVersion", "=", 
   "\"\<AsphericalFormulaFitting 0.1A by Takatoshi Yamada, Ayase corp.\>\""}],
   ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.799376616843014*^9, 3.7993766174281387`*^9}, {
  3.799463892374659*^9, 3.799463901385004*^9}, {3.799463943191332*^9, 
  3.7994639601568813`*^9}, {3.8012811158639307`*^9, 3.8012811169214573`*^9}, {
  3.8174240039931507`*^9, 3.817424176588312*^9}, {3.823494837957684*^9, 
  3.8234948402596273`*^9}},ExpressionUUID->"3bad05b0-9dd4-4ace-a929-\
6f716bf5479f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "AsphericalFormulaFittingDescrciption", "=", 
   "\"\<AsphericalFormulaFitting package for converting a lens shape \
expressed by interpolation function into a function in aspherical \
formula.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.799376616843014*^9, 3.7993766174281387`*^9}, {
  3.799463892374659*^9, 3.799463901385004*^9}, {3.799463943191332*^9, 
  3.7994639601568813`*^9}, {3.8012811158639307`*^9, 3.8012811169214573`*^9}, {
  3.8174240039931507`*^9, 3.817424176588312*^9}, {3.82349484573962*^9, 
  3.823494848687791*^9}},ExpressionUUID->"f3e04254-1cf4-479d-ab84-\
0d6de0c23d19"],

Cell[CellGroupData[{

Cell["usage messages", "Section",
 AutoGeneratedPackage->Automatic,
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.797038752561654*^9, 
  3.797038760521872*^9}},ExpressionUUID->"19a18786-c530-4ae9-b95f-\
59ac13da6e89"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "AsphericalFormulaFittingUsage", "=", 
   "\"\<res=fitAsphericalExpression[ff,10]\n\
Plot[{ff[y],fittedAsphericalFunction[res,removeOffset\[Rule]False][y]},\
Evaluate[Flatten[{y,domain2D[ff]}]]]\n\
Plot[ff[y]-fittedAsphericalFunction[res,removeOffset\[Rule]False][y],Evaluate[\
Flatten[{y,domain2D[ff]}]]]\n\
residualEvaluationValues[ff,res,evaluationWavelength\[Rule]0.000532]\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8236395566532373`*^9, 
  3.823639576651039*^9}},ExpressionUUID->"2ef397fa-0ccd-4018-b3ef-\
3953eed2e110"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fitAsphericalExpression", "::", "usage"}], "=", 
   "\"\<fitAsphericalExpression[f_InterpolatingFunction,heighestOrder_?\
IntegerQ] returns list of fitting result rules. Other argument \
styles,fitAsphericalExpression[f_InterpolatingFunction,paraxialCurvature_?\
NumericQ,heighestOrder_?IntegerQ], \
fitAsphericalExpression[f_InterpolatingFunction,paraxialCurvature_?NumericQ,\
conic_?NumericQ,heighestOrder_?IntegerQ] or \
fitAsphericalExpression[shape:{{_?NumericQ,_?NumericQ}..},paraxialCurvature_?\
NumericQ,conicConstant_?NumericQ,heighestOrder_?IntegerQ] etc...\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.823638984895525*^9, 
  3.823639097084944*^9}},ExpressionUUID->"8d629569-0b32-4764-a594-\
70cade7edbad"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"constantOffset", "::", "usage"}], "=", 
   "\"\<constantOffset is a result tag of fitAsphericalExpression that \
represents constant offset along optical axis.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7994639900829077`*^9, 3.799464273324094*^9}, 
   3.7994643343914957`*^9, {3.799464782800934*^9, 3.799464795289186*^9}, {
   3.799465664049143*^9, 3.7994656808489733`*^9}, {3.799465712381198*^9, 
   3.799465712931284*^9}, {3.7994657834949102`*^9, 3.799465846586969*^9}, {
   3.799466376383222*^9, 3.7994663834931507`*^9}, {3.80042989956811*^9, 
   3.8004299117685328`*^9}, {3.823495311557651*^9, 3.823495337649867*^9}, {
   3.823495388441886*^9, 3.823495401784886*^9}, {3.82349545356562*^9, 
   3.8234955084441442`*^9}, {3.823495552731843*^9, 3.8234955878284492`*^9}, {
   3.823496748822419*^9, 3.823496977454934*^9}, {3.823545166105153*^9, 
   3.823545187191884*^9}, {3.823545638456933*^9, 
   3.8235458444889097`*^9}},ExpressionUUID->"3bb45ec5-a5e8-402c-8f50-\
92154f9d6073"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"curvature", "::", "usage"}], "=", 
   "\"\<curvature is a result tag of fitAsphericalExpression that represents \
paraxial curvature.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7994639900829077`*^9, 3.799464273324094*^9}, 
   3.7994643343914957`*^9, {3.799464782800934*^9, 3.799464795289186*^9}, {
   3.799465664049143*^9, 3.7994656808489733`*^9}, {3.799465712381198*^9, 
   3.799465712931284*^9}, {3.7994657834949102`*^9, 3.799465846586969*^9}, {
   3.799466376383222*^9, 3.7994663834931507`*^9}, {3.80042989956811*^9, 
   3.8004299117685328`*^9}, {3.823495311557651*^9, 3.823495337649867*^9}, {
   3.823495388441886*^9, 3.823495401784886*^9}, {3.82349545356562*^9, 
   3.8234955084441442`*^9}, {3.823495552731843*^9, 3.8234955878284492`*^9}, {
   3.823496748822419*^9, 3.823496977454934*^9}, {3.823545166105153*^9, 
   3.823545187191884*^9}, {3.823545638456933*^9, 3.823545845833721*^9}, {
   3.823550169522579*^9, 
   3.8235501723656893`*^9}},ExpressionUUID->"150d3b25-37ca-4a0a-af58-\
3d71118209c7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"conicConstant", "::", "usage"}], "=", 
   "\"\<conicConstant is a result tag of fitAsphericalExpression that \
represents conic constant.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7994639900829077`*^9, 3.799464273324094*^9}, 
   3.7994643343914957`*^9, {3.799464782800934*^9, 3.799464795289186*^9}, {
   3.799465664049143*^9, 3.7994656808489733`*^9}, {3.799465712381198*^9, 
   3.799465712931284*^9}, {3.7994657834949102`*^9, 3.799465846586969*^9}, {
   3.799466376383222*^9, 3.7994663834931507`*^9}, {3.80042989956811*^9, 
   3.8004299117685328`*^9}, {3.823495311557651*^9, 3.823495337649867*^9}, {
   3.823495388441886*^9, 3.823495401784886*^9}, {3.82349545356562*^9, 
   3.8234955084441442`*^9}, {3.823495552731843*^9, 3.8234955878284492`*^9}, {
   3.823496748822419*^9, 3.823496977454934*^9}, {3.823545166105153*^9, 
   3.823545187191884*^9}, {3.823545638456933*^9, 
   3.823545847706993*^9}},ExpressionUUID->"7ba89eff-a37a-4fe1-8000-\
c6d097e11879"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"powerSeriesCoefficients", "::", "usage"}], "=", 
   "\"\<powerSeriesCoefficients is a result tag of fitAsphericalExpression \
that represents power series coefficients. powerSeriesCoefficients[n] \
specifies coefficient value of n-th power.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7994639900829077`*^9, 3.799464273324094*^9}, 
   3.7994643343914957`*^9, {3.799464782800934*^9, 3.799464795289186*^9}, {
   3.799465664049143*^9, 3.7994656808489733`*^9}, {3.799465712381198*^9, 
   3.799465712931284*^9}, {3.7994657834949102`*^9, 3.799465846586969*^9}, {
   3.799466376383222*^9, 3.7994663834931507`*^9}, {3.80042989956811*^9, 
   3.8004299117685328`*^9}, {3.823495311557651*^9, 3.823495337649867*^9}, {
   3.823495388441886*^9, 3.823495401784886*^9}, {3.82349545356562*^9, 
   3.8234955084441442`*^9}, {3.823495552731843*^9, 3.8234955878284492`*^9}, {
   3.823496748822419*^9, 3.823496977454934*^9}, {3.823545166105153*^9, 
   3.823545187191884*^9}, {3.823545638456933*^9, 
   3.823545875865602*^9}},ExpressionUUID->"bc5b0dd9-714d-499a-a715-\
564f4373b3c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"normalizationHeight", "::", "usage"}], "=", 
   "\"\<normalizationHeight is a result tag of fitAsphericalExpression that \
represents normalized height for power series. When power series order is \
higher than 14-th, the variable 'y' should be normalized for avoiding \
cancellation of significant digits.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7994639900829077`*^9, 3.799464273324094*^9}, 
   3.7994643343914957`*^9, {3.799464782800934*^9, 3.799464795289186*^9}, {
   3.799465664049143*^9, 3.7994656808489733`*^9}, {3.799465712381198*^9, 
   3.799465712931284*^9}, {3.7994657834949102`*^9, 3.799465846586969*^9}, {
   3.799466376383222*^9, 3.7994663834931507`*^9}, {3.80042989956811*^9, 
   3.8004299117685328`*^9}, {3.823495311557651*^9, 3.823495337649867*^9}, {
   3.823495388441886*^9, 3.823495401784886*^9}, {3.82349545356562*^9, 
   3.8234955084441442`*^9}, {3.823495552731843*^9, 3.8234955878284492`*^9}, {
   3.823496748822419*^9, 3.823496977454934*^9}, {3.823545166105153*^9, 
   3.823545187191884*^9}, {3.823545638456933*^9, 3.8235458613971252`*^9}, {
   3.8235459345546827`*^9, 3.8235460519945*^9}, {3.82354620102713*^9, 
   3.823546209682807*^9}},ExpressionUUID->"80802e76-595a-47d5-9b0d-\
54a3fd219848"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fittedAsphericalFunction", "::", "usage"}], "=", 
   "\"\<fittedAsphericalFunction[fittingResults:{__Rule}] returns a pure \
function for fitted aspherical formula.f \
ittedAsphericalFunction[result:{__Rule}, y_Symbol] returns the function with \
argument 'y'.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7994639900829077`*^9, 3.799464273324094*^9}, 
   3.7994643343914957`*^9, {3.799464782800934*^9, 3.799464795289186*^9}, {
   3.799465664049143*^9, 3.7994656808489733`*^9}, {3.799465712381198*^9, 
   3.799465712931284*^9}, {3.7994657834949102`*^9, 3.799465846586969*^9}, {
   3.799466376383222*^9, 3.7994663834931507`*^9}, {3.80042989956811*^9, 
   3.8004299117685328`*^9}, {3.823495311557651*^9, 3.823495337649867*^9}, {
   3.823495388441886*^9, 3.823495401784886*^9}, {3.82349545356562*^9, 
   3.8234955084441442`*^9}, {3.823495552731843*^9, 3.8234955878284492`*^9}, {
   3.823496748822419*^9, 3.8234969686886997`*^9}, 
   3.8235516141316557`*^9},ExpressionUUID->"94862095-89f0-4740-b2a0-\
7cfec9a4fb3d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"removeOffset", "::", "usage"}], "=", 
   "\"\<removeOffset is an option of fittedAsphericalFunction. If \
removeOffset->True, a function returned from fittedAsphericalFunction passes \
{0,0}.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.823639242117605*^9, 
  3.823639321398382*^9}},ExpressionUUID->"a7282f12-1095-49ea-ae04-\
fe7c6fa1fb48"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fittingAccuracyEvaluationValues", "::", "usage"}], "=", 
   "\"\<fittingAccuracyEvaluationValues[f_InterpolatingFunction,result:{__\
Rule},opt___] returns fitting evaluation values, Peak-Valley and RMS of \
residuals.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.823551411823283*^9, 3.823551462540551*^9}, {
  3.823551494477729*^9, 3.823551496259882*^9}, {3.823639956600934*^9, 
  3.8236399849352913`*^9}, {3.823640038593794*^9, 3.823640095531814*^9}, {
  3.823642545611268*^9, 
  3.82364262233226*^9}},ExpressionUUID->"b2b6b792-3cf3-4c11-b9c5-\
111a88b7b4c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"evaluationWavelength", "::", "usage"}], "=", 
   "\"\<evaluationWavelength is an option of fittingAccuracyEvaluationValues \
that specifies a unit. If not specified, Identity will be used.\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.823551411823283*^9, 3.823551462540551*^9}, {
  3.823551494477729*^9, 3.823551496259882*^9}, {3.823639956600934*^9, 
  3.8236399849352913`*^9}, {3.823640038593794*^9, 3.823640095531814*^9}, {
  3.823642545611268*^9, 
  3.82364262233226*^9}},ExpressionUUID->"e819fd97-d528-4361-99c0-\
21762fff01f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fittingErrorPV", "::", "usage"}], "=", 
   "\"\<fittingErrorPV is a result tag of fitAsphericalExpression that \
represents Peak-Valley residual fitting error.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.823551411823283*^9, 3.823551462540551*^9}, {
  3.823551494477729*^9, 3.823551496259882*^9}, {3.823639956600934*^9, 
  3.8236399849352913`*^9}},ExpressionUUID->"43f2f94a-f89e-456c-85c7-\
dc55c205aae1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fittingErrorRMS", "::", "usage"}], "=", 
   "\"\<fittingErrorRMS is a result tag of fitAsphericalExpression that \
represents RMS fitting error.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8235515038848057`*^9, 3.823551514163842*^9}, {
  3.823642240472197*^9, 
  3.823642275145185*^9}},ExpressionUUID->"994cd77d-b5cb-4282-a907-\
957186aee9a2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"domainDimension", "::", "usage"}], "=", 
   "\"\<domainDimension[f_InterpolatingFunction] returns function dimensions.\
\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8235515038848057`*^9, 3.823551514163842*^9}, {
  3.823642240472197*^9, 3.8236422909950323`*^9}, {3.823642328460772*^9, 
  3.823642405057025*^9}},ExpressionUUID->"8e06c35b-69e6-4e97-ba88-\
967326789dca"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"maxHeight", "::", "usage"}], "=", 
   "\"\<maxHeight[f_InterpolationFunctuon] returns maximum height of its \
domain.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8235515038848057`*^9, 3.823551514163842*^9}, {
  3.823642240472197*^9, 3.8236422909950323`*^9}, {3.823642328460772*^9, 
  3.823642405057025*^9}, {3.823649321060219*^9, 
  3.8236493494836893`*^9}},ExpressionUUID->"bbd1ea9b-63a9-48b7-b735-\
f20a2ab1197d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"plotSpecification", "::", "usage"}], "=", 
   "\"\<plotSpecification[f_InterpolationFunctuon,x_Symbol] returns {x,xs,xe} \
style list that can be used in Plot. It should be enclosed in \
Evaluate[].\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8235515038848057`*^9, 3.823551514163842*^9}, {
  3.823642240472197*^9, 3.8236422909950323`*^9}, {3.823642328460772*^9, 
  3.823642405057025*^9}, {3.823649321060219*^9, 
  3.823649327237686*^9}},ExpressionUUID->"17b8d238-c140-4c3b-b58f-\
b5a6cdeda5d0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Private section", "Chapter",
 InitializationCell->True,
 CellChangeTimes->{{3.799464349266911*^9, 3.799464361089664*^9}, {
  3.7994644177522287`*^9, 
  3.799464423496195*^9}},ExpressionUUID->"620f6c55-b9a4-4073-90d6-\
aaa8ce508a79"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 AutoGeneratedPackage->Automatic,
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.797738391152273*^9, 3.797738402558744*^9}, {
  3.799464409766488*^9, 3.79946441775991*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"d3554e40-2dcf-4341-9b89-bdbcc0068a49"],

Cell[CellGroupData[{

Cell["Private section body", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.823639343812644*^9, 
  3.8236393516237593`*^9}},ExpressionUUID->"4329ff7e-3216-49f4-9a6b-\
75a452e7d3dc"],

Cell[CellGroupData[{

Cell["internal constants", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.823633317495659*^9, 
  3.823633321282745*^9}},ExpressionUUID->"d7ba4a79-595a-4da1-a664-\
eb02876defaa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$orderShouldBeNormalized", "=", "16"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.823559055982444*^9, 3.823559069046317*^9}, {
  3.8235670335586853`*^9, 3.8235670365878353`*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"1452b6a2-da6c-4af3-b14e-2434c2e4146c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$minimumPowerSeriesOrder", "=", "4"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$maximumPowerSeriesOrder", "=", "20"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8235623018190413`*^9, 3.82356233191074*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"64f3c513-b1ab-49c2-bbfb-18313d29e1a3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["assistant utility functions", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.823633157214229*^9, 
  3.8236332050237007`*^9}},ExpressionUUID->"258258d0-c7a2-4250-9952-\
7965d5ad1227"],

Cell[BoxData[
 RowBox[{
  RowBox[{"findParaxialCurvature", "[", "f_InterpolatingFunction", "]"}], ":=", 
  RowBox[{
   RowBox[{"curvatureFunction", "[", "f", "]"}], "[", "0.0", "]"}]}]], "Input",\

 InitializationCell->True,
 CellLabel->"In[60]:=",ExpressionUUID->"2589218d-b40c-4b52-8034-6f1dde72713a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"curvatureFunction", "[", 
   RowBox[{"f_", ",", "y_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"f", ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "2"}], "}"}]}], "]"}], "/", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"f", ",", "y"}], "]"}], "^", "2"}]}], ")"}], "^", 
    RowBox[{"(", 
     RowBox[{"3", "/", "2"}], ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"curvatureFunction", "[", "f_InterpolatingFunction", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "''"}], "[", "#", "]"}], "/", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "'"}], "[", "#", "]"}], "^", "2"}]}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"3", "/", "2"}], ")"}]}]}], ")"}], 
   "&"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"curvatureFunction", "[", "f_Function", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "''"}], "[", "#", "]"}], "/", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "'"}], "[", "#", "]"}], "^", "2"}]}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"3", "/", "2"}], ")"}]}]}], ")"}], "&"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8235506023415403`*^9, 3.8235506069025908`*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"2f673446-c5f4-4d85-82fe-1cd714e98872"],

Cell[BoxData[
 RowBox[{
  RowBox[{"maxHeight", "[", "f_InterpolatingFunction", "]"}], ":=", 
  RowBox[{"Max", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"domain2D", "[", "f", "]"}], ",", 
      RowBox[{"maxHeight", "[", 
       RowBox[{"sourcePoints2D", "[", "f", "]"}], "]"}]}], "}"}], "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8235480228293047`*^9, 3.823548066390759*^9}, {
  3.8235676936116962`*^9, 3.823567695704371*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"8d605f0d-216a-47f4-9b95-53a463901d2f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"maxHeight", "[", 
   RowBox[{"l", ":", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"_", ",", "_"}], "}"}], "..."}], "}"}]}], "]"}], ":=", 
  RowBox[{"Max", "[", 
   RowBox[{
    RowBox[{"Abs", "[", 
     RowBox[{"l", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], ",", 
    RowBox[{"Abs", "[", 
     RowBox[{"l", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "assuming", " ", "argment", " ", "l", " ", "comes", " ", "from", " ", 
    "InterpolationFunction"}], "*)"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.798405368992572*^9, 3.798405395306839*^9}, {
   3.798405543914464*^9, 3.7984056283586884`*^9}, {3.798405664866147*^9, 
   3.7984057866514797`*^9}, {3.798405852198748*^9, 3.798405861377537*^9}, {
   3.798405946713623*^9, 3.798405946970686*^9}, {3.7984059813980722`*^9, 
   3.798405988664853*^9}, {3.798421266812101*^9, 3.7984212742675858`*^9}, {
   3.798421332837021*^9, 3.798421348509074*^9}, {3.798421430503022*^9, 
   3.7984214814777403`*^9}, {3.798421613364019*^9, 3.798421656712294*^9}, {
   3.798421707847538*^9, 3.798421712226532*^9}, {3.7984217442205153`*^9, 
   3.798421783550233*^9}, {3.7984218323339863`*^9, 3.79842194154106*^9}, {
   3.798422001802589*^9, 3.798422070821813*^9}, {3.798422146299717*^9, 
   3.798422167899931*^9}, {3.798422307847753*^9, 3.798422344227665*^9}, {
   3.7984223755279016`*^9, 3.7984223857425632`*^9}, {3.798422506528998*^9, 
   3.7984225284991293`*^9}, {3.798422784358247*^9, 3.798422882607255*^9}, 
   3.7984230907659397`*^9, 3.798423309932597*^9, {3.823497017392089*^9, 
   3.823497084249325*^9}, {3.823500707443347*^9, 3.823500773224916*^9}, {
   3.8235470662955914`*^9, 3.8235470735739737`*^9}, 3.823567674027063*^9, {
   3.8235692553212023`*^9, 3.82356925681258*^9}, {3.8236363661487617`*^9, 
   3.823636403242783*^9}},ExpressionUUID->"343b3f59-9ec4-4c77-955b-\
118a95ffe922"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sourcePoints2D", "[", "f_InterpolatingFunction", "]"}], ":=", 
  RowBox[{"Transpose", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"sourceHeightList", "[", "f", "]"}], ",", 
     RowBox[{"f", "[", 
      RowBox[{"[", 
       RowBox[{"4", ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.798405368992572*^9, 3.798405395306839*^9}, {
   3.798405543914464*^9, 3.7984056283586884`*^9}, {3.798405664866147*^9, 
   3.7984057866514797`*^9}, {3.798405852198748*^9, 3.798405861377537*^9}, {
   3.798405946713623*^9, 3.798405946970686*^9}, {3.7984059813980722`*^9, 
   3.798405988664853*^9}, {3.798421266812101*^9, 3.7984212742675858`*^9}, {
   3.798421332837021*^9, 3.798421348509074*^9}, {3.798421430503022*^9, 
   3.7984214814777403`*^9}, {3.798421613364019*^9, 3.798421656712294*^9}, {
   3.798421707847538*^9, 3.798421712226532*^9}, {3.7984217442205153`*^9, 
   3.798421783550233*^9}, {3.7984218323339863`*^9, 3.79842194154106*^9}, {
   3.798422001802589*^9, 3.798422070821813*^9}, {3.798422146299717*^9, 
   3.798422167899931*^9}, {3.798422307847753*^9, 3.798422344227665*^9}, {
   3.7984223755279016`*^9, 3.7984223857425632`*^9}, {3.798422506528998*^9, 
   3.7984225284991293`*^9}, {3.798422784358247*^9, 3.798422882607255*^9}, 
   3.7984230907659397`*^9, 3.798423309932597*^9, {3.823497017392089*^9, 
   3.823497084249325*^9}, {3.823500707443347*^9, 3.823500817189979*^9}, {
   3.8235498528107452`*^9, 3.823549855437051*^9}, {3.823567513245015*^9, 
   3.823567541517198*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"1651bc71-44b9-4407-b3d1-97e3514c172e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sourceHeightList", "[", "f_InterpolatingFunction", "]"}], ":=", 
  RowBox[{"First", "[", 
   RowBox[{"f", "[", 
    RowBox[{"[", "3", "]"}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.823549836873458*^9, 3.8235498459974003`*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"4f910bca-dcbc-49a7-8fc6-7cb91eaeb70f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"domainDimension", "[", "f_InterpolatingFunction", "]"}], ":=", 
  RowBox[{"Dimensions", "[", 
   RowBox[{"f", "[", "\"\<Domain\>\"", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.798405368992572*^9, 3.798405395306839*^9}, {
   3.798405543914464*^9, 3.7984056283586884`*^9}, {3.798405664866147*^9, 
   3.7984057866514797`*^9}, {3.798405852198748*^9, 3.798405861377537*^9}, {
   3.798405946713623*^9, 3.798405946970686*^9}, {3.7984059813980722`*^9, 
   3.798405988664853*^9}, {3.798421266812101*^9, 3.7984212742675858`*^9}, {
   3.798421332837021*^9, 3.798421348509074*^9}, {3.798421430503022*^9, 
   3.7984214814777403`*^9}, {3.798421613364019*^9, 3.798421656712294*^9}, {
   3.798421707847538*^9, 3.798421712226532*^9}, {3.7984217442205153`*^9, 
   3.798421783550233*^9}, {3.7984218323339863`*^9, 3.79842194154106*^9}, {
   3.798422001802589*^9, 3.798422070821813*^9}, {3.798422146299717*^9, 
   3.798422167899931*^9}, {3.798422307847753*^9, 3.798422344227665*^9}, {
   3.7984223755279016`*^9, 3.7984223857425632`*^9}, {3.798422506528998*^9, 
   3.7984225284991293`*^9}, {3.798422784358247*^9, 3.798422882607255*^9}, 
   3.7984230907659397`*^9, 3.798423309932597*^9, {3.823497017392089*^9, 
   3.823497084249325*^9}, {3.823500707443347*^9, 3.823500819445726*^9}, {
   3.8235009505356197`*^9, 3.8235009861893063`*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"416e0078-2e07-42b0-bcf3-657fcfb6c76e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"domain2D", "[", "f_InterpolatingFunction", "]"}], ":=", 
  RowBox[{"First", "[", 
   RowBox[{"f", "[", "\"\<Domain\>\"", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.798405368992572*^9, 3.798405395306839*^9}, {
   3.798405543914464*^9, 3.7984056283586884`*^9}, {3.798405664866147*^9, 
   3.7984057866514797`*^9}, {3.798405852198748*^9, 3.798405861377537*^9}, {
   3.798405946713623*^9, 3.798405946970686*^9}, {3.7984059813980722`*^9, 
   3.798405988664853*^9}, {3.798421266812101*^9, 3.7984212742675858`*^9}, {
   3.798421332837021*^9, 3.798421348509074*^9}, {3.798421430503022*^9, 
   3.7984214814777403`*^9}, {3.798421613364019*^9, 3.798421656712294*^9}, {
   3.798421707847538*^9, 3.798421712226532*^9}, {3.7984217442205153`*^9, 
   3.798421783550233*^9}, {3.7984218323339863`*^9, 3.79842194154106*^9}, {
   3.798422001802589*^9, 3.798422070821813*^9}, {3.798422146299717*^9, 
   3.798422167899931*^9}, {3.798422307847753*^9, 3.798422344227665*^9}, {
   3.7984223755279016`*^9, 3.7984223857425632`*^9}, {3.798422506528998*^9, 
   3.7984225284991293`*^9}, {3.798422784358247*^9, 3.798422882607255*^9}, 
   3.7984230907659397`*^9, 3.798423309932597*^9, {3.823497017392089*^9, 
   3.823497084249325*^9}, {3.823500707443347*^9, 3.823500819445726*^9}, {
   3.8235009505356197`*^9, 3.8235009861893063`*^9}, {3.823642411963562*^9, 
   3.823642425585408*^9}},ExpressionUUID->"45401540-1acc-4319-821d-\
fcaedb25b9aa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotSpecification", "[", 
   RowBox[{"f_InterpolatingFunction", ",", "x_Symbol"}], "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"domain2D", "[", "f", "]"}]}], "}"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.798405368992572*^9, 3.798405395306839*^9}, {
   3.798405543914464*^9, 3.7984056283586884`*^9}, {3.798405664866147*^9, 
   3.7984057866514797`*^9}, {3.798405852198748*^9, 3.798405861377537*^9}, {
   3.798405946713623*^9, 3.798405946970686*^9}, {3.7984059813980722`*^9, 
   3.798405988664853*^9}, {3.798421266812101*^9, 3.7984212742675858`*^9}, {
   3.798421332837021*^9, 3.798421348509074*^9}, {3.798421430503022*^9, 
   3.7984214814777403`*^9}, {3.798421613364019*^9, 3.798421656712294*^9}, {
   3.798421707847538*^9, 3.798421712226532*^9}, {3.7984217442205153`*^9, 
   3.798421783550233*^9}, {3.7984218323339863`*^9, 3.79842194154106*^9}, {
   3.798422001802589*^9, 3.798422070821813*^9}, {3.798422146299717*^9, 
   3.798422167899931*^9}, {3.798422307847753*^9, 3.798422344227665*^9}, {
   3.7984223755279016`*^9, 3.7984223857425632`*^9}, {3.798422506528998*^9, 
   3.7984225284991293`*^9}, {3.798422784358247*^9, 3.798422882607255*^9}, 
   3.7984230907659397`*^9, 3.798423309932597*^9, {3.823497017392089*^9, 
   3.823497084249325*^9}, {3.823500707443347*^9, 3.823500819445726*^9}, {
   3.8235009505356197`*^9, 3.8235009861893063`*^9}, {3.823642411963562*^9, 
   3.823642438180345*^9}},ExpressionUUID->"e4fd1a87-c989-4d09-bc45-\
d192284ac81c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"quadCurvatureSeriesUpto6", "[", 
    RowBox[{"c_", ",", "k_", ",", "y_"}], "]"}], "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Normal", "[", 
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{"curvatureFunction", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"c", "*", 
            RowBox[{"y", "^", "2"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"1", "-", 
              RowBox[{
               RowBox[{"c", "^", "2"}], "*", 
               RowBox[{"(", 
                RowBox[{"1", "+", "k"}], ")"}], "*", 
               RowBox[{"y", "^", "2"}]}]}], "]"}]}], ")"}]}], ",", "y"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", "6"}], "}"}]}], "]"}], "]"}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8235500132236443`*^9, 3.823550075021521*^9}, 
   3.8235552294712563`*^9, 3.823555262888858*^9, {3.8236366049018517`*^9, 
   3.823636606057927*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"4bdcbb51-f283-4a7e-9fea-4142b951a72a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"quadSeriesUpto8", "[", 
    RowBox[{"c_", ",", "k_", ",", "y_"}], "]"}], "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Normal", "[", 
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"c", "*", 
          RowBox[{"y", "^", "2"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"1", "-", 
            RowBox[{
             RowBox[{"c", "^", "2"}], "*", 
             RowBox[{"(", 
              RowBox[{"1", "+", "k"}], ")"}], "*", 
             RowBox[{"y", "^", "2"}]}]}], "]"}]}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", "8"}], "}"}]}], "]"}], "]"}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.823555240357493*^9, 3.823555260857704*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"4e5d5334-3d2f-4be0-b72d-f4f097de6587"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sphForm", "[", 
   RowBox[{"c_", ",", "y_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"c", "*", 
     RowBox[{"y", "^", "2"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"c", "^", "2"}], "*", 
        RowBox[{"y", "^", "2"}]}]}], "]"}]}], ")"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.823548278239563*^9, 3.823548294338163*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"85e8e76d-0370-4253-bed2-25e0a5e49878"],

Cell[BoxData[
 RowBox[{
  RowBox[{"quadForm", "[", 
   RowBox[{"c_", ",", "k_", ",", "y_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"c", "*", 
     RowBox[{"y", "^", "2"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"c", "^", "2"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "+", "k"}], ")"}], "*", 
        RowBox[{"y", "^", "2"}]}]}], "]"}]}], ")"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.798405368992572*^9, 3.798405395306839*^9}, {
   3.798405543914464*^9, 3.7984056283586884`*^9}, {3.798405664866147*^9, 
   3.7984057866514797`*^9}, {3.798405852198748*^9, 3.798405861377537*^9}, {
   3.798405946713623*^9, 3.798405946970686*^9}, {3.7984059813980722`*^9, 
   3.798405988664853*^9}, {3.798421266812101*^9, 3.7984212742675858`*^9}, {
   3.798421332837021*^9, 3.798421348509074*^9}, {3.798421430503022*^9, 
   3.7984214814777403`*^9}, {3.798421613364019*^9, 3.798421656712294*^9}, {
   3.798421707847538*^9, 3.798421712226532*^9}, {3.7984217442205153`*^9, 
   3.798421783550233*^9}, {3.7984218323339863`*^9, 3.79842194154106*^9}, {
   3.798422001802589*^9, 3.798422070821813*^9}, {3.798422146299717*^9, 
   3.798422167899931*^9}, {3.798422307847753*^9, 3.798422344227665*^9}, {
   3.7984223755279016`*^9, 3.7984223857425632`*^9}, {3.798422506528998*^9, 
   3.7984225284991293`*^9}, {3.798422784358247*^9, 3.798422882607255*^9}, 
   3.7984230907659397`*^9, 3.798423309932597*^9, {3.823497017392089*^9, 
   3.823497084249325*^9}, {3.823500707443347*^9, 3.823500773224916*^9}, {
   3.8235470662955914`*^9, 3.8235471113257427`*^9}, {3.8235471654511013`*^9, 
   3.823547192764246*^9}, 3.8235481661098833`*^9},
 CellLabel->"In[73]:=",ExpressionUUID->"effd58ca-281a-423f-afe4-21c3c0c8b515"],

Cell[BoxData[
 RowBox[{
  RowBox[{"insideSqrt", "[", 
   RowBox[{"c_", ",", "k_", ",", "maxH_"}], "]"}], ":=", 
  RowBox[{"1", "-", 
   RowBox[{
    RowBox[{"c", "^", "2"}], "*", 
    RowBox[{"(", 
     RowBox[{"1", "+", "k"}], ")"}], "*", 
    RowBox[{"maxH", "^", "2"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.823547956487884*^9, 3.823547988766183*^9}, {
  3.82354815117332*^9, 3.823548160766672*^9}, {3.823550438369419*^9, 
  3.8235504425642233`*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"e23dc93c-44e7-4b6c-8aec-08beea7a0b08"],

Cell[BoxData[
 RowBox[{
  RowBox[{"realQ", "[", 
   RowBox[{"c_", ",", "k_", ",", "maxH_"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"insideSqrt", "[", 
     RowBox[{"c", ",", "k", ",", "maxH"}], "]"}], "\[GreaterEqual]", "0.0"}], 
   ")"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.823550238274836*^9, 3.823550342713121*^9}, {
  3.823550454682727*^9, 3.823550456839382*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"c929cb86-7b0a-45b1-985a-a1d43a3e2b62"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$edgeMargin", "=", 
   RowBox[{"1.", "+", 
    RowBox[{"10", "^", 
     RowBox[{"-", "14"}]}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.823638658779201*^9, 3.823638700713668*^9}, {
  3.823638741245098*^9, 3.823638741339693*^9}, {3.823638779022743*^9, 
  3.82363878808359*^9}},
 CellLabel->
  "In[362]:=",ExpressionUUID->"07ff354b-87e9-46a7-b654-c219c45e4704"],

Cell[BoxData[
 RowBox[{
  RowBox[{"edgeConic", "[", 
   RowBox[{"c_", ",", "maxH_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"1.0", "/", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"c", "*", "maxH", "*", "$edgeMargin"}], ")"}], "^", "2"}]}], 
   "-", "1.0"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.823548115456156*^9, 3.823548158547518*^9}, {
  3.823550444712926*^9, 3.82355044893356*^9}, {3.823638510407687*^9, 
  3.823638522647883*^9}, {3.823638705745118*^9, 3.823638705961871*^9}},
 CellLabel->
  "In[345]:=",ExpressionUUID->"a23fb57d-7348-40f5-a981-191abfa69aff"]
}, Open  ]],

Cell[CellGroupData[{

Cell["utility functions", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.823633157214229*^9, 
  3.82363320008738*^9}},ExpressionUUID->"5eb61c12-d1e9-47f8-8e3b-\
9052322b4d29"],

Cell[BoxData[
 RowBox[{
  RowBox[{"removePowerSeries", "[", 
   RowBox[{
    RowBox[{"curvConRemoved", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}], ".."}], "}"}]}], ",", 
    RowBox[{"coefs", ":", 
     RowBox[{"{", "__Rule", "}"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "f", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"f", "=", 
      RowBox[{"fittedPowerFunction", "[", "coefs", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "-", 
           RowBox[{"f", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], "}"}], "&"}], ",", 
       "curvConRemoved"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.82356339314332*^9, 3.823563409518096*^9}, {
  3.82356344323884*^9, 3.823563490831501*^9}, {3.8235639379503803`*^9, 
  3.823563966702711*^9}, {3.823567192341208*^9, 3.8235672327162313`*^9}, {
  3.823567272683979*^9, 3.82356729169121*^9}, {3.823636057167492*^9, 
  3.823636104728215*^9}},ExpressionUUID->"fecc317b-b36f-4eda-8343-\
33bee20509b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"removeParaxialCurvature", "[", 
   RowBox[{
    RowBox[{"coords", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}], ".."}], "}"}]}], ",", 
    RowBox[{"paraxialCurvature_", "?", "NumericQ"}]}], "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "-", 
        RowBox[{"sphForm", "[", 
         RowBox[{"paraxialCurvature", ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "}"}], "&"}], ",", 
    "coords"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.823548198925255*^9, 3.823548215735437*^9}, {
  3.82354830208152*^9, 3.8235483250800323`*^9}, {3.8235588142612047`*^9, 
  3.823558818106144*^9}, {3.823634953502419*^9, 3.823634953503134*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"6f228a91-f546-44f8-a0ee-0bbc1283271a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"removeParaxialCurvatureAndConic", "[", 
   RowBox[{
    RowBox[{"coords", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}], ".."}], "}"}]}], ",", 
    RowBox[{"paraxialCurvature_", "?", "NumericQ"}], ",", 
    RowBox[{"k_", "?", "NumericQ"}]}], "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "-", 
        RowBox[{"quadForm", "[", 
         RowBox[{"paraxialCurvature", ",", "k", ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "}"}], "&"}], ",", 
    "coords"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.823634953504558*^9, 3.823634953505102*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"0872a077-4811-4da5-b018-1fef276b30f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"removeOffset", "[", 
   RowBox[{
    RowBox[{"coords", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}], ".."}], "}"}]}], ",", 
    RowBox[{"offset_", "?", "NumericQ"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "-", "offset"}]}], "}"}], "&"}], ",",
     "coords"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.823633910033263*^9, 3.823633937812211*^9}, {
  3.823634953506422*^9, 3.823634953506989*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"1cfc73ee-d133-4b81-b713-23355cc4247e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["find nearest value functions", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.823633279932585*^9, 3.823633284188766*^9}, {
  3.823633995844535*^9, 
  3.823634007782255*^9}},ExpressionUUID->"37935aa5-f33e-4131-a335-\
30202395966b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"findPowerSeries", "[", 
   RowBox[{
    RowBox[{"curvConRemoved", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}], ".."}], "}"}]}], ",", 
    RowBox[{"highestOrder_", "?", "IntegerQ"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mx", ",", "nrm", ",", "result"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"highestOrder", ">", "$orderShouldBeNormalized"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mx", "=", 
         RowBox[{"maxHeight", "[", "curvConRemoved", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nrm", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "/", "mx"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], ",", 
           "curvConRemoved"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mx", "=", "1.0"}], ";", 
        RowBox[{"nrm", "=", "curvConRemoved"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"normalizationHeight", "\[Rule]", "mx"}], ",", 
        RowBox[{"findPowerSeriesInternal", "[", 
         RowBox[{"nrm", ",", "highestOrder"}], "]"}]}], "}"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.823633348838423*^9, 3.823633349869326*^9}, {
   3.8236336782489*^9, 3.823633678374448*^9}, {3.823635365944186*^9, 
   3.823635366035326*^9}, 3.823635791101138*^9},
 CellLabel->
  "In[113]:=",ExpressionUUID->"0660d7eb-e19a-40a7-9740-3ebaa3a14ade"],

Cell[BoxData[
 RowBox[{
  RowBox[{"findPowerSeriesInternal", "[", 
   RowBox[{
    RowBox[{"curvConRemoved", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}], ".."}], "}"}]}], ",", 
    RowBox[{"highestOrder_", "?", "IntegerQ"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "result"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"result", "=", 
      RowBox[{"FindFit", "[", 
       RowBox[{"curvConRemoved", ",", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "[", "i", "]"}], 
           RowBox[{"y", "^", "i"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "4", ",", "highestOrder", ",", "2"}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", "[", "0", "]"}], "}"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"a", "[", "i", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "4", ",", "highestOrder", ",", "2"}], "}"}]}], 
           "]"}]}], "]"}], ",", "y"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"powerSeriesCoefficients", "[", "i", "]"}], "\[Rule]", 
          RowBox[{"a", "[", "i", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "4", ",", "highestOrder", ",", "2"}], "}"}]}], 
        "]"}], "]"}], "/.", "result"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.823633352900127*^9, 3.823633685216076*^9, {3.8236339702825127`*^9, 
   3.823633974531641*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"5ba74eb2-18ad-4f6b-be17-4cd9b0163e0a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"kCandidate", "[", 
    RowBox[{"c_", ",", "mh_", ",", "mz_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2.0", "/", "c"}], "-", 
       RowBox[{
        RowBox[{"mh", "^", "2"}], "/", "mz"}]}], ")"}], "/", "mz"}], "-", 
    "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"findConic", "[", 
   RowBox[{
    RowBox[{"coords", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}], ".."}], "}"}]}], ",", 
    RowBox[{"paraxialCurvature_", "?", "NumericQ"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "k", ",", "maxH", ",", "maxZ", ",", "kcand", ",", "crem", ",", 
      "offset"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"maxH", ",", "maxZ"}], "}"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"coords", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], ">", "0"}], ",", 
        RowBox[{"coords", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], ",", 
        RowBox[{"coords", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"kcand", "=", 
      RowBox[{"kCandidate", "[", 
       RowBox[{"paraxialCurvature", ",", "maxH", ",", "maxZ"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"k", "/.", 
      RowBox[{"FindFit", "[", 
       RowBox[{"coords", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"quadForm", "[", 
            RowBox[{"paraxialCurvature", ",", "k", ",", "y"}], "]"}], "+", 
           "offset"}], ",", 
          RowBox[{"k", "<", 
           RowBox[{"edgeConic", "[", 
            RowBox[{"paraxialCurvature", ",", "maxH"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"k", ",", "kcand"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"offset", ",", "0.0"}], "}"}]}], "}"}], ",", "y"}], 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"findConic", "[", 
     RowBox[{
      RowBox[{"coords", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", "NumericQ"}], ",", 
           RowBox[{"_", "?", "NumericQ"}]}], "}"}], ".."}], "}"}]}], ",", 
      RowBox[{"paraxialCurvature_", "?", "NumericQ"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "maxH", ",", "crem", ",", "f", ",", "k", ",", "y", ",", "kval", ",", 
        "offset"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"maxH", "=", 
        RowBox[{"maxHeight", "[", "coords", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"realQ", "[", 
           RowBox[{"paraxialCurvature", ",", "0", ",", "maxH"}], "]"}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"edgeConic", "[", 
           RowBox[{"paraxialCurvature", ",", "maxH"}], "]"}], "]"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"crem", "=", 
        RowBox[{"removeParaxialCurvature", "[", 
         RowBox[{"coords", ",", "paraxialCurvature"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"kval", "=", 
        RowBox[{"k", "/.", 
         RowBox[{"FindFit", "[", 
          RowBox[{"crem", ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{"quadSeriesUpto8", "[", 
              RowBox[{"paraxialCurvature", ",", "k", ",", "y"}], "]"}], "+", 
             "offset"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "offset"}], "}"}], ",", "y"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"kval", ",", "\"\< \>\"", ",", "maxH", ",", 
         RowBox[{"realQ", "[", 
          RowBox[{"paraxialCurvature", ",", "kval", ",", "maxH"}], "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"realQ", "[", 
          RowBox[{"paraxialCurvature", ",", "kval", ",", "maxH"}], "]"}], ",",
          "kval", ",", 
         RowBox[{"edgeConic", "[", 
          RowBox[{"paraxialCurvature", ",", "maxH"}], "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.823633511371851*^9, 3.823633511746498*^9}, 
   3.823633686872512*^9, {3.823634579381382*^9, 3.8236345937560472`*^9}, {
   3.823634722345064*^9, 3.8236347457209253`*^9}, {3.823634953509122*^9, 
   3.82363495351062*^9}, {3.823635000822505*^9, 3.823635004440469*^9}, 
   3.823635048847047*^9, {3.823638083173088*^9, 3.823638122423358*^9}, {
   3.8236494669035873`*^9, 3.823649634640336*^9}, {3.8236496649543743`*^9, 
   3.823649893768898*^9}, {3.823649956155484*^9, 3.823649986144453*^9}, 
   3.823650033931155*^9, {3.823650177527101*^9, 3.82365022739645*^9}, {
   3.8236509772156563`*^9, 3.823650980022541*^9}, {3.823651243163351*^9, 
   3.823651283272262*^9}, 
   3.823651319349114*^9},ExpressionUUID->"3a9776c2-c3b5-4b5e-8f1c-\
df7ad33d2d65"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "the", " ", "function", " ", "needs", " ", "delivative", " ", "to", " ", 
    "calculate", " ", "local", " ", "curvature"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"findCurvatureAndConic", "[", "f_InterpolatingFunction", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "hlis", ",", "crvlis", ",", "y", ",", "c", ",", "k", ",", "result"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hlis", "=", 
       RowBox[{"sourceHeightList", "[", "f", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"crvlis", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"hlis", ",", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{"curvatureFunction", "[", "f", "]"}], ",", "hlis"}], 
           "]"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"FindFit", "[", 
        RowBox[{"crvlis", ",", 
         RowBox[{"quadCurvatureSeriesUpto6", "[", 
          RowBox[{"c", ",", "k", ",", "y"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"c", ",", "k"}], "}"}], ",", "y"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"realQ", "[", 
         RowBox[{
          RowBox[{"c", "/.", "result"}], ",", 
          RowBox[{"k", "/.", "result"}], ",", 
          RowBox[{"maxHeight", "[", "f", "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"curvature", "\[Rule]", "c"}], ",", 
           RowBox[{"conicConstant", "\[Rule]", "k"}]}], "}"}], "/.", 
         "result"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"curvature", "\[Rule]", "c"}], ",", 
            RowBox[{"conicConstant", "\[Rule]", "k"}]}], "}"}], "/.", 
          RowBox[{"k", "->", 
           RowBox[{"edgeConic", "[", 
            RowBox[{"c", ",", 
             RowBox[{"maxHeight", "[", "f", "]"}]}], "]"}]}]}], "/.", 
         "result"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.823633516653068*^9, 3.8236335170899277`*^9}, {
   3.823633561622336*^9, 3.823633592435734*^9}, 3.823633689685768*^9, {
   3.82363647472188*^9, 3.823636552336857*^9}, {3.823636649213298*^9, 
   3.823636650588394*^9}},
 CellLabel->
  "In[145]:=",ExpressionUUID->"208a8af1-5889-4ad4-b4c3-76a3cae50184"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"findOffset", "[", "f_InterpolatingFunction", "]"}], ":=", 
  RowBox[{"f", "[", "0.0", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"findOffset", "[", 
   RowBox[{"coords", ":", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumericQ"}], ",", 
        RowBox[{"_", "?", "NumericQ"}]}], "}"}], ".."}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "hmin", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"hmin", "=", 
      RowBox[{"Min", "[", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"First", "[", "#", "]"}], "]"}], "&"}], ",", "coords"}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"FirstCase", "[", 
      RowBox[{"coords", ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"hmin", ",", "v_"}], "}"}], "\[Rule]", "v"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.823633522904929*^9, 3.8236335422472057`*^9}, {
  3.823633599904739*^9, 3.8236337812490788`*^9}, {3.8236338116558867`*^9, 
  3.823633836124175*^9}, {3.823633875782921*^9, 3.823633879855566*^9}, {
  3.8236349535124598`*^9, 3.8236349535136538`*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"845fe557-0059-4dd5-9280-f4e9b95ce41c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["main functions", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.823634082628538*^9, 
  3.823634088040132*^9}},ExpressionUUID->"b5c650a8-8d72-4c3e-a458-\
4b2c9321a4f8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fitAsphericalExpression", "::", "tohhighord"}], "=", 
   "\"\<`1` may be too high to find power series fitting.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fitAsphericalExpression", "::", "needsfunc"}], "=", 
   "\"\<At least curvature value is needed to fit for point list. \
InterpolationFunction should be provided.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fitAsphericalExpression", "::", "note"}], "=", 
   "\"\<The aspherical formula is not suitable for the input shape. Please \
try other initial parameters or methods.\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.823634231003625*^9, 3.8236342783790216`*^9}, {
  3.823636194383729*^9, 3.8236362914831963`*^9}, {3.823651755345009*^9, 
  3.823651847278886*^9}},ExpressionUUID->"1ddf455c-c316-4dcf-8b9e-\
d82333c638d6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fitAsphericalExpression", "[", 
   RowBox[{"f_InterpolatingFunction", ",", 
    RowBox[{"highestOrder_", "?", "IntegerQ"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "ccrule", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Check", "[", 
      RowBox[{
       RowBox[{"ccrule", "=", 
        RowBox[{"findCurvatureAndConic", "[", "f", "]"}]}], ",", 
       RowBox[{"Message", "[", 
        RowBox[{"fitAsphericalExpression", "::", "note"}], "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"fitAsphericalExpression", "[", 
      RowBox[{
       RowBox[{"sourcePoints2D", "[", "f", "]"}], ",", 
       RowBox[{"curvature", "/.", "ccrule"}], ",", 
       RowBox[{"conicConstant", "/.", "ccrule"}], ",", "highestOrder"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8236348038201513`*^9, 3.823634892157281*^9}, {
   3.8236367171507072`*^9, 3.823636720839408*^9}, 3.823640127544167*^9, {
   3.823651967252637*^9, 
   3.823651974342925*^9}},ExpressionUUID->"76ed1a8c-2e92-4d72-a69b-\
3869f6d0349a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fitAsphericalExpression", "[", 
   RowBox[{"f_InterpolatingFunction", ",", 
    RowBox[{"paraxialCurvature_", "?", "NumericQ"}], ",", 
    RowBox[{"highestOrder_", "?", "IntegerQ"}]}], "]"}], ":=", 
  RowBox[{"fitAsphericalExpression", "[", 
   RowBox[{
    RowBox[{"sourcePoints2D", "[", "f", "]"}], ",", "paraxialCurvature", ",", 
    "highestOrder"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.823635094439801*^9, 3.8236351125958977`*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"4ee1cd35-5185-4cf5-aaa0-06ce4977a148"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fitAsphericalExpression", "[", 
   RowBox[{"f_InterpolatingFunction", ",", 
    RowBox[{"paraxialCurvature_", "?", "NumericQ"}], ",", 
    RowBox[{"conic_", "?", "NumericQ"}], ",", 
    RowBox[{"highestOrder_", "?", "IntegerQ"}]}], "]"}], ":=", 
  RowBox[{"fitAsphericalExpression", "[", 
   RowBox[{
    RowBox[{"sourcePoints2D", "[", "f", "]"}], ",", "paraxialCurvature", ",", 
    "conic", ",", "highestOrder"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.823635130251503*^9, 3.823635162659801*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"00981a16-ee66-4ecb-a4c8-35e24f1e101c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fitAsphericalExpression", "[", 
   RowBox[{
    RowBox[{"coords", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}], ".."}], "}"}]}], ",", 
    RowBox[{"highestOrder_", "?", "IntegerQ"}]}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{"fitAsphericalExpression", "::", "needsfunc"}], "]"}], ";", 
    "$Failed"}], ")"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.823636167508902*^9, 3.8236361895094547`*^9}, {
  3.823636300986005*^9, 
  3.823636308332313*^9}},ExpressionUUID->"ed15f7d9-28ec-4839-88bf-\
acfeb167ac19"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fitAsphericalExpression", "[", 
   RowBox[{
    RowBox[{"coords", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}], ".."}], "}"}]}], ",", 
    RowBox[{"paraxialCurvature_", "?", "NumericQ"}], ",", 
    RowBox[{"highestOrder_", "?", "IntegerQ"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "k", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Check", "[", 
      RowBox[{
       RowBox[{"k", "=", 
        RowBox[{"findConic", "[", 
         RowBox[{"coords", ",", "paraxialCurvature"}], "]"}]}], ",", 
       RowBox[{"Message", "[", 
        RowBox[{"fitAsphericalExpression", "::", "note"}], "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"fitAsphericalExpression", "[", 
      RowBox[{
      "coords", ",", "paraxialCurvature", ",", "k", ",", "highestOrder"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8236344032291183`*^9, 3.823634405253874*^9}, {
  3.823634470763856*^9, 3.823634472442074*^9}, {3.823634633944689*^9, 
  3.8236346965948563`*^9}, {3.823634754720512*^9, 3.823634789563703*^9}, {
  3.8236349535156403`*^9, 3.8236349535167303`*^9}, {3.823651876754242*^9, 
  3.823651907248332*^9}, {3.8236519518591547`*^9, 
  3.8236519533105497`*^9}},ExpressionUUID->"3e531792-1e06-4e93-9f86-\
d3d1c6bfa8a4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fitAsphericalExpression", "[", 
   RowBox[{
    RowBox[{"coords", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}], ".."}], "}"}]}], ",", 
    RowBox[{"paraxialCurvature_", "?", "NumericQ"}], ",", 
    RowBox[{"conic_", "?", "NumericQ"}], ",", 
    RowBox[{"highestOrder_", "?", "IntegerQ"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"offs", ",", "rmoffset", ",", "rmcc", ",", "pws"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"highestOrder", ">", "$maximumPowerSeriesOrder"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"fitAsphericalExpression", "::", "tohhighord"}], ",", 
          "highestOrder"}], "]"}], ";", 
        RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"offs", "=", 
      RowBox[{"findOffset", "[", "coords", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rmoffset", "=", 
      RowBox[{"removeOffset", "[", 
       RowBox[{"coords", ",", "offs"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"highestOrder", "<", "4"}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"curvature", "->", "paraxialCurvature"}], ",", 
          RowBox[{"conicConstant", "\[Rule]", "conic"}]}], "}"}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"rmcc", "=", 
      RowBox[{"removeParaxialCurvatureAndConic", "[", 
       RowBox[{"rmoffset", ",", "paraxialCurvature", ",", "conic"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"pws", "=", 
      RowBox[{"findPowerSeries", "[", 
       RowBox[{"rmcc", ",", "highestOrder"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"constantOffset", "\[Rule]", "offs"}], ",", 
        RowBox[{"curvature", "\[Rule]", "paraxialCurvature"}], ",", 
        RowBox[{"conicConstant", "\[Rule]", "conic"}], ",", "pws"}], "}"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.823634127513742*^9, 3.823634224222577*^9}, {
   3.823634285534007*^9, 3.823634382041402*^9}, {3.823634420881325*^9, 
   3.823634434193039*^9}, {3.823634953518758*^9, 3.82363495351954*^9}, {
   3.823635262880066*^9, 3.8236352634725313`*^9}, 3.823635293754562*^9, {
   3.8236353300069933`*^9, 3.823635339566173*^9}, {3.823636895467373*^9, 
   3.823636931216866*^9}},
 CellLabel->
  "In[160]:=",ExpressionUUID->"ef5c5244-ab8b-45f1-952c-e1a7f2cddf9a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["fitting result functions", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.8236354010059013`*^9, 
  3.823635406479969*^9}},ExpressionUUID->"1950bef9-051b-4a26-924e-\
4f3ec909a142"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "fittedAsphericalFunction", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"removeOffset", "\[Rule]", "True"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fittedAsphericalFunction", "[", 
   RowBox[{
    RowBox[{"fittingResults", ":", 
     RowBox[{"{", "__Rule", "}"}]}], ",", "arg_Symbol", ",", "opt___"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"fittedAsphericalFunction", "[", 
    RowBox[{"fittingResults", ",", "opt"}], "]"}], "[", "arg", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fittedAsphericalFunction", "[", 
   RowBox[{
    RowBox[{"fittingResults", ":", 
     RowBox[{"{", "__Rule", "}"}]}], ",", "opt___"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"invMaxH", "=", 
       RowBox[{
        RowBox[{"1.0", "/", "normalizationHeight"}], "/.", 
        "fittingResults"}]}], ",", 
      RowBox[{"offset", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"removeOffset", "/.", 
           RowBox[{"{", "opt", "}"}]}], "/.", 
          RowBox[{"Options", "[", "fittedAsphericalFunction", "]"}]}], ",", 
         "0.0", ",", 
         RowBox[{"constantOffset", "/.", "fittingResults"}]}], "]"}]}]}], 
     "}"}], ",", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "y", "}"}], ",", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"quadForm", "[", 
          RowBox[{
           RowBox[{"curvature", "/.", "fittingResults"}], ",", 
           RowBox[{"conicConstant", "/.", "fittingResults"}], ",", "y"}], 
          "]"}], "+", 
         RowBox[{
          RowBox[{"fittedPowerFunction", "[", "fittingResults", "]"}], "[", 
          RowBox[{"y", "*", "invMaxH"}], "]"}]}], "]"}], "+", "offset"}]}], 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.823635428975192*^9, 3.823635429286484*^9}, {
   3.823635478755395*^9, 3.8236354797869864`*^9}, {3.823635512380395*^9, 
   3.823635763226171*^9}, 3.8236369777476997`*^9, {3.8236370140964947`*^9, 
   3.823637052341395*^9}},
 CellLabel->
  "In[176]:=",ExpressionUUID->"d793c846-f937-4531-857b-3f6e2b8d947d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fittedPowerFunction", "[", 
   RowBox[{"fittingResults", ":", 
    RowBox[{"{", "__Rule", "}"}]}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "y", "}"}], ",", 
    RowBox[{"Evaluate", "[", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m", "=", 
         RowBox[{"maxOrderInResults", "[", "fittingResults", "]"}]}], "}"}], 
       ",", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"powerSeriesCoefficients", "[", "i", "]"}], "/.", 
            "fittingResults"}], ")"}], 
          RowBox[{"y", "^", "i"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "4", ",", "m", ",", "2"}], "}"}]}], "]"}]}], 
      "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[111]:=",ExpressionUUID->"895e0b39-e4dc-4822-8aaf-f213a733ede9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"maxOrderInResults", "[", 
   RowBox[{"fittingResults", ":", 
    RowBox[{"{", "__Rule", "}"}]}], "]"}], ":=", 
  RowBox[{"Max", "[", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{"First", ",", "fittingResults"}], "]"}], ",", 
      RowBox[{"powerSeriesCoefficients", "[", "_", "]"}]}], "]"}], "/.", 
    RowBox[{
     RowBox[{"powerSeriesCoefficients", "[", "i_", "]"}], "\[Rule]", "i"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[118]:=",ExpressionUUID->"ffeb2b1d-78ed-4c6e-a9da-22c83807f721"]
}, Open  ]],

Cell[CellGroupData[{

Cell["fitting evaluation", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.823637242698311*^9, 3.8236372465944033`*^9}, {
  3.823637282969344*^9, 
  3.823637289812492*^9}},ExpressionUUID->"fe568a5a-fbaf-416d-aa03-\
3da5eb9909cb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fittingAccuracyEvaluationValues", "::", "notrules"}], "=", 
   "\"\<Argument rule list is not produced by fitting functions.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "fittingAccuracyEvaluationValues", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"evaluationWavelength", "\[Rule]", "None"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fittingAccuracyEvaluationValues", "[", 
   RowBox[{"f_InterpolatingFunction", ",", 
    RowBox[{"fittingResults", ":", 
     RowBox[{"{", "__Rule", "}"}]}], ",", "opt___"}], "]"}], ":=", 
  RowBox[{"fittingAccuracyEvaluationValues", "[", 
   RowBox[{
    RowBox[{"sourcePoints2D", "[", "f", "]"}], ",", "fittingResults", ",", 
    "opt"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fittingAccuracyEvaluationValues", "[", 
   RowBox[{
    RowBox[{"shape", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "NumericQ"}], ",", 
         RowBox[{"_", "?", "NumericQ"}]}], "}"}], ".."}], "}"}]}], ",", 
    RowBox[{"fittingResults", ":", 
     RowBox[{"{", "__Rule", "}"}]}], ",", "opt___"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"lambda", ",", "f", ",", "resd"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"lambda", "=", 
      RowBox[{
       RowBox[{"evaluationWavelength", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"Options", "[", "residualEvaluationValues", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"NumericQ", "[", "lambda", "]"}]}], ",", 
       RowBox[{"lambda", "=", "1.0"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"f", "=", 
      RowBox[{"fittedAsphericalFunction", "[", 
       RowBox[{"fittingResults", ",", 
        RowBox[{"removeOffset", "\[Rule]", "False"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"resd", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"f", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "&"}], ",", "shape"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"fittingErrorPV", "->", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Apply", "[", 
           RowBox[{"Subtract", ",", 
            RowBox[{"MinMax", "[", "resd", "]"}]}], "]"}]}], "/", 
         "lambda"}]}], ",", 
       RowBox[{"fittingErrorRMS", "\[Rule]", 
        RowBox[{
         RowBox[{"RootMeanSquare", "[", "resd", "]"}], "/", "lambda"}]}]}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8236373138132887`*^9, 3.823637315251749*^9}, {
   3.823637345438264*^9, 3.823637368782474*^9}, {3.8236374193772287`*^9, 
   3.8236375006286297`*^9}, {3.82363758954119*^9, 3.8236377119480343`*^9}, {
   3.823637763389064*^9, 3.823637793074936*^9}, {3.823639881723233*^9, 
   3.8236398830600643`*^9}, {3.823639934131538*^9, 3.8236399437485123`*^9}, 
   3.823642525638442*^9},ExpressionUUID->"31b9623c-dc5c-4835-ba9c-\
e1293c7aaea1"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["End of this package", "Chapter",
 AutoGeneratedPackage->Automatic,
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.797739167479363*^9, 
  3.7977391750151367`*^9}},ExpressionUUID->"f6677f84-23b7-49ee-ae96-\
54ed3d4ddd8a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]}], "Input",
 AutoGeneratedPackage->Automatic,
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.797739178210627*^9, 
  3.797739185814768*^9}},ExpressionUUID->"56c04ee6-4bef-4707-82dd-\
296b11b523c8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example", "Title",
 CellChangeTimes->{{3.823639422557435*^9, 
  3.8236394275003643`*^9}},ExpressionUUID->"bf6df3f8-23e0-43aa-be58-\
72bde09a3bba"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<AplanaticSinglet`AsphericalFormulaFitting`\>\""}]], "Input",
 CellChangeTimes->{{3.823650338486472*^9, 3.823650341017603*^9}},
 CellLabel->
  "In[384]:=",ExpressionUUID->"3954e697-ec21-44b1-95f2-a10e6e9f87fd"],

Cell[BoxData[{
 RowBox[{"<<", "\"\<AplanaticSinglet`BiasphericAplanatSolver`\>\""}], "\n", 
 RowBox[{"<<", "\"\<AplanaticSinglet`RayTrace2D`\>\""}]}], "Input",
 CellChangeTimes->{3.8235841195893993`*^9},
 CellLabel->
  "In[139]:=",ExpressionUUID->"e46b9c05-20e6-42d6-9283-9b747e6829e1"],

Cell[BoxData[
 RowBox[{"createMediumsFromAGFFile", "[", 
  RowBox[{
  "FindFile", "[", "\"\<AplanaticSinglet/SCHOTTextracted.AGF\>\"", "]"}], 
  "]"}]], "Input",
 CellLabel->
  "In[141]:=",ExpressionUUID->"a50decb2-b8a6-455c-ac8b-b521f9d1cb58"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bk7", "=", 
   RowBox[{"mediumCatalog", "[", "\"\<N-BK7\>\"", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[142]:=",ExpressionUUID->"01f4b299-d256-48c5-a183-27ffe1f727e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"parms", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"designWavelength", "\[Rule]", "0.00064"}], ",", 
     RowBox[{"numericalApertureTarget", "\[Rule]", "0.6"}], ",", 
     RowBox[{"lensMediumSymbol", "\[Rule]", "bk7"}], ",", 
     RowBox[{"lensMediumThickness", "\[Rule]", "2."}], ",", 
     RowBox[{"mechanicalImageDistance", "\[Rule]", "1.5"}], ",", 
     RowBox[{"focalLength", "\[Rule]", "3."}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.8236298846019287`*^9, 3.823650628207432*^9, {3.823651370430245*^9, 
   3.823651370896119*^9}, 3.823651430650487*^9, {3.823651515023272*^9, 
   3.82365151636687*^9}, 3.823651605679513*^9, {3.823652104625095*^9, 
   3.823652104813704*^9}},
 CellLabel->
  "In[390]:=",ExpressionUUID->"af3408e1-5e1f-4ceb-bdf6-098bcad3b309"],

Cell[BoxData[
 RowBox[{"bp", "=", 
  RowBox[{"setupBiasphericAplanatParameters", "[", "parms", "]"}]}]], "Input",\

 CellChangeTimes->{{3.8024028961038303`*^9, 3.802402971693659*^9}, {
   3.8024030312855597`*^9, 3.802403048666213*^9}, {3.802403110363926*^9, 
   3.802403119948415*^9}, {3.802465506409964*^9, 3.802465540148797*^9}, {
   3.802466298570651*^9, 3.802466302538443*^9}, {3.8024663438519173`*^9, 
   3.802466345189536*^9}, {3.802469005541379*^9, 3.802469007754079*^9}, 
   3.8024690440383463`*^9, {3.8024690791970377`*^9, 3.802469082704455*^9}, 
   3.802469116172703*^9, {3.802469193574894*^9, 3.802469217414486*^9}, {
   3.80247258188396*^9, 3.802472601480641*^9}, {3.8024726504627666`*^9, 
   3.8024726521261873`*^9}, {3.8024933566973667`*^9, 3.802493370432547*^9}, 
   3.802562666872698*^9, 3.803174216121873*^9, 3.804542699444154*^9, 
   3.804542739033738*^9, 3.808443213646838*^9, 3.8106797105473843`*^9},
 CellLabel->
  "In[391]:=",ExpressionUUID->"611fde02-76d8-4f9a-abb8-8602c84c193d"],

Cell[BoxData[
 RowBox[{"result", "=", 
  RowBox[{"biasphericAplanatSolve", "[", "bp", "]"}]}]], "Input",
 CellLabel->
  "In[392]:=",ExpressionUUID->"2e254799-73cc-4e90-83fb-0543ff26d64c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"setOpticsFor2DRayTrace", "[", 
   RowBox[{"op", ",", "result"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"rs", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"traceRay", "[", "op", "]"}], "[", 
       RowBox[{"#", ",", 
        RowBox[{"designWavelength", "/.", "result"}]}], "]"}], "&"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"raySet", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"h", ",", 
           RowBox[{"-", "0.3"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"h", ",", 
           RowBox[{
            RowBox[{"-", "numericalAperture"}], "*", "focalLength"}], ",", 
           RowBox[{"numericalAperture", "*", "focalLength"}], ",", 
           RowBox[{"numericalAperture", "*", 
            RowBox[{"focalLength", "/", "128"}]}]}], "}"}], "/.", "result"}], 
        "]"}]}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"rayCongruenceGraphics", "[", 
    RowBox[{"rs", ",", 
     RowBox[{"removeLast", "\[Rule]", "True"}], ",", 
     RowBox[{"rayCount", "\[Rule]", "16"}]}], "]"}], ",", 
   RowBox[{"opticsGraphics", "[", 
    RowBox[{"op", ",", 
     RowBox[{"hideUselessSurface", "\[Rule]", "True"}]}], "]"}], ",", 
   RowBox[{"Axes", "\[Rule]", "True"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}]}], "Input",
 CellLabel->
  "In[393]:=",ExpressionUUID->"33dfb24b-d3f7-423c-9297-d62a4b674e32"],

Cell[BoxData[
 RowBox[{"ff", "=", 
  RowBox[{"frontSurfaceShapeFunction", "/.", "result"}]}]], "Input",
 CellLabel->
  "In[396]:=",ExpressionUUID->"702c3523-f4c8-4b47-bcd7-40680946b493"],

Cell[BoxData[
 RowBox[{"fc", "=", 
  RowBox[{"frontSurfaceCurvature", "/.", "result"}]}]], "Input",
 CellLabel->
  "In[397]:=",ExpressionUUID->"70ae6fe1-9fa0-437e-8106-56abff21c048"],

Cell[BoxData[
 RowBox[{"res", "=", 
  RowBox[{"fitAsphericalExpression", "[", 
   RowBox[{"ff", ",", "fc", ",", "20"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.823650380550416*^9, 3.823650410487596*^9}, {
   3.823650641269648*^9, 3.8236506490496693`*^9}, {3.8236513838039427`*^9, 
   3.823651401803877*^9}, {3.823651474678537*^9, 3.823651486960552*^9}, {
   3.823651532147997*^9, 3.823651532461259*^9}, 3.8236515803982286`*^9, {
   3.8236516187434177`*^9, 3.82365162721231*^9}, {3.823652116627002*^9, 
   3.823652116876226*^9}},
 CellLabel->
  "In[401]:=",ExpressionUUID->"cf4da039-8607-49a7-9e16-99496576cfe7"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ff", "[", "y", "]"}], ",", 
     RowBox[{
      RowBox[{"fittedAsphericalFunction", "[", 
       RowBox[{"res", ",", 
        RowBox[{"removeOffset", "\[Rule]", "False"}]}], "]"}], "[", "y", 
      "]"}]}], "}"}], ",", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"plotSpecification", "[", 
     RowBox[{"ff", ",", "y"}], "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{3.823642486512212*^9},
 CellLabel->
  "In[402]:=",ExpressionUUID->"6935f760-8ad3-48e9-9fc0-cea61b5a8c70"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"ff", "[", "y", "]"}], "-", 
    RowBox[{
     RowBox[{"fittedAsphericalFunction", "[", 
      RowBox[{"res", ",", 
       RowBox[{"removeOffset", "\[Rule]", "False"}]}], "]"}], "[", "y", 
     "]"}]}], ",", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"plotSpecification", "[", 
     RowBox[{"ff", ",", "y"}], "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{3.823642489226761*^9},
 CellLabel->
  "In[403]:=",ExpressionUUID->"b28357a8-37a6-4dcb-a13d-24a6d9c47b94"],

Cell[BoxData[
 RowBox[{"fittingAccuracyEvaluationValues", "[", 
  RowBox[{"ff", ",", "res", ",", 
   RowBox[{"evaluationWavelength", "\[Rule]", "0.000532"}]}], "]"}]], "Input",\

 CellChangeTimes->{3.823642507452057*^9},
 CellLabel->
  "In[404]:=",ExpressionUUID->"75844415-dd04-4f2f-9e3d-aefc4194c7fe"],

Cell[BoxData[
 RowBox[{"fb", "=", 
  RowBox[{"backSurfaceShapeFunction", "/.", "result"}]}]], "Input",
 CellChangeTimes->{{3.82365044014505*^9, 3.823650451770843*^9}},
 CellLabel->
  "In[405]:=",ExpressionUUID->"d64532cb-6e9e-4ae8-83ee-ac41c6226228"],

Cell[BoxData[
 RowBox[{"bc", "=", 
  RowBox[{"backSurfaceCurvature", "/.", "result"}]}]], "Input",
 CellChangeTimes->{{3.823650454677129*^9, 3.823650463268413*^9}},
 CellLabel->
  "In[406]:=",ExpressionUUID->"6735ed9c-8b5a-45ff-a7fa-3793332a9649"],

Cell[BoxData[
 RowBox[{"resb", "=", 
  RowBox[{"fitAsphericalExpression", "[", 
   RowBox[{"fb", ",", "20"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.823650473331107*^9, 3.823650480111067*^9}, {
   3.8236505567685633`*^9, 3.823650607644949*^9}, {3.823650660924507*^9, 
   3.823650695518776*^9}, {3.8236508620218983`*^9, 3.823650871960458*^9}, {
   3.823650962617119*^9, 3.8236509630209627`*^9}, 3.823651306491157*^9, {
   3.823651505522389*^9, 3.823651505616844*^9}, {3.8236515472116127`*^9, 
   3.8236515485865107`*^9}, {3.823651640274102*^9, 3.823651640554556*^9}, {
   3.8236516891188307`*^9, 3.823651697348147*^9}, {3.823652003376424*^9, 
   3.8236520117799253`*^9}, 3.8236520885957203`*^9, {3.823652134535062*^9, 
   3.823652134656168*^9}},
 CellLabel->
  "In[411]:=",ExpressionUUID->"f18d1fb4-1444-4af3-9e41-184943ed96ed"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fb", "[", "y", "]"}], ",", 
     RowBox[{
      RowBox[{"fittedAsphericalFunction", "[", 
       RowBox[{"resb", ",", 
        RowBox[{"removeOffset", "\[Rule]", "False"}]}], "]"}], "[", "y", 
      "]"}]}], "}"}], ",", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"plotSpecification", "[", 
     RowBox[{"fb", ",", "y"}], "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.823650493363381*^9, 3.823650499955657*^9}},
 CellLabel->
  "In[412]:=",ExpressionUUID->"e17fbb1f-f6a5-4820-98f1-826cb2826914"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"fittedAsphericalFunction", "[", 
      RowBox[{"resb", ",", 
       RowBox[{"removeOffset", "\[Rule]", "False"}]}], "]"}], "[", "y", "]"}],
     "-", 
    RowBox[{"fb", "[", "y", "]"}]}], ",", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"plotSpecification", "[", 
     RowBox[{"fb", ",", "y"}], "]"}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.823650512893547*^9, 3.823650528267846*^9}},
 CellLabel->
  "In[413]:=",ExpressionUUID->"3fd32867-0eb7-45de-959b-15428cc204a4"],

Cell[BoxData[
 RowBox[{"fittingAccuracyEvaluationValues", "[", 
  RowBox[{"fb", ",", "resb", ",", 
   RowBox[{"evaluationWavelength", "\[Rule]", "0.000532"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.823650573331697*^9, 3.823650574517538*^9}},
 CellLabel->
  "In[414]:=",ExpressionUUID->"dc523677-9289-450a-9125-9230a72f07a3"]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{808, 911},
WindowMargins->{{Automatic, 348}, {Automatic, 0}},
FrontEndVersion->"13.0 for Mac OS X x86 (64-bit) \
(2021\:5e7412\:67082\:65e5)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"86b1d3b5-0583-42d7-bf9d-fe8b6a28da1b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 289, 5, 98, "Title",ExpressionUUID->"978ba157-4da5-4fa2-839b-0bb1fbadd14c"],
Cell[872, 29, 376, 8, 83, "Author",ExpressionUUID->"c34abfc9-223c-44da-8acf-1d08fcfdb7f6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1285, 42, 189, 4, 98, "Title",ExpressionUUID->"7e217897-b1dc-464d-8e04-e38a42bcceaa",
 InitializationCell->True],
Cell[1477, 48, 699, 14, 68, "Input",ExpressionUUID->"89e3ab7b-a414-485d-8402-cc4d4d0d969f",
 InitializationCell->True],
Cell[2179, 64, 580, 12, 68, "Input",ExpressionUUID->"3bad05b0-9dd4-4ace-a929-6f716bf5479f",
 InitializationCell->True],
Cell[2762, 78, 656, 13, 89, "Input",ExpressionUUID->"f3e04254-1cf4-479d-ab84-0d6de0c23d19",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[3443, 95, 248, 6, 67, "Section",ExpressionUUID->"19a18786-c530-4ae9-b95f-59ac13da6e89",
 InitializationCell->True,
 InitializationGroup->True],
Cell[3694, 103, 597, 14, 152, "Input",ExpressionUUID->"2ef397fa-0ccd-4018-b3ef-3953eed2e110",
 InitializationCell->True],
Cell[4294, 119, 795, 16, 215, "Input",ExpressionUUID->"8d629569-0b32-4764-a594-70cade7edbad",
 InitializationCell->True],
Cell[5092, 137, 1057, 18, 89, "Input",ExpressionUUID->"3bb45ec5-a5e8-402c-8f50-92154f9d6073",
 InitializationCell->True],
Cell[6152, 157, 1081, 19, 89, "Input",ExpressionUUID->"150d3b25-37ca-4a0a-af58-3d71118209c7",
 InitializationCell->True],
Cell[7236, 178, 1033, 18, 89, "Input",ExpressionUUID->"7ba89eff-a37a-4fe1-8000-c6d097e11879",
 InitializationCell->True],
Cell[8272, 198, 1136, 19, 110, "Input",ExpressionUUID->"bc5b0dd9-714d-499a-a715-564f4373b3c0",
 InitializationCell->True],
Cell[9411, 219, 1299, 21, 131, "Input",ExpressionUUID->"80802e76-595a-47d5-9b0d-54a3fd219848",
 InitializationCell->True],
Cell[10713, 242, 1086, 19, 110, "Input",ExpressionUUID->"94862095-89f0-4740-b2a0-7cfec9a4fb3d",
 InitializationCell->True],
Cell[11802, 263, 416, 10, 89, "Input",ExpressionUUID->"a7282f12-1095-49ea-ae04-fe7c6fa1fb48",
 InitializationCell->True],
Cell[12221, 275, 636, 13, 89, "Input",ExpressionUUID->"b2b6b792-3cf3-4c11-b9c5-111a88b7b4c8",
 InitializationCell->True],
Cell[12860, 290, 610, 13, 89, "Input",ExpressionUUID->"e819fd97-d528-4361-99c0-21762fff01f4",
 InitializationCell->True],
Cell[13473, 305, 481, 10, 89, "Input",ExpressionUUID->"43f2f94a-f89e-456c-85c7-dc55c205aae1",
 InitializationCell->True],
Cell[13957, 317, 420, 10, 89, "Input",ExpressionUUID->"994cd77d-b5cb-4282-a907-957186aee9a2",
 InitializationCell->True],
Cell[14380, 329, 444, 10, 68, "Input",ExpressionUUID->"8e06c35b-69e6-4e97-ba88-967326789dca",
 InitializationCell->True],
Cell[14827, 341, 492, 11, 68, "Input",ExpressionUUID->"bbd1ea9b-63a9-48b7-b735-f20a2ab1197d",
 InitializationCell->True],
Cell[15322, 354, 571, 12, 89, "Input",ExpressionUUID->"17b8d238-c140-4c3b-b58f-b5a6cdeda5d0",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[15930, 371, 238, 5, 69, "Chapter",ExpressionUUID->"620f6c55-b9a4-4073-90d6-aaa8ce508a79",
 InitializationCell->True],
Cell[16171, 378, 374, 8, 46, "Input",ExpressionUUID->"d3554e40-2dcf-4341-9b89-bdbcc0068a49",
 InitializationCell->True,
 InitializationGroup->True],
Cell[CellGroupData[{
Cell[16570, 390, 194, 4, 67, "Section",ExpressionUUID->"4329ff7e-3216-49f4-9a6b-75a452e7d3dc",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[16789, 398, 193, 4, 54, "Subsection",ExpressionUUID->"d7ba4a79-595a-4da1-a664-eb02876defaa",
 InitializationCell->True],
Cell[16985, 404, 316, 6, 46, "Input",ExpressionUUID->"1452b6a2-da6c-4af3-b14e-2434c2e4146c",
 InitializationCell->True],
Cell[17304, 412, 360, 8, 68, "Input",ExpressionUUID->"64f3c513-b1ab-49c2-bbfb-18313d29e1a3",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[17701, 425, 204, 4, 54, "Subsection",ExpressionUUID->"258258d0-c7a2-4250-9952-7965d5ad1227",
 InitializationCell->True],
Cell[17908, 431, 303, 7, 46, "Input",ExpressionUUID->"2589218d-b40c-4b52-8034-6f1dde72713a",
 InitializationCell->True],
Cell[18214, 440, 1562, 50, 89, "Input",ExpressionUUID->"2f673446-c5f4-4d85-82fe-1cd714e98872",
 InitializationCell->True],
Cell[19779, 492, 578, 14, 68, "Input",ExpressionUUID->"8d605f0d-216a-47f4-9b95-53a463901d2f",
 InitializationCell->True],
Cell[20360, 508, 2045, 42, 68, "Input",ExpressionUUID->"343b3f59-9ec4-4c77-955b-118a95ffe922",
 InitializationCell->True],
Cell[22408, 552, 1669, 29, 68, "Input",ExpressionUUID->"1651bc71-44b9-4407-b3d1-97e3514c172e",
 InitializationCell->True],
Cell[24080, 583, 375, 8, 46, "Input",ExpressionUUID->"4f910bca-dcbc-49a7-8fc6-7cb91eaeb70f",
 InitializationCell->True],
Cell[24458, 593, 1460, 22, 46, "Input",ExpressionUUID->"416e0078-2e07-42b0-bcf3-657fcfb6c76e",
 InitializationCell->True],
Cell[25921, 617, 1476, 23, 46, "Input",ExpressionUUID->"45401540-1acc-4319-821d-fcaedb25b9aa",
 InitializationCell->True],
Cell[27400, 642, 1563, 26, 46, "Input",ExpressionUUID->"e4fd1a87-c989-4d09-bc45-d192284ac81c",
 InitializationCell->True],
Cell[28966, 670, 1182, 33, 110, "Input",ExpressionUUID->"4bdcbb51-f283-4a7e-9fea-4142b951a72a",
 InitializationCell->True],
Cell[30151, 705, 952, 27, 68, "Input",ExpressionUUID->"4e5d5334-3d2f-4be0-b72d-f4f097de6587",
 InitializationCell->True],
Cell[31106, 734, 576, 17, 46, "Input",ExpressionUUID->"85e8e76d-0370-4253-bed2-25e0a5e49878",
 InitializationCell->True],
Cell[31685, 753, 1828, 35, 46, "Input",ExpressionUUID->"effd58ca-281a-423f-afe4-21c3c0c8b515",
 InitializationCell->True],
Cell[33516, 790, 559, 14, 46, "Input",ExpressionUUID->"e23dc93c-44e7-4b6c-8aec-08beea7a0b08",
 InitializationCell->True],
Cell[34078, 806, 488, 12, 46, "Input",ExpressionUUID->"c929cb86-7b0a-45b1-985a-a1d43a3e2b62",
 InitializationCell->True],
Cell[34569, 820, 423, 11, 46, "Input",ExpressionUUID->"07ff354b-87e9-46a7-b654-c219c45e4704",
 InitializationCell->True],
Cell[34995, 833, 590, 15, 46, "Input",ExpressionUUID->"a23fb57d-7348-40f5-a981-191abfa69aff",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[35622, 853, 191, 4, 54, "Subsection",ExpressionUUID->"5eb61c12-d1e9-47f8-8e3b-9052322b4d29",
 InitializationCell->True],
Cell[35816, 859, 1494, 41, 131, "Input",ExpressionUUID->"fecc317b-b36f-4eda-8343-33bee20509b4",
 InitializationCell->True],
Cell[37313, 902, 1147, 31, 89, "Input",ExpressionUUID->"6f228a91-f546-44f8-a0ee-0bbc1283271a",
 InitializationCell->True],
Cell[38463, 935, 1062, 30, 89, "Input",ExpressionUUID->"0872a077-4811-4da5-b018-1fef276b30f5",
 InitializationCell->True],
Cell[39528, 967, 904, 27, 68, "Input",ExpressionUUID->"1cfc73ee-d133-4b81-b713-23355cc4247e",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[40469, 999, 252, 5, 54, "Subsection",ExpressionUUID->"37935aa5-f33e-4131-a335-30202395966b",
 InitializationCell->True],
Cell[40724, 1006, 1997, 54, 194, "Input",ExpressionUUID->"0660d7eb-e19a-40a7-9740-3ebaa3a14ade",
 InitializationCell->True],
Cell[42724, 1062, 1936, 53, 152, "Input",ExpressionUUID->"5ba74eb2-18ad-4f6b-be17-4cd9b0163e0a",
 InitializationCell->True],
Cell[44663, 1117, 5457, 143, 404, "Input",ExpressionUUID->"3a9776c2-c3b5-4b5e-8f1c-df7ad33d2d65",
 InitializationCell->True],
Cell[50123, 1262, 2534, 65, 236, "Input",ExpressionUUID->"208a8af1-5889-4ad4-b4c3-76a3cae50184",
 InitializationCell->True],
Cell[52660, 1329, 1403, 36, 131, "Input",ExpressionUUID->"845fe557-0059-4dd5-9280-f4e9b95ce41c",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[54100, 1370, 189, 4, 54, "Subsection",ExpressionUUID->"b5c650a8-8d72-4c3e-a458-4b2c9321a4f8",
 InitializationCell->True],
Cell[54292, 1376, 916, 21, 194, "Input",ExpressionUUID->"1ddf455c-c316-4dcf-8b9e-d82333c638d6",
 InitializationCell->True],
Cell[55211, 1399, 1152, 27, 152, "Input",ExpressionUUID->"76ed1a8c-2e92-4d72-a69b-3869f6d0349a",
 InitializationCell->True],
Cell[56366, 1428, 582, 12, 89, "Input",ExpressionUUID->"4ee1cd35-5185-4cf5-aaa0-06ce4977a148",
 InitializationCell->True],
Cell[56951, 1442, 641, 13, 89, "Input",ExpressionUUID->"00981a16-ee66-4ecb-a4c8-35e24f1e101c",
 InitializationCell->True],
Cell[57595, 1457, 733, 21, 89, "Input",ExpressionUUID->"ed15f7d9-28ec-4839-88bf-acfeb167ac19",
 InitializationCell->True],
Cell[58331, 1480, 1495, 36, 152, "Input",ExpressionUUID->"3e531792-1e06-4e93-9f86-d3d1c6bfa8a4",
 InitializationCell->True],
Cell[59829, 1518, 2813, 68, 341, "Input",ExpressionUUID->"ef5c5244-ab8b-45f1-952c-e1a7f2cddf9a",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[62679, 1591, 201, 4, 54, "Subsection",ExpressionUUID->"1950bef9-051b-4a26-924e-4f3ec909a142",
 InitializationCell->True],
Cell[62883, 1597, 2259, 61, 257, "Input",ExpressionUUID->"d793c846-f937-4531-857b-3f6e2b8d947d",
 InitializationCell->True],
Cell[65145, 1660, 965, 28, 131, "Input",ExpressionUUID->"895e0b39-e4dc-4822-8aaf-f213a733ede9",
 InitializationCell->True],
Cell[66113, 1690, 608, 17, 89, "Input",ExpressionUUID->"ffeb2b1d-78ed-4c6e-a9da-22c83807f721",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[66758, 1712, 244, 5, 54, "Subsection",ExpressionUUID->"fe568a5a-fbaf-416d-aa03-3da5eb9909cb",
 InitializationCell->True],
Cell[67005, 1719, 3344, 86, 320, "Input",ExpressionUUID->"31b9623c-dc5c-4835-ba9c-e1293c7aaea1",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[70410, 1812, 255, 6, 69, "Chapter",ExpressionUUID->"f6677f84-23b7-49ee-ae96-54ed3d4ddd8a",
 InitializationCell->True,
 InitializationGroup->True],
Cell[70668, 1820, 363, 10, 68, "Input",ExpressionUUID->"56c04ee6-4bef-4707-82dd-296b11b523c8",
 InitializationCell->True,
 InitializationGroup->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[71080, 1836, 152, 3, 98, "Title",ExpressionUUID->"bf6df3f8-23e0-43aa-be58-72bde09a3bba"],
Cell[71235, 1841, 246, 5, 30, "Input",ExpressionUUID->"3954e697-ec21-44b1-95f2-a10e6e9f87fd"],
Cell[71484, 1848, 286, 5, 52, "Input",ExpressionUUID->"e46b9c05-20e6-42d6-9283-9b747e6829e1"],
Cell[71773, 1855, 244, 6, 30, "Input",ExpressionUUID->"a50decb2-b8a6-455c-ac8b-b521f9d1cb58"],
Cell[72020, 1863, 205, 5, 30, "Input",ExpressionUUID->"01f4b299-d256-48c5-a183-27ffe1f727e0"],
Cell[72228, 1870, 813, 17, 52, "Input",ExpressionUUID->"af3408e1-5e1f-4ceb-bdf6-098bcad3b309"],
Cell[73044, 1889, 1003, 16, 30, "Input",ExpressionUUID->"611fde02-76d8-4f9a-abb8-8602c84c193d"],
Cell[74050, 1907, 187, 4, 30, "Input",ExpressionUUID->"2e254799-73cc-4e90-83fb-0543ff26d64c"],
Cell[74240, 1913, 1622, 44, 157, "Input",ExpressionUUID->"33dfb24b-d3f7-423c-9297-d62a4b674e32"],
Cell[75865, 1959, 186, 4, 30, "Input",ExpressionUUID->"702c3523-f4c8-4b47-bcd7-40680946b493"],
Cell[76054, 1965, 182, 4, 30, "Input",ExpressionUUID->"70ae6fe1-9fa0-437e-8106-56abff21c048"],
Cell[76239, 1971, 612, 11, 30, "Input",ExpressionUUID->"cf4da039-8607-49a7-9e16-99496576cfe7"],
Cell[76854, 1984, 568, 16, 52, "Input",ExpressionUUID->"6935f760-8ad3-48e9-9fc0-cea61b5a8c70"],
Cell[77425, 2002, 537, 15, 52, "Input",ExpressionUUID->"b28357a8-37a6-4dcb-a13d-24a6d9c47b94"],
Cell[77965, 2019, 303, 7, 30, "Input",ExpressionUUID->"75844415-dd04-4f2f-9e3d-aefc4194c7fe"],
Cell[78271, 2028, 250, 5, 30, "Input",ExpressionUUID->"d64532cb-6e9e-4ae8-83ee-ac41c6226228"],
Cell[78524, 2035, 247, 5, 30, "Input",ExpressionUUID->"6735ed9c-8b5a-45ff-a7fa-3793332a9649"],
Cell[78774, 2042, 829, 14, 30, "Input",ExpressionUUID->"f18d1fb4-1444-4af3-9e41-184943ed96ed"],
Cell[79606, 2058, 593, 16, 52, "Input",ExpressionUUID->"e17fbb1f-f6a5-4820-98f1-826cb2826914"],
Cell[80202, 2076, 611, 16, 52, "Input",ExpressionUUID->"3fd32867-0eb7-45de-959b-15428cc204a4"],
Cell[80816, 2094, 328, 7, 30, "Input",ExpressionUUID->"dc523677-9289-450a-9125-9230a72f07a3"]
}, Open  ]]
}
]
*)

