(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    271799,       6416]
NotebookOptionsPosition[    259064,       6200]
NotebookOutlinePosition[    259721,       6222]
CellTagsIndexPosition[    259678,       6219]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Bi-aspheric aplanat singlet solver", "Title",
 InitializationCell->True,
 CellChangeTimes->{{3.802396949449473*^9, 3.80239696032843*^9}, {
  3.802397888811314*^9, 
  3.802397912293367*^9}},ExpressionUUID->"5e707cf1-c910-4771-8628-\
e24c8fb264ae"],

Cell["\<\
Takatoshi Yamada@Ayase corporation
e - mail : takatoshi.yamada@ayasecorporation.com
web cite : https : // www.ayasecorporation.com\
\>", "Author",
 CellChangeTimes->{{3.817423896747398*^9, 3.8174239195219517`*^9}, {
  3.817432347063612*^9, 
  3.817432347686989*^9}},ExpressionUUID->"a19537de-9694-4b54-b2d7-\
641111eca191"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Definitions", "Title",
 InitializationCell->True,
 CellChangeTimes->{{3.800164445516327*^9, 
  3.800164451262671*^9}},ExpressionUUID->"b7adee4b-1cb9-43f1-9962-\
916916d9d57b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeginPackage", "[", 
   RowBox[{"\"\<AplanaticSinglet`BiasphericAplanatSolver`\>\"", ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<AplanaticSinglet`SingletParaxialConsistency`\>\"", ",", 
      "\"\<AplanaticSinglet`RayTrace2D`\>\""}], "}"}]}], "]"}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.800579433225397*^9, 3.800579469142228*^9}, {
   3.801284049457726*^9, 3.801284050907229*^9}, {3.802391423150015*^9, 
   3.802391423396977*^9}, {3.818463006011003*^9, 3.818463008701324*^9}, 
   3.8187166509446297`*^9},ExpressionUUID->"359f29c9-0be4-4fa2-a9a5-\
dd809bf456d2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BiasphericAplanatSolverVersion", "::", "usage"}], "=", 
   "\"\<BiasphericAplanatSolver ver.0.2A20200702\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "BiasphericAplanatSolverDescription", "=", 
   "\"\<BiasphericAplanatSolver package fixes biaspheric aplanat (aspheric \
singlet lens) by numerical integration with given parameters. Conjugate \
condition (finite or infinite) is determined from the given parameter set. \
The parameter set can include cover glasses. If parameter set is consistent \
for paraxial condition, the numerical integration will be performed upto \
given numrical aperture value. The numerical integration may be interrupted \
by \>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802648873534643*^9, 
  3.802648910066948*^9}},ExpressionUUID->"1bf9be8d-7c53-4e8c-98e1-\
f5fc2e92d260"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "BiasphericAplanatSolverUsage", "=", 
   "\"\<Needs[\\\"AplanaticSinglet`BiasphericAplanatSolver`\\\"]\n\
createConstantMedium[bk7, 1.5268]\nbiasphericAplanatParameterSymbols\nparms = \
{designWavelength -> 0.00064, numericalApertureTarget -> 0.6, \n   \
lensMediumSymbol -> bk7, lensMediumThickness -> 4, \n   \
mechanicalImageDistance -> 3.66, coverGlassMediumSymbol -> bk7, \n   \
coverGlassThickness -> 0.6, mechanicalObjectImageDistance -> 30., \n   \
lateralMagnification -> -0.25, objectSideCoverGlassMediumSymbol -> bk7, \n   \
objectSideCoverGlassThickness -> 5};\nbp = \
setupBiasphericAplanatParameters[parms];\nresult = biasphericAplanatSolve[bp, \
AccuracyGoal -> 14, MaxStepSize -> 0.01]\nsetOpticsFor2DRayTraceFinite[op, \
result]\nrs = Map[traceRay[op][#, designWavelength /. result] &, \n   \
Table[raySet[{0, -mechanicalObjectDistance /. result}, {Sin[h], Cos[h]}], \n  \
  Evaluate[{h, -numericalAperture*lateralMagnification, \n       \
numericalAperture*lateralMagnification, \
numericalAperture*lateralMagnification/64} /. \n      result]]];\n\
Show[rayCongruenceGraphics[rs, removeLast -> True, rayCount -> 20], \n \
opticsGraphics[op, removeLast -> True], Axes -> True, ImageSize -> Large]\n\
ListLinePlot[\n Map[# - {lensMediumThickness + mechanicalImageDistance /. \
result, 0} &, \n  Select[Map[lateralAberPositionReversed, rs], #[[-1]] >= 0.0 \
&]], \n PlotRange -> Automatic]\nListLinePlot[\n \
Select[Map[oscValueReversed[#, focalLength /. result] &, \n   rs], #[[-1]] >= \
0.0 &]]\nListLinePlot[\n Map[Last, \
opticalPathDifference[Map[opticalPathLengthForHeight, rs]]], \n PlotRange -> \
All]\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802648873534643*^9, 3.802648910066948*^9}, {
   3.802649161857134*^9, 3.802649200569969*^9}, {3.803082541074341*^9, 
   3.803082560388926*^9}, 
   3.818463009573929*^9},ExpressionUUID->"ad382fdf-2d76-41d4-84b9-\
d2356492a4d4"],

Cell[CellGroupData[{

Cell["usage messages", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.802396937816575*^9, 
  3.8023969439049473`*^9}},ExpressionUUID->"785042fc-242d-4456-87cd-\
749bdaa6e4cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"biasphericAplanatParameterSymbols", "::", "usage"}], "=", 
   "\"\<biasphericAplanatParameterSymbols is a tag for a list of  parameter \
symbols for the biaspheric aplanat solver.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802397411009198*^9, 3.8023974421374702`*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"e28e69eb-fb91-464f-b3b9-eb0753db129a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"designWavelength", "::", "usage"}], "=", 
   "\"\<designWavelength is a parameter for the solver specifying the \
wavelength to fix a refractive indices of materials.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802397485250304*^9, 3.802397508188238*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"e19fc59d-a943-47d2-b579-f2d8f1284e59"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"lensMediumSymbol", "::", "usage"}], "=", 
   "\"\<lensMediumSymbol is a parameter for the solver specifying a material \
of the lens body. To specify a medium, refractive index calculation mechanism \
in the 'RayTrace2D' package.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.80239751577108*^9},
 CellLabel->"In[65]:=",ExpressionUUID->"52caf16a-6b77-4307-a6af-b02a11561041"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"numericalApertureTarget", "::", "usage"}], "=", 
   "\"\<numericalApertureTarget is a parameter for the solver specifying the \
numerical aperture in the IMAGE space. It is only a 'target' and the solver \
returns smaller numrical aperture depending parameters.\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.802397521856512*^9, {3.803082256219666*^9, 
   3.8030823613179626`*^9}},ExpressionUUID->"09c5b9a8-ff5f-4f9b-ae1d-\
da7ddb4fa190"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mechanicalImageDistance", "::", "usage"}], "=", 
   "\"\<mechanicalWorkingDistance is a parameter for the solver specifying \
distance from top of the backsurface to image plane. The value should not be \
paraxial length but mechanical and including cover glass if present. If cover \
glass not present, mechanicalImageDistance is equal to working distance. For \
infinite conjugate, mechanicalImageDistance is equal to back focal \
distance.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.8023975353792152`*^9},
 CellLabel->"In[67]:=",ExpressionUUID->"90137011-fdaa-44a8-be86-2cc939ad4d72"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mechanicalObjectDistance", "::", "usage"}], "=", 
   "\"\<mechanicalObjectDistance is a parameter for the solver specifing \
distance from object plane to top of frontSurface. The value should not be \
paraxial length but mechanical and including object side cover glass if \
present. For infinite conjugate, mechanicalObjectDistance is automatically \
assigned to Infinity.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.802397543905993*^9},
 CellLabel->"In[68]:=",ExpressionUUID->"37e44015-824a-47f1-b973-893ac97dee9a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"coverGlassMediumSymbol", "::", "usage"}], "=", 
   "\"\<coverGlassMediumSymbol s a parameter for the solver specifying cover \
glass material. It is treated same as lensMediumSymbol. The cover glass is \
always assumed in image side of the lens. Default medium is \
'atomosphere'.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.802397549769718*^9},
 CellLabel->"In[69]:=",ExpressionUUID->"a94ffd6c-0a66-4a9c-b74f-37f96e27c509"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"coverGlassThickness", "::", "usage"}], "=", 
   "\"\<coverGlassThickness is a parameter for the solver specifying physical \
thickness of a cover glass. The cover glass is always assumed in image side \
of the lens. Default value is 0.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.802397557170767*^9},
 CellLabel->"In[70]:=",ExpressionUUID->"8e72a694-11cb-4841-a763-d78431fe6991"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mechanicalObjectImageDistance", "::", "usage"}], "=", 
   "\"\<mechanicalObjectImageDistance is a parameter for the solver \
specifying mechanical O/I distance. If lateralMagnification = 0, \
imageObjectDistance is ignored. If both lateralMagnification and \
imageObjectDistance are specified, focalLength is ignored by the \
solver.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.802397575813546*^9, {3.802402670616589*^9, 3.802402672191608*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"d72be07f-e718-4ae5-b9bf-4a6c6211810d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"objectSideCoverGlassMediumSymbol", "::", "usage"}], "=", 
   "\"\<objectSideCoverGlassMediumSymbol s a parameter for the solver \
specifying cover glass material. It is treated same as lensMediumSymbol. If \
parameters are conditioned to infinite conjugate, this pareameter \
ignored.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.802397584418331*^9, {3.8026495813332663`*^9, 
   3.802649617027197*^9}},ExpressionUUID->"c87294b7-4046-497f-a3db-\
df2833017ce3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"objectSideCoverGlassThickness", "::", "usage"}], "=", 
   "\"\<objectSideCoverGlassThickness is a parameter for the solver \
specifying cover glass thickness in object space.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.802397584418331*^9, {3.8026495813332663`*^9, 
   3.802649617027197*^9}},ExpressionUUID->"315b6aff-a6d8-4f8d-ab8c-\
7a6a39ddddb6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"marginRatio", "::", "usage"}], "=", 
   "\"\<marginRatio is a parameter for the solver specifying numerical \
aperture margin.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.802397562829731*^9},
 CellLabel->"In[73]:=",ExpressionUUID->"119fb63c-d1c9-43f2-8744-8f0754a1393c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"setDefaultMarginRatio", "::", "usage"}], "=", 
   "\"\<setDefaultMarginRatio[mratio_] sets default marginRatio. mratio \
should be greater than 1.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.80246843104662*^9, 3.802468465396378*^9}, {
  3.802468515257921*^9, 
  3.8024685280826*^9}},ExpressionUUID->"cc98feaa-9be4-4656-ac72-9e3da282c37f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"frontSurfaceShapeFunction", "::", "usage"}], "=", 
   "\"\<frontSurfaceShapeFunction is a result tag of biasphericAplanatSolver. \
The rhs value is solved front surface (surface 1) shape function in the \
Mathematica InterpolatingFunction style.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802397602159686*^9, 3.8023976042293177`*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"17047ab0-9e17-465a-867c-0ddbb1ef7634"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"backSurfaceShapeFunction", "::", "usage"}], "=", 
   "\"\<backSurfaceShapeFunction is a result tag of biasphericAplanatSolver. \
The rhs value is solved back surface (surface 2) shape function in the \
Mathematica InterpolatingFunction style.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802397602159686*^9, 3.8023976042293177`*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"0c26a406-47fb-4759-a930-f2373e250ae1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"numericalAperture", "::", "usage"}], "=", 
   "\"\<numericalAperture is a result tag of biasphericAplanatSolver. The rhs \
value is a numerical aperture value in the image space. If the solution for \
the parameter set is exist, numericalAperture value is equal to  \
numericalApertureTarget in the given parameter set.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.802397621443228*^9, {3.8024645201244383`*^9, 3.8024645206618547`*^9}, {
   3.8030822737257147`*^9, 3.80308228636977*^9}, {3.8030823819501*^9, 
   3.803082382976592*^9}},ExpressionUUID->"50affa45-a2f9-4a08-ade6-\
c915df79d02e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"coverGlassExistence", "::", "usage"}], "=", 
   "\"\<coverGlassExistence is a result tag of biasphericAplanatSolver and if \
True, input parameter set has a cover glass in the image space.\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8024645535605793`*^9, 3.802464605735347*^9}, {
  3.802464658510466*^9, 3.802464734627543*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"2d14b8ca-ac61-4ca6-aae3-65915ee9b230"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"objectSideCoverGlassExistence", "::", "usage"}], "=", 
   "\"\<objectSideCoverGlassExistence is a result tag of \
biasphericAplanatSolver and if True, input parameter set has a cover glass in \
the object space. If conjugateInfiniteness is True, a \
coverGlassInObjectSpaceExistence rule expression is not included.\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802464741152821*^9, 3.802464834381137*^9}, {
  3.802464982513332*^9, 
  3.802464990701086*^9}},ExpressionUUID->"5742395c-c581-4828-9038-\
a57a82d74cab"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"paraxialParamters", "::", "usage"}], "=", 
   "\"\<paraxialParamters is a result tag of biasphericAplanatSolver and \
contains paraxial parameters.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802397633989977*^9, 3.8023976397699347`*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"503eeee6-735c-48a9-b6b6-976e6f4e6c32"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"inputParameters", "::", "usage"}], "=", 
   "\"\<inputParameters is a result tag of biasphericAplanatSolver. The rhs \
is exactly the same as input parameter set.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802397633989977*^9, 3.8023976363040752`*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"cda3b684-fef6-4a1d-b0b8-7b71ec17e727"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"setOpticsFor2DRayTrace", "::", "usage"}], "=", 
   "\"\<setOpticsFor2DRayTrace[op_Symbol,solverResult_:{__Rule},opt___Rule] \
build a optical object of RayTrace2D package. You can trace rays in the y-z \
plane to show the result graphically. You can refer the package description \
to know how to use the optical object.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802397633989977*^9, 3.8023976363040752`*^9}, {
  3.802649834281837*^9, 
  3.802649981488871*^9}},ExpressionUUID->"ff528956-a7d6-4296-b81e-\
0e84b967f777"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"tracingWavelength", "::", "usage"}], "=", 
   "\"\<tracingWavelength is an option of setOpticsFor2DRayTrace and \
specifies wavelength of ray to trace. Default value is 'designWavelength' in \
solverSesult.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802397633989977*^9, 3.8023976363040752`*^9}, {
  3.802649834281837*^9, 
  3.802649982737306*^9}},ExpressionUUID->"6afec121-59f0-4960-8faa-\
14207e7e9689"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"decenterBetweenAspherics", "::", "usage"}], "=", 
   "\"\<decenterBetweenAspherics is an option of setOpticsFor2DRayTrace and \
specifies decenter length between two aspherical surfaces. Default value is \
0.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802397633989977*^9, 3.8023976363040752`*^9}, {
  3.802649834281837*^9, 
  3.802649982737306*^9}},ExpressionUUID->"9d0301eb-5353-4fff-aa6f-\
5b5dd1bcb4f7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"setupBiasphericAplanatParameters", "::", "usage"}], "=", 
   "\"\<buildBiasphericAplanatParameters[__Rule] is a utlity function to \
build a consistent parameter set for solver. All parameters should be \
specified Rule style i.e., parameterName->value.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"biasphericAplanatParameterSymbols", "::", "usage"}], "=", 
   "\"\<biasphericAplanatParameterSymbols contains parameter symbol set for \
the solver.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"paraxialOutlineGraphicsForParameters", "::", "usage"}], "=", 
   "\"\<paraxialOutlineGraphicsForParameters[__Rule] draws a graphics of \
paraxial lens shape for checking.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"interactiveParameterSettingForBiasphericAplanat", "::", "usage"}],
    "=", "\"\<interactiveParameterSettingForBiasphericAplanat[opt___Rule] \
displays a notebook with dialog boxes for parameters.\>\""}], ";"}]}], "Input",\

 InitializationCell->True,
 CellLabel->"In[82]:=",ExpressionUUID->"fedb3f80-47de-4ec4-886a-e308ad9a3f75"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"biasphericAplanatSolve", "::", "usage"}], "=", 
   "\"\<biasphericAplanatSolve[parameters__Rule] performs numerical \
integration to fix shapes of two aspheric sufaces following given parameters \
and returns a list of InterpolatingFunctions of the shape and other \
characteristic values in a rule style. biasphericAplanatSolve can accept \
output of setupBiasphericAplanatParameters function as parameter arguments \
and Options of NDSolve built-in function.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802470862705886*^9, 3.802471030612254*^9}, {
  3.802471072419009*^9, 3.802471136600071*^9}, {3.802471167199789*^9, 
  3.8024712703769293`*^9}, {3.802471311080083*^9, 3.802471319449934*^9}, {
  3.8027357594757967`*^9, 
  3.802735777925179*^9}},ExpressionUUID->"9cd3e17c-59da-4169-934f-\
f6b08d34f6dc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"solverAsphericalSurface", "::", "usage"}], "=", 
   "\"\<solverAsphericalSurface is a surface attribute of solver generated \
surface.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"frontSolverAsphericalSurface", "::", "usage"}], "=", 
   "\"\<frontSolverAsphericalSurface is a attribute value for \
solverAsphericalSurface.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"backSolverAsphericalSurface", "::", "usage"}], "=", 
   "\"\<backSolverAsphericalSurface is a attribute value for \
solverAsphericalSurface.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"frontAsphericalSurfacePosition", "::", "usage"}], "=", 
   "\"\<frontAsphericalSurfacePosition[op_?opticsQ] returns front surface \
poisition in optics.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"backAsphericalSurfacePosition", "::", "usage"}], "=", 
   "\"\<frontAsphericalSurfacePosition[op_?opticsQ] returns back surface \
poisition in optics.\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802470862705886*^9, 3.802471030612254*^9}, {
  3.802471072419009*^9, 3.802471136600071*^9}, {3.802471167199789*^9, 
  3.8024712703769293`*^9}, {3.802471311080083*^9, 3.802471319449934*^9}, {
  3.8027357594757967`*^9, 3.8027358177392197`*^9}, {3.802736113944681*^9, 
  3.802736176337511*^9}, {3.802736322780486*^9, 3.802736378311407*^9}, {
  3.802740839586405*^9, 
  3.802740841836474*^9}},ExpressionUUID->"40e1d1b0-4bbc-44a1-b783-\
9717b71b9132"],

Cell[CellGroupData[{

Cell["for maximum efficient", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.804894407988111*^9, 
  3.804894418909815*^9}},ExpressionUUID->"15091470-efc8-486d-b9fc-\
206bd21d8926"],

Cell[BoxData[
 RowBox[{"BiasphericAplanatSolverCoreFunctionUsage", "=", 
  "\"\<Definitions of core functions of the solver bellow.\nYou can use the \
functions in your optimization loop.\nAll functions have fixed and ordered \
arguments.\nIf the arguments include inconsistency, the result is not \
guaranteed.\n\nFive functions are now provided:\n\t- Infinite conjugate\n\t\t\
- no cover glass\n\t\t- with cover glass\n\t- Finite conjugate\n\t\t- no \
cover glass\n\t\t- with cover glass in image space\n\t\t- with cover glass in \
object space\n\t\t- with cover glasses in both image and object space\n\n\
Function arguments:\n\tna:\tnumerical aperture target\n\tn:\trefractive index \
value of lens medium\n\td:\tlens thickness\n\tm:\tmechanical working distance \
(image space) for infinite conjugate case\n\tf:\tfocal length\n\tdc:\t\
thickness of cover glass  for infinite conjugate case\n\tnc:\trefractive \
index  of cover glass  for infinite conjugate case\n\tm1:\tmechanical working \
distance in image space for finite conjugate case\n\tm2:\tmechanical working \
distance in object space for finite conjugate case\n\tbeta:\tlateral \
magnification for finite conjugate case\n\tdc1:\tthickness of cover glass  in \
image space for finite conjugate case\n\tnc1:\trefractive index  of cover \
glass  in image space for finite conjugate case\n\tdc2:\tthickness of cover \
glass  in object space for finite conjugate case\n\tnc2:\trefractive index  \
of cover glass  in object space for finite conjugate case\nYou can find the \
order of the arguments in their usage messages.\n\nFunction returns a list \
with a style bellow:\n\t{_InterpolatingFunction, _InterpolatingFunction}\n\
First element of the list is an interpolation function of front surface and \
second is of back.\nThe function domain is {0,h}\nhere, \[OpenCurlyQuote]h\
\[CloseCurlyQuote] is a maximum height of the surface.\>\""}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.804894462809104*^9, 3.8048951661691236`*^9}, {
  3.80489534472252*^9, 3.804895350886181*^9}, {3.804895384423871*^9, 
  3.804895541014523*^9}, {3.804895573606103*^9, 3.8048956068944063`*^9}, {
  3.8048957525644817`*^9, 3.804895752730961*^9}, {3.804895815013826*^9, 
  3.804896033773065*^9}},ExpressionUUID->"a42dd351-ad62-40f2-a95b-\
5748f5f37c57"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiasphericAplanatSolverCoreFunctions", "=", 
   RowBox[{"{", 
    RowBox[{
    "SolveInfinite", ",", "SolveInfiniteWithCoverGlass", ",", "SolveFinite", 
     ",", "SolveFiniteWithCoverGlass", ",", 
     "SolveFiniteWithObjectSpaceCoverGlass", ",", 
     "SolveFiniteWithBothSpaceCoverGlass"}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.804896083901915*^9, 
  3.804896117215064*^9}},ExpressionUUID->"04677b2f-acd8-418b-ae57-\
611b8238bed4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SolveInfinite", "::", "usage"}], "=", 
   "\"\<SolveInfinite[na_,n_,d_,m_,f_,opt___]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SolveInfiniteWithCoverGlass", "::", "usage"}], "=", 
   "\"\<SolveInfiniteWithCoverGlass[na_,n_,d_,m_,f_,dc_,nc_,opt___]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SolveFinite", "::", "usage"}], "=", 
   "\"\<SolveFinite[na_,n_,d_,m1_,m2_,beta_,opt___]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SolveFiniteWithCoverGlass", "::", "usage"}], "=", 
   "\"\<SolveFiniteWithCoverGlass[na_,n_,d_,m1_,m2_,beta_,dc_,nc_,opt___]\>\"\
"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SolveFiniteWithObjectSpaceCoverGlass", "::", "usage"}], "=", 
   "\"\<SolveFiniteWithObjectSpaceCoverGlass[na_,n_,d_,m1_,m2_,beta_,dc_,nc_,\
opt___]\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SolveFiniteWithBothSpaceCoverGlass", "::", "usage"}], "=", 
   "\"\<SolveFiniteWithBothSpaceCoverGlass[na_,n_,d_,m1_,m2_,beta_,dc1_,nc1_,\
dc2_,nc2_,opt___]\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.804894430092827*^9, 3.804894435232066*^9}, {
  3.804895554391664*^9, 3.804895567621168*^9}, {3.804895617336735*^9, 
  3.804895677569611*^9}},ExpressionUUID->"cf6c962f-b779-4496-a52d-\
b18a88bb1f53"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Private section declaration", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.80058139376401*^9, 
  3.800581429921256*^9}},ExpressionUUID->"61d116e8-3fd1-40e1-9860-\
08d499f273ac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8005813760366297`*^9, 3.800581419447241*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"85ec62f6-ee45-4c9a-8329-6e5c5b416683"]
}, Open  ]],

Cell[CellGroupData[{

Cell["private section", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.802386985930896*^9, 
  3.802386990811246*^9}},ExpressionUUID->"76ee2710-ca4b-4daf-ae54-\
a8abb19ff956"],

Cell[BoxData[
 RowBox[{
  RowBox[{"biasphericAplanatParameterSymbols", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "designWavelength", ",", "lensMediumSymbol", ",", 
       "numericalApertureTarget", ",", "mechanicalImageDistance", ",", 
       "mechanicalObjectDistance", ",", "coverGlassExistence", ",", 
       "coverGlassMediumSymbol", ",", "coverGlassThickness", ",", 
       "mechanicalObjectImageDistance", ",", "objectSideCoverGlassExistence", 
       ",", "objectSideCoverGlassMediumSymbol", ",", 
       "objectSideCoverGlassThickness", ",", "marginRatio"}], "}"}], ",", 
     "singletParaxialParameterSymbols"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.802397064155141*^9, {3.802397169154251*^9, 3.8023971816852217`*^9}, {
   3.802397274262743*^9, 3.802397280001607*^9}, {3.8023973536209993`*^9, 
   3.8023973540598783`*^9}, {3.802397731043639*^9, 3.802397731278694*^9}, {
   3.802402658759639*^9, 3.802402662134605*^9}, 3.8024030167176*^9, {
   3.8024649609927807`*^9, 3.802464961192774*^9}, {3.802464998092454*^9, 
   3.802464998363077*^9}, {3.803082273731113*^9, 
   3.8030822863704557`*^9}},ExpressionUUID->"dbcee280-d251-495b-8229-\
8cc7ae715cd1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$marginRatio", "=", "1.02"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802468570125263*^9, 3.802468574972724*^9}, {
  3.802562186815317*^9, 3.8025621869131393`*^9}},
 CellLabel->
  "In[389]:=",ExpressionUUID->"4e7a85bf-3a97-47fd-b4c3-9536fb911fcd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "setDefaultMarginRatio", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"setDefaultMarginRatio", "::", "notnumeric"}], "=", 
   "\"\<argument `1` should be a numeric value.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"setDefaultMarginRatio", "::", "lessthan1"}], "=", 
   "\"\<argument `1` should be greater than 1.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"setDefaultMarginRatio", "[", "mratio_", "]"}], "/;", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"NumericQ", "[", "mratio", "]"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"N", "[", "mratio", "]"}], ">", "1."}], ",", "True", ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"setDefaultMarginRatio", "::", "lessthan1"}], ",", 
          "mratio"}], "]"}], ";", "False"}]}], "]"}], ",", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"setDefaultMarginRatio", "::", "notnumeric"}], ",", 
        "mratio"}], "]"}], ";", "False"}]}], "]"}]}], ":=", 
  RowBox[{"(", 
   RowBox[{"$marginRatio", "=", "mratio"}], ")"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802468536531254*^9, 3.802468899259598*^9}, {
  3.802468957007215*^9, 3.802468958456623*^9}},
 CellLabel->
  "In[390]:=",ExpressionUUID->"12e66b62-170c-4fb9-863b-9ae79dee2139"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "setupBiasphericAplanatParameters", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "setupBiasphericAplanatParameters", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"marginRatio", "->", "$marginRatio"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"setupBiasphericAplanatParameters", "[", "parameters__Rule", "]"}], 
  ":=", 
  RowBox[{"setupBiasphericAplanatParameters", "[", 
   RowBox[{"{", "parameters", "}"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.802397959713848*^9, {3.802398438665955*^9, 3.802398572419948*^9}, {
   3.802399053684394*^9, 3.802399067392112*^9}, {3.802399236628495*^9, 
   3.802399264395679*^9}, {3.802399381724565*^9, 3.802399392580521*^9}, {
   3.802399562165317*^9, 3.802399632657939*^9}, {3.802400069537951*^9, 
   3.8024001493671494`*^9}, {3.802400183748189*^9, 3.8024002401122437`*^9}, {
   3.8024009629903393`*^9, 3.802400988800387*^9}, {3.8024010204037457`*^9, 
   3.802401094902169*^9}, {3.80240113244516*^9, 3.802401149893077*^9}, {
   3.802401187953054*^9, 3.8024012043664427`*^9}, {3.802402419460322*^9, 
   3.8024026413114643`*^9}, {3.802402682362464*^9, 3.802402811976101*^9}, {
   3.8024688771513557`*^9, 3.802468880908556*^9}, {3.8024690275353413`*^9, 
   3.802469032393571*^9}, {3.802469103001176*^9, 3.8024691057666283`*^9}, {
   3.802469141238006*^9, 3.802469145411783*^9}, {3.802475566611185*^9, 
   3.802475584181175*^9}},
 CellLabel->
  "In[394]:=",ExpressionUUID->"4ac9502a-3cfe-40c4-88d1-bde27bc59542"],

Cell[BoxData[
 RowBox[{
  RowBox[{"setupBiasphericAplanatParameters", "[", 
   RowBox[{"parameters", ":", 
    RowBox[{"{", "__Rule", "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "wl", ",", "lm", ",", "n", ",", "icQ", ",", "ocQ", ",", "difid", ",", 
      "difod", ",", "pwd", ",", "pod", ",", "poi", ",", "paramp", ",", 
      "paraparm", ",", "conj", ",", "remp"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"wl", "=", 
      RowBox[{"designWavelength", "/.", "parameters"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", " ", 
        RowBox[{"NumericQ", "[", "wl", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"setupBiasphericAplanatParameters", "::", "needslambda"}], 
         "]"}], ";", 
        RowBox[{"Return", "[", "$Fialed", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"lm", "=", 
      RowBox[{"lensMediumSymbol", "/.", "parameters"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", " ", 
        RowBox[{"mediumQ", "[", "lm", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"setupBiasphericAplanatParameters", "::", "notmedium"}], 
          ",", "lm", ",", "lensMediumSymbol"}], "]"}], ";", 
        RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{"refractiveIndexValue", "[", 
       RowBox[{"lm", ",", "wl"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"icQ", "=", 
      RowBox[{"hasImageSpaceCoverGlassPresentQ", "[", "parameters", "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"difid", "=", 
      RowBox[{"If", "[", 
       RowBox[{"icQ", ",", 
        RowBox[{"Check", "[", 
         RowBox[{
          RowBox[{"differenceToParaxialCoverGlass", "[", 
           RowBox[{"wl", ",", 
            RowBox[{"{", 
             RowBox[{"coverGlassMediumSymbol", ",", "coverGlassThickness"}], 
             "}"}], ",", "parameters"}], "]"}], ",", 
          RowBox[{"Return", "[", "parameters", "]"}]}], "]"}], ",", "0.0"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pwd", "=", 
      RowBox[{"mechanicalImageDistance", "/.", "parameters"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ocQ", "=", 
      RowBox[{"hasObjectSpaceCoverGlassPresentQ", "[", "parameters", "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"difod", "=", 
      RowBox[{"If", "[", 
       RowBox[{"ocQ", ",", 
        RowBox[{"Check", "[", 
         RowBox[{
          RowBox[{"differenceToParaxialCoverGlass", "[", 
           RowBox[{"wl", ",", 
            RowBox[{"{", 
             RowBox[{
             "objectSideCoverGlassMediumSymbol", ",", 
              "objectSideCoverGlassThickness"}], "}"}], ",", "parameters"}], 
           "]"}], ",", 
          RowBox[{"Return", "[", "parameters", "]"}]}], "]"}], ",", "0.0"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pod", "=", 
      RowBox[{"mechanicalObjectDistance", "/.", "parameters"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"poi", "=", 
      RowBox[{"mechanicalObjectImageDistance", "/.", "parameters"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"paramp", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{"parameters", ",", 
         RowBox[{"lensMediumRefractiveIndex", "\[Rule]", "n"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"NumericQ", "[", "pwd", "]"}], ",", 
           RowBox[{"paraxialWorkingDistance", "\[Rule]", 
            RowBox[{"pwd", "+", "difid"}]}], ",", "Nothing"}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"NumericQ", "[", "pod", "]"}], ",", 
           RowBox[{"paraxialObjectDistance", "\[Rule]", 
            RowBox[{"pod", "+", "difod"}]}], ",", "Nothing"}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"NumericQ", "[", "poi", "]"}], ",", 
           RowBox[{"paraxialObjectImageDistance", "\[Rule]", 
            RowBox[{"poi", "+", "difid", "+", "difod"}]}], ",", "Nothing"}], 
          "]"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"paraparm", "=", 
      RowBox[{"Check", "[", 
       RowBox[{
        RowBox[{"settleRemainedParaxialParameters", "[", "paramp", "]"}], ",", 
        RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"remp", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"NumericQ", "[", "pwd", "]"}]}], ",", 
          RowBox[{"mechanicalImageDistance", "\[Rule]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"paraxialWorkingDistance", "/.", "paraparm"}], ")"}], 
            "-", "difid"}]}], ",", "Nothing"}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"(", 
            RowBox[{"conjugateInfiniteness", "/.", "paraparm"}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", " ", 
               RowBox[{"NumericQ", "[", "pod", "]"}]}], ",", 
              RowBox[{"mechanicalObjectDistance", "\[Rule]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"paraxialObjectDistance", "/.", "paraparm"}], ")"}], 
                "-", "difod"}]}], ",", "Nothing"}], "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", " ", 
               RowBox[{"NumericQ", "[", "poi", "]"}]}], ",", 
              RowBox[{"mechanicalObjectImageDistance", "\[Rule]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"paraxialObjectImageDistance", "/.", "paraparm"}], 
                 ")"}], "-", "difid", "-", "difod"}]}], ",", "Nothing"}], 
             "]"}]}], "}"}], ",", "Nothing"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Apply", "[", 
      RowBox[{"Sequence", ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{"paramp", ",", 
          RowBox[{"coverGlassExistence", "\[Rule]", "icQ"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"conjugateInfiniteness", "/.", "paraparm"}], ",", 
            "Nothing", ",", 
            RowBox[{"objectSideCoverGlassExistence", "\[Rule]", "ocQ"}]}], 
           "]"}], ",", "remp", ",", "paraparm", ",", 
          RowBox[{"Options", "[", "setupBiasphericAplanatParameters", "]"}]}],
          "}"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{
  3.802397959713848*^9, {3.802398438665955*^9, 3.802398572419948*^9}, {
   3.802399053684394*^9, 3.802399067392112*^9}, {3.802399236628495*^9, 
   3.802399264395679*^9}, {3.802399381724565*^9, 3.802399392580521*^9}, {
   3.802399562165317*^9, 3.802399632657939*^9}, {3.802400069537951*^9, 
   3.8024001493671494`*^9}, {3.802400183748189*^9, 3.8024002401122437`*^9}, {
   3.8024009629903393`*^9, 3.802400988800387*^9}, {3.8024010204037457`*^9, 
   3.802401094902169*^9}, {3.80240113244516*^9, 3.802401149893077*^9}, {
   3.802401187953054*^9, 3.8024012043664427`*^9}, {3.802402419460322*^9, 
   3.8024026413114643`*^9}, {3.802402682362464*^9, 3.8024028320694227`*^9}, {
   3.8024033297183323`*^9, 3.8024033330712423`*^9}, {3.8024045133730793`*^9, 
   3.802404526231255*^9}, {3.802404601622539*^9, 3.80240464997154*^9}, {
   3.8024047213322983`*^9, 3.802404724559717*^9}, {3.802404978444043*^9, 
   3.8024051068294363`*^9}, 3.802406048942718*^9, {3.802465105693207*^9, 
   3.802465155568142*^9}, {3.8024652077752943`*^9, 3.802465409803726*^9}, 
   3.802466067570117*^9, {3.802466101253059*^9, 3.802466133003619*^9}, {
   3.802466252635639*^9, 3.802466253994726*^9}, {3.802466377691471*^9, 
   3.8024663882438707`*^9}, {3.802468386116829*^9, 3.802468409493663*^9}, {
   3.802469132779398*^9, 3.80246917726278*^9}, 3.802469209281027*^9, {
   3.802469249468053*^9, 3.802469255575354*^9}, {3.8024693826820908`*^9, 
   3.80246939154498*^9}, 3.802469456625636*^9, 3.802472263367271*^9, 
   3.802472426731536*^9, {3.802472487326521*^9, 3.802472488854422*^9}, {
   3.8024725195243683`*^9, 3.8024725214913054`*^9}, {3.8024726335438337`*^9, 
   3.802472644455668*^9}, 3.802472711844191*^9, {3.802472884547014*^9, 
   3.802472889325747*^9}, {3.802554567373337*^9, 3.8025546188667717`*^9}, {
   3.802554758852512*^9, 3.802554790577938*^9}, {3.802554860384397*^9, 
   3.802555048718719*^9}, {3.802555175520254*^9, 3.80255522061096*^9}},
 CellLabel->
  "In[397]:=",ExpressionUUID->"aa186a62-df25-4f77-ab09-c50c716130fc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"hasImageSpaceCoverGlassPresentQ", "[", "parameters__Rule", "]"}], ":=", 
  RowBox[{"hasImageSpaceCoverGlassPresentQ", "[", 
   RowBox[{"{", "parameters", "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hasImageSpaceCoverGlassPresentQ", "[", 
   RowBox[{"parameters", ":", 
    RowBox[{"{", "__Rule", "}"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"plist", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"First", ",", "parameters"}], "]"}]}], "}"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"SubsetQ", "[", 
       RowBox[{"plist", ",", 
        RowBox[{"{", 
         RowBox[{"coverGlassMediumSymbol", ",", "coverGlassThickness"}], 
         "}"}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"coverGlassMediumSymbol", "/.", "parameters"}], ")"}], "=!=",
          "atmosphere"}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"N", "[", 
          RowBox[{"(", 
           RowBox[{"coverGlassThickness", "/.", "parameters"}], ")"}], "]"}], 
         ">", "0.0"}], ")"}]}], ",", "False"}], "]"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802398187235137*^9, 3.802398331824272*^9}, {
  3.802403192998918*^9, 3.802403199474133*^9}, {3.802403318863082*^9, 
  3.802403321605794*^9}, {3.802472835652307*^9, 3.802472837237402*^9}},
 CellLabel->
  "In[398]:=",ExpressionUUID->"db1571c6-6d2d-4b1f-8d92-bfaedf6403b0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"hasObjectSpaceCoverGlassPresentQ", "[", "parameters__Rule", "]"}], 
  ":=", 
  RowBox[{"hasObjectSpaceCoverGlassPresentQ", "[", 
   RowBox[{"{", "parameters", "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hasObjectSpaceCoverGlassPresentQ", "[", 
   RowBox[{"parameters", ":", 
    RowBox[{"{", "__Rule", "}"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"plist", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"First", ",", "parameters"}], "]"}]}], "}"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"SubsetQ", "[", 
       RowBox[{"plist", ",", 
        RowBox[{"{", 
         RowBox[{
         "objectSideCoverGlassMediumSymbol", ",", 
          "objectSideCoverGlassThickness"}], "}"}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"objectSideCoverGlassMediumSymbol", "/.", "parameters"}], 
          ")"}], "=!=", "atmosphere"}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"N", "[", 
          RowBox[{"(", 
           RowBox[{"objectSideCoverGlassThickness", "/.", "parameters"}], 
           ")"}], "]"}], ">", "0.0"}], ")"}]}], ",", "False"}], "]"}]}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802398344355693*^9, 3.802398389547955*^9}, {
  3.802400168091587*^9, 3.802400168092942*^9}, {3.802403203020505*^9, 
  3.8024032129862328`*^9}, {3.8024033571283216`*^9, 3.80240335774614*^9}, {
  3.802472842075241*^9, 3.802472843953616*^9}},
 CellLabel->
  "In[400]:=",ExpressionUUID->"d31fe10d-f2fc-4a2c-89fa-49e53ac1811d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"differenceToParaxialCoverGlass", "[", 
   RowBox[{"wavelength_", ",", 
    RowBox[{"{", 
     RowBox[{"cgms_", ",", "cgt_"}], "}"}], ",", 
    RowBox[{"parameters", ":", 
     RowBox[{"{", "__Rule", "}"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mc", ",", "nc", ",", "dc", ",", "wd"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mc", "=", 
      RowBox[{"cgms", "/.", "parameters"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", " ", 
        RowBox[{"mediumQ", "[", "mc", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"setupBiasphericAplanatParameters", "::", "notmedium"}], 
          ",", "mc", ",", "cgms"}], "]"}], ";", 
        RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nc", "=", 
      RowBox[{"refractiveIndexValue", "[", 
       RowBox[{"mc", ",", "wavelength"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dc", "=", 
      RowBox[{"cgt", "/.", "parameters"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"paraxialThickessDifferenceFromMechanical", "[", 
      RowBox[{"nc", ",", "dc"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802399074951975*^9, 3.80239913778476*^9}, {
   3.80239918083899*^9, 3.8023992060957613`*^9}, {3.8023994870371437`*^9, 
   3.802399546673298*^9}, {3.802399648251264*^9, 3.8023997184532833`*^9}, {
   3.802399770484194*^9, 3.802399872187379*^9}, {3.802399906567019*^9, 
   3.802400042366877*^9}, {3.8024009186319227`*^9, 3.80240095043307*^9}, {
   3.802403263512431*^9, 3.80240326607593*^9}, {3.802472680355164*^9, 
   3.8024726845280457`*^9}, 3.802473334474917*^9},
 CellLabel->
  "In[402]:=",ExpressionUUID->"19a05a73-3eed-4709-82b7-dde6d6cd2cb1"],

Cell[BoxData[""], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802471693397974*^9, 3.80247174284264*^9}},
 CellLabel->
  "In[403]:=",ExpressionUUID->"200e5e24-d7a2-4dce-bf09-000180eaf815"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "biasphericAplanatSolve", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"biasphericAplanatSolve", "[", "parameters__Rule", "]"}], ":=", 
  RowBox[{"biasphericAplanatSolve", "[", 
   RowBox[{"{", "parameters", "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"biasphericAplanatSolve", "[", 
   RowBox[{"parameters", ":", 
    RowBox[{"{", "__Rule", "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "wl", ",", "ml", ",", "na", ",", "iconj", ",", "cgi", ",", "cgo"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"iconj", "=", 
      RowBox[{"conjugateInfiniteness", "/.", "parameters"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", " ", 
        RowBox[{"TrueQ", "[", 
         RowBox[{"Element", "[", 
          RowBox[{"iconj", ",", "Booleans"}], "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"biasphericAplanatSolve", "::", "usesetup"}], "]"}], ";", 
        RowBox[{"Return", "[", "parameters", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"wl", "=", 
      RowBox[{"designWavelength", "/.", "parameters"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", " ", 
        RowBox[{"NumericQ", "[", "wl", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"biasphericAplanatSolve", "::", "usesetup"}], "]"}], ";", 
        RowBox[{"Return", "[", "parameters", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ml", "=", 
      RowBox[{"lensMediumSymbol", "/.", "parameters"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", " ", 
        RowBox[{"mediumQ", "[", "ml", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"biasphericAplanatSolve", "::", "usesetup"}], "]"}], ";", 
        RowBox[{"Return", "[", "parameters", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"na", "=", 
      RowBox[{"numericalApertureTarget", "/.", "parameters"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", " ", 
        RowBox[{"NumericQ", "[", "na", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"biasphericAplanatSolve", "::", "usesetup"}], "]"}], ";", 
        RowBox[{"Return", "[", "parameters", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cgi", "=", 
      RowBox[{"coverGlassExistence", "/.", "parameters"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", " ", "iconj"}], ",", 
       RowBox[{"cgo", "=", 
        RowBox[{"objectSideCoverGlassExistence", "/.", "parameters"}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"branchSolver", "[", 
      RowBox[{"iconj", ",", "cgi", ",", "cgo", ",", "parameters"}], "]"}]}]}],
    "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwd0E8oQ3EAB/Bn/hxmB41ForggUsphidIrsXIZsWWl1tPiMivJEg42Ym2r
2eollj/Z27SDtdTaTcvztC1P0xxoFpNymPSuOHjf3+Hbp+/le/i2M7ZJi4Ki
qGY5UEkP28+mynSfLeqEatHqggajQBT0wj5kfRWnsCUcj8GoZL6HS+uBPLSP
x14g/63aCcn6nZW78EFgPFDs4vxwm605gQ7vdQQa5gZjcLUteQlnNKUkLOSt
KRiQOvWc7IWuygRD3SNmeLucJRYSrQtw6GiNGFApF+GxxUxs+HT6IN+U3YMd
aUcQUm9e4uthOUx2fbYI5KpnU9D91cPDn9qBNCzqjBn4q1bkYEk0PcJ4v/QE
WWP9M9zQBIukz7s+YGNS2jzHj1ppC/6NsW4oeg6Idb250YxsglFPQO5Ky99N
l+mV9+wN/Ae+Rd9V
  "],ExpressionUUID->"b1aa4135-0971-4313-8716-cfc751769a08"],

Cell[BoxData[
 RowBox[{
  RowBox[{"branchSolver", "[", 
   RowBox[{"iconj_", ",", "cgi_", ",", "cgo_", ",", "parameters_"}], "]"}], ":=", 
  RowBox[{"Switch", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"iconj", ",", "cgi", ",", "cgo"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"True", ",", "False", ",", "_"}], "}"}], ",", 
    RowBox[{"biasphericAplanatSolveInfinite", "[", "parameters", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"True", ",", "True", ",", "_"}], "}"}], ",", 
    RowBox[{
    "biasphericAplanatSolveInfiniteWithCoverGlass", "[", "parameters", "]"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"False", ",", "False", ",", "False"}], "}"}], ",", 
    RowBox[{"biasphericAplanatSolveFinite", "[", "parameters", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"False", ",", "True", ",", "False"}], "}"}], ",", 
    RowBox[{
    "biasphericAplanatSolveFiniteWithImageCoverGlass", "[", "parameters", 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"False", ",", "False", ",", "True"}], "}"}], ",", 
    RowBox[{
    "biasphericAplanatSolveFiniteWithObjectCoverGlass", "[", "parameters", 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"False", ",", "True", ",", "True"}], "}"}], ",", 
    RowBox[{
    "biasphericAplanatSolveFiniteWithBothImageAndObjectCoverGlass", "[", 
     "parameters", "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802473957676107*^9, 3.802474024817115*^9}, {
  3.80247449427626*^9, 3.802474584682728*^9}, {3.802474755022025*^9, 
  3.8024748975831633`*^9}},
 CellLabel->
  "In[407]:=",ExpressionUUID->"f38cd959-e1e1-4c41-a45e-fc36f7987752"],

Cell[BoxData[
 RowBox[{
  RowBox[{"commonParameters", "[", 
   RowBox[{"parameters", ":", 
    RowBox[{"{", "__Rule", "}"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"(*", 
     RowBox[{"{", 
      RowBox[{"mr", ",", "na", ",", "n", ",", "d", ",", "m"}], "}"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
    "marginRatio", ",", "\[IndentingNewLine]", "numericalApertureTarget", ",",
      "\[IndentingNewLine]", 
     RowBox[{"refractiveIndexValue", "[", 
      RowBox[{"lensMediumSymbol", ",", "designWavelength"}], "]"}], ",", 
     "\[IndentingNewLine]", "lensMediumThickness", ",", 
     "mechanicalImageDistance"}], "}"}], "/.", "parameters"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802481373446391*^9, 3.8024813976676064`*^9}, {
  3.802481434218557*^9, 3.802481595016695*^9}, {3.802492847369088*^9, 
  3.8024928711835747`*^9}, {3.802550927889182*^9, 3.8025509354808693`*^9}, {
  3.802554169842011*^9, 3.8025541718749847`*^9}, {3.80308227374514*^9, 
  3.803082286372192*^9}},ExpressionUUID->"3f44786d-46f4-4d8b-99fb-\
8db4dd93ab09"],

Cell[BoxData[
 RowBox[{
  RowBox[{"filterNDSolveOptions", "[", 
   RowBox[{"parameters", ":", 
    RowBox[{"{", "__Rule", "}"}]}], "]"}], ":=", 
  RowBox[{"Apply", "[", 
   RowBox[{"Sequence", ",", 
    RowBox[{"FilterRules", "[", 
     RowBox[{"parameters", ",", 
      RowBox[{"Options", "[", "NDSolve", "]"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8025523161242533`*^9, 3.802552372653842*^9}},
 CellLabel->
  "In[409]:=",ExpressionUUID->"c7860b4a-247e-4e75-8a6d-5e24e152b411"],

Cell[BoxData[
 RowBox[{
  RowBox[{"biasphericAplanatSolveInfinite", "[", 
   RowBox[{"parameters", ":", 
    RowBox[{"{", "__Rule", "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "x1", ",", "x2", ",", "mr", ",", "na", ",", "n", ",", "d", ",", "m", ",",
       "f", ",", "shps", ",", "secpnts", ",", "ana"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mr", ",", "na", ",", "n", ",", "d", ",", "m"}], "}"}], "=", 
      RowBox[{"commonParameters", "[", "parameters", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"f", "=", 
      RowBox[{"focalLength", "/.", "parameters"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1", ",", "x2"}], "}"}], "=", 
      RowBox[{"SolveInfinite", "[", 
       RowBox[{
        RowBox[{"mr", "*", "na"}], ",", "n", ",", "d", ",", "m", ",", "f", 
        ",", 
        RowBox[{"filterNDSolveOptions", "[", "parameters", "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"secpnts", "=", 
      RowBox[{"interpolationSectionPoints", "[", "x1", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ana", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Last", "[", "secpnts", "]"}], "/", "mr"}], "/.", 
       "parameters"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"frontSurfaceShapeFunction", "->", 
         RowBox[{"Interpolation", "[", 
          RowBox[{"mirroredData", "[", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"f", "*", "#"}], ",", 
                RowBox[{"x1", "[", "#", "]"}]}], "}"}], "&"}], ",", 
             "secpnts"}], "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"backSurfaceShapeFunction", "->", 
         RowBox[{"Interpolation", "[", 
          RowBox[{"mirroredData", "[", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"#", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"m", "-", 
                    RowBox[{"x2", "[", "#", "]"}]}], ")"}], "/", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"1.0", "-", 
                    RowBox[{"#", "^", "2"}]}], "]"}]}]}], ",", 
                RowBox[{
                 RowBox[{"x2", "[", "#", "]"}], "+", "d"}]}], "}"}], "&"}], 
             ",", "secpnts"}], "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"numericalAperture", "\[Rule]", "ana"}], ",", "parameters"}], 
       "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802473633660241*^9, 3.802473709956484*^9}, {
   3.8024738042004547`*^9, 3.8024738084541388`*^9}, {3.802474909542385*^9, 
   3.802474941514369*^9}, {3.802481258551177*^9, 3.802481286167738*^9}, 
   3.8024813210656776`*^9, {3.802481351247974*^9, 3.802481352756673*^9}, {
   3.8024814057794724`*^9, 3.8024814093120947`*^9}, {3.8024927928805656`*^9, 
   3.8024928013753157`*^9}, {3.802492849953521*^9, 3.8024928909614887`*^9}, {
   3.8024932608428707`*^9, 3.8024932700463867`*^9}, {3.8024934398920403`*^9, 
   3.802493446044735*^9}, {3.8024942848251266`*^9, 3.802494314050439*^9}, {
   3.802494438919032*^9, 3.802494482094445*^9}, {3.802494521167807*^9, 
   3.802494622879307*^9}, {3.8024947029356823`*^9, 3.8024947045079517`*^9}, {
   3.8024948778880243`*^9, 3.8024949673808527`*^9}, {3.802495014902197*^9, 
   3.8024951090656557`*^9}, {3.802495408312211*^9, 3.8024954085676947`*^9}, {
   3.802495442509974*^9, 3.802495454997752*^9}, {3.802495501214038*^9, 
   3.802495508546978*^9}, {3.8024957573117*^9, 3.802495760236515*^9}, {
   3.8024958681151953`*^9, 3.802495870565724*^9}, {3.8024959698493843`*^9, 
   3.802496000742865*^9}, {3.802550941063429*^9, 3.802550954381898*^9}, {
   3.802551231792245*^9, 3.802551340184362*^9}, 3.802551433930855*^9, {
   3.802552115771781*^9, 3.80255212513028*^9}, {3.802552384368813*^9, 
   3.8025523905531797`*^9}, {3.802552874425517*^9, 3.802552886281713*^9}, {
   3.802553087817971*^9, 3.802553229391675*^9}, {3.802553425598302*^9, 
   3.802553425813101*^9}, {3.8025535285342484`*^9, 3.802553577505382*^9}, {
   3.8025536301152563`*^9, 3.80255365366017*^9}, 
   3.803082381953073*^9},ExpressionUUID->"667a96d3-fc84-4744-a9a8-\
5ebc5828b7da"],

Cell[BoxData[
 RowBox[{
  RowBox[{"biasphericAplanatSolveInfiniteWithCoverGlass", "[", 
   RowBox[{"parameters", ":", 
    RowBox[{"{", "__Rule", "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "x1", ",", "x2", ",", "mr", ",", "na", ",", "n", ",", "d", ",", "m", ",",
       "f", ",", "dc", ",", "mc", ",", "nc", ",", "shps", ",", "secpnts", ",",
       "ana"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mr", ",", "na", ",", "n", ",", "d", ",", "m"}], "}"}], "=", 
      RowBox[{"commonParameters", "[", "parameters", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"f", "=", 
      RowBox[{"focalLength", "/.", "parameters"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dc", "=", 
      RowBox[{"coverGlassThickness", "/.", "parameters"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mc", "=", 
      RowBox[{"coverGlassMediumSymbol", "/.", "parameters"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nc", "=", 
      RowBox[{"refractiveIndexValue", "[", 
       RowBox[{"mc", ",", 
        RowBox[{"designWavelength", "/.", "parameters"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1", ",", "x2"}], "}"}], "=", 
      RowBox[{"SolveInfiniteWithCoverGlass", "[", 
       RowBox[{
        RowBox[{"mr", "*", "na"}], ",", "n", ",", "d", ",", "m", ",", "f", 
        ",", "dc", ",", "nc", ",", 
        RowBox[{"filterNDSolveOptions", "[", "parameters", "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"secpnts", "=", 
      RowBox[{"interpolationSectionPoints", "[", "x1", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ana", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Last", "[", "secpnts", "]"}], "/", "mr"}], "/.", 
       "parameters"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"frontSurfaceShapeFunction", "->", 
         RowBox[{"Interpolation", "[", 
          RowBox[{"mirroredData", "[", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"f", "*", "#"}], ",", 
                RowBox[{"x1", "[", "#", "]"}]}], "}"}], "&"}], ",", 
             "secpnts"}], "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"backSurfaceShapeFunction", "->", 
         RowBox[{"Interpolation", "[", 
          RowBox[{"mirroredData", "[", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"#", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"dc", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"1", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"#", "^", "2"}]}], "]"}]}], ")"}]}], "+", 
                    RowBox[{"1", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"#", "^", "2"}]}], "+", 
                    RowBox[{"nc", "^", "2"}]}], "]"}]}]}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"m", "-", 
                    RowBox[{"x2", "[", "#", "]"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"#", "^", "2"}]}], "]"}]}]}], ")"}]}], ",", 
                RowBox[{"d", "+", 
                 RowBox[{"x2", "[", "#", "]"}]}]}], "}"}], "&"}], ",", 
             "secpnts"}], "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"numericalAperture", "\[Rule]", "ana"}], ",", "parameters"}], 
       "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802473633660241*^9, 3.802473709956484*^9}, {
   3.8024738042004547`*^9, 3.8024738084541388`*^9}, {3.802474909542385*^9, 
   3.802474941514369*^9}, {3.802481258551177*^9, 3.802481286167738*^9}, 
   3.8024813210656776`*^9, {3.802481351247974*^9, 3.802481352756673*^9}, {
   3.8024814057794724`*^9, 3.8024814093120947`*^9}, {3.8024927928805656`*^9, 
   3.8024928013753157`*^9}, {3.802492849953521*^9, 3.8024928909614887`*^9}, {
   3.8024932608428707`*^9, 3.8024932700463867`*^9}, {3.8024934398920403`*^9, 
   3.802493446044735*^9}, {3.8024942848251266`*^9, 3.802494314050439*^9}, {
   3.802494438919032*^9, 3.802494482094445*^9}, {3.802494521167807*^9, 
   3.802494622879307*^9}, {3.8024947029356823`*^9, 3.8024947045079517`*^9}, {
   3.8024948778880243`*^9, 3.8024949673808527`*^9}, {3.802495014902197*^9, 
   3.8024951090656557`*^9}, {3.802495408312211*^9, 3.8024954085676947`*^9}, {
   3.802495442509974*^9, 3.802495454997752*^9}, {3.802495501214038*^9, 
   3.802495508546978*^9}, {3.8024957573117*^9, 3.802495760236515*^9}, {
   3.8024958681151953`*^9, 3.802495870565724*^9}, {3.8024959698493843`*^9, 
   3.802496000742865*^9}, {3.802550941063429*^9, 3.802550954381898*^9}, {
   3.802551231792245*^9, 3.802551340184362*^9}, 3.802551433930855*^9, {
   3.802552115771781*^9, 3.80255212513028*^9}, {3.802552384368813*^9, 
   3.8025523905531797`*^9}, {3.802552874425517*^9, 3.802552886281713*^9}, {
   3.802553087817971*^9, 3.802553229391675*^9}, {3.802553425598302*^9, 
   3.802553425813101*^9}, {3.8025535285342484`*^9, 3.802553577505382*^9}, {
   3.8025536301152563`*^9, 3.80255365366017*^9}, 3.802553699719733*^9, {
   3.8025706751317472`*^9, 3.802570892575569*^9}, 
   3.803082381955484*^9},ExpressionUUID->"7f3a6f61-86db-4c0c-88f1-\
a9c79dbc8944"],

Cell[BoxData[
 RowBox[{
  RowBox[{"biasphericAplanatSolveFinite", "[", 
   RowBox[{"parameters", ":", 
    RowBox[{"{", "__Rule", "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "x1", ",", "x2", ",", "mr", ",", "na", ",", "n", ",", "d", ",", "m1", 
      ",", "m2", ",", "oi", ",", "beta", ",", "shps", ",", "secpnts", ",", 
      "ana"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mr", ",", "na", ",", "n", ",", "d", ",", "m2"}], "}"}], "=", 
      RowBox[{"commonParameters", "[", "parameters", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"oi", "=", 
      RowBox[{"mechanicalObjectImageDistance", "/.", "parameters"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"m1", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"NumericQ", "[", "oi", "]"}], ",", 
        RowBox[{"oi", "-", "m2", "-", "d"}], ",", 
        RowBox[{"mechanicalObjectDistance", "/.", "parameters"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"beta", "=", 
      RowBox[{
       RowBox[{"-", "lateralMagnification"}], "/.", "parameters"}]}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{"why", " ", 
       RowBox[{"negate", "?", " ", "see"}], " ", "original", " ", 
       "expression"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1", ",", "x2"}], "}"}], "=", 
      RowBox[{"SolveFinite", "[", 
       RowBox[{
        RowBox[{"mr", "*", "na", "*", "beta"}], ",", "n", ",", "d", ",", "m1",
         ",", "m2", ",", "beta", ",", 
        RowBox[{"filterNDSolveOptions", "[", "parameters", "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"secpnts", "=", 
      RowBox[{"interpolationSectionPoints", "[", "x1", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ana", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Last", "[", "secpnts", "]"}], "/", "mr"}], "/", "beta"}], "/.",
        "parameters"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"frontSurfaceShapeFunction", "->", 
         RowBox[{"Interpolation", "[", 
          RowBox[{"mirroredData", "[", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#", "*", 
                   RowBox[{"(", 
                    RowBox[{"m1", "+", 
                    RowBox[{"x1", "[", "#", "]"}]}], ")"}]}], ")"}], "/", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{"1", "-", 
                   RowBox[{"#", "^", "2"}]}], "]"}]}], ",", 
                RowBox[{"x1", "[", "#", "]"}]}], "}"}], "&"}], ",", 
             "secpnts"}], "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"backSurfaceShapeFunction", "->", 
         RowBox[{"Interpolation", "[", 
          RowBox[{"mirroredData", "[", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#", "*", 
                   RowBox[{"(", 
                    RowBox[{"m2", "-", 
                    RowBox[{"x2", "[", "#", "]"}]}], ")"}]}], ")"}], "/", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"#", "^", "2"}]}], "+", 
                   RowBox[{"beta", "^", "2"}]}], "]"}]}], ",", 
                RowBox[{"d", "+", 
                 RowBox[{"x2", "[", "#", "]"}]}]}], "}"}], "&"}], ",", 
             "secpnts"}], "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"numericalAperture", "\[Rule]", "ana"}], ",", "parameters"}], 
       "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802473633660241*^9, 3.802473709956484*^9}, {
   3.8024738042004547`*^9, 3.8024738084541388`*^9}, {3.802474909542385*^9, 
   3.802474941514369*^9}, {3.802481258551177*^9, 3.802481286167738*^9}, 
   3.8024813210656776`*^9, {3.802481351247974*^9, 3.802481352756673*^9}, {
   3.8024814057794724`*^9, 3.8024814093120947`*^9}, {3.8024927928805656`*^9, 
   3.8024928013753157`*^9}, {3.802492849953521*^9, 3.8024928909614887`*^9}, {
   3.8024932608428707`*^9, 3.8024932700463867`*^9}, {3.8024934398920403`*^9, 
   3.802493446044735*^9}, {3.8024942848251266`*^9, 3.802494314050439*^9}, {
   3.802494438919032*^9, 3.802494482094445*^9}, {3.802494521167807*^9, 
   3.802494622879307*^9}, {3.8024947029356823`*^9, 3.8024947045079517`*^9}, {
   3.8024948778880243`*^9, 3.8024949673808527`*^9}, {3.802495014902197*^9, 
   3.8024951090656557`*^9}, {3.802495408312211*^9, 3.8024954085676947`*^9}, {
   3.802495442509974*^9, 3.802495454997752*^9}, {3.802495501214038*^9, 
   3.802495508546978*^9}, {3.8024957573117*^9, 3.802495760236515*^9}, {
   3.8024958681151953`*^9, 3.802495870565724*^9}, {3.8024959698493843`*^9, 
   3.802496000742865*^9}, {3.802550941063429*^9, 3.802550954381898*^9}, {
   3.802551231792245*^9, 3.802551340184362*^9}, 3.802551433930855*^9, {
   3.802552115771781*^9, 3.80255212513028*^9}, {3.802552384368813*^9, 
   3.8025523905531797`*^9}, {3.802552874425517*^9, 3.802552886281713*^9}, {
   3.802553087817971*^9, 3.802553229391675*^9}, {3.802553425598302*^9, 
   3.802553425813101*^9}, {3.8025535285342484`*^9, 3.802553577505382*^9}, {
   3.8025536301152563`*^9, 3.80255365366017*^9}, 3.802553699719733*^9, {
   3.8025706751317472`*^9, 3.802570896748526*^9}, {3.8025713048711367`*^9, 
   3.802571323843739*^9}, 3.8025716819240217`*^9, {3.8025722591012993`*^9, 
   3.802572286842257*^9}, {3.802573078274022*^9, 3.802573105520647*^9}, {
   3.8026414133106728`*^9, 3.8026414140048103`*^9}, {3.80264406032199*^9, 
   3.8026440850817337`*^9}, 
   3.8030823819578*^9},ExpressionUUID->"4ecacb49-dd94-4783-991a-c6d349b32928"],

Cell[BoxData[
 RowBox[{
  RowBox[{"biasphericAplanatSolveFiniteWithImageCoverGlass", "[", 
   RowBox[{"parameters", ":", 
    RowBox[{"{", "__Rule", "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "x1", ",", "x2", ",", "mr", ",", "na", ",", "n", ",", "d", ",", "m1", 
      ",", "m2", ",", "oi", ",", "beta", ",", "mc", ",", "dc", ",", "nc", ",",
       "shps", ",", "secpnts", ",", "ana"}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mr", ",", "na", ",", "n", ",", "d", ",", "m2"}], "}"}], "=", 
      RowBox[{"commonParameters", "[", "parameters", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"oi", "=", 
      RowBox[{"mechanicalObjectImageDistance", "/.", "parameters"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"m1", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"NumericQ", "[", "oi", "]"}], ",", 
        RowBox[{"oi", "-", "m2", "-", "d"}], ",", 
        RowBox[{"mechanicalObjectDistance", "/.", "parameters"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"beta", "=", 
      RowBox[{
       RowBox[{"-", "lateralMagnification"}], "/.", "parameters"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dc", "=", 
      RowBox[{"coverGlassThickness", "/.", "parameters"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mc", "=", 
      RowBox[{"coverGlassMediumSymbol", "/.", "parameters"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nc", "=", 
      RowBox[{"refractiveIndexValue", "[", 
       RowBox[{"mc", ",", 
        RowBox[{"designWavelength", "/.", "parameters"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1", ",", "x2"}], "}"}], "=", 
      RowBox[{"SolveFiniteWithCoverGlass", "[", 
       RowBox[{
        RowBox[{"mr", "*", "na", "*", "beta"}], ",", "n", ",", "d", ",", "m1",
         ",", "m2", ",", "beta", ",", "dc", ",", "nc", ",", 
        RowBox[{"filterNDSolveOptions", "[", "parameters", "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"secpnts", "=", 
      RowBox[{"interpolationSectionPoints", "[", "x1", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ana", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Last", "[", "secpnts", "]"}], "/", "mr"}], "/", "beta"}], "/.",
        "parameters"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"frontSurfaceShapeFunction", "->", 
         RowBox[{"Interpolation", "[", 
          RowBox[{"mirroredData", "[", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#", "*", 
                   RowBox[{"(", 
                    RowBox[{"m1", "+", 
                    RowBox[{"x1", "[", "#", "]"}]}], ")"}]}], ")"}], "/", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{"1", "-", 
                   RowBox[{"#", "^", "2"}]}], "]"}]}], ",", 
                RowBox[{"x1", "[", "#", "]"}]}], "}"}], "&"}], ",", 
             "secpnts"}], "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"backSurfaceShapeFunction", "->", 
         RowBox[{"Interpolation", "[", 
          RowBox[{"mirroredData", "[", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"#", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"dc", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"1", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"#", "^", "2"}]}], "+", 
                    RowBox[{"beta", "^", "2"}]}], "]"}]}], ")"}]}], "+", 
                    RowBox[{"1", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"#", "^", "2"}]}], "+", 
                    RowBox[{
                    RowBox[{"beta", "^", "2"}], "*", 
                    RowBox[{"nc", "^", "2"}]}]}], "]"}]}]}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"m2", "-", 
                    RowBox[{"x2", "[", "#", "]"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"#", "^", "2"}]}], "+", 
                    RowBox[{"beta", "^", "2"}]}], "]"}]}]}], ")"}]}], ",", 
                RowBox[{"d", "+", 
                 RowBox[{"x2", "[", "#", "]"}]}]}], "}"}], "&"}], ",", 
             "secpnts"}], "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"numericalAperture", "\[Rule]", "ana"}], ",", "parameters"}], 
       "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802473633660241*^9, 3.802473709956484*^9}, {
   3.8024738042004547`*^9, 3.8024738084541388`*^9}, {3.802474909542385*^9, 
   3.802474941514369*^9}, {3.802481258551177*^9, 3.802481286167738*^9}, 
   3.8024813210656776`*^9, {3.802481351247974*^9, 3.802481352756673*^9}, {
   3.8024814057794724`*^9, 3.8024814093120947`*^9}, {3.8024927928805656`*^9, 
   3.8024928013753157`*^9}, {3.802492849953521*^9, 3.8024928909614887`*^9}, {
   3.8024932608428707`*^9, 3.8024932700463867`*^9}, {3.8024934398920403`*^9, 
   3.802493446044735*^9}, {3.8024942848251266`*^9, 3.802494314050439*^9}, {
   3.802494438919032*^9, 3.802494482094445*^9}, {3.802494521167807*^9, 
   3.802494622879307*^9}, {3.8024947029356823`*^9, 3.8024947045079517`*^9}, {
   3.8024948778880243`*^9, 3.8024949673808527`*^9}, {3.802495014902197*^9, 
   3.8024951090656557`*^9}, {3.802495408312211*^9, 3.8024954085676947`*^9}, {
   3.802495442509974*^9, 3.802495454997752*^9}, {3.802495501214038*^9, 
   3.802495508546978*^9}, {3.8024957573117*^9, 3.802495760236515*^9}, {
   3.8024958681151953`*^9, 3.802495870565724*^9}, {3.8024959698493843`*^9, 
   3.802496000742865*^9}, {3.802550941063429*^9, 3.802550954381898*^9}, {
   3.802551231792245*^9, 3.802551340184362*^9}, 3.802551433930855*^9, {
   3.802552115771781*^9, 3.80255212513028*^9}, {3.802552384368813*^9, 
   3.8025523905531797`*^9}, {3.802552874425517*^9, 3.802552886281713*^9}, {
   3.802553087817971*^9, 3.802553229391675*^9}, {3.802553425598302*^9, 
   3.802553425813101*^9}, {3.8025535285342484`*^9, 3.802553577505382*^9}, {
   3.8025536301152563`*^9, 3.80255365366017*^9}, 3.802553699719733*^9, {
   3.8025706751317472`*^9, 3.802570896748526*^9}, {3.802641280903267*^9, 
   3.802641466791754*^9}, {3.802641615890975*^9, 3.8026417034527683`*^9}, {
   3.80264259438533*^9, 3.802642597467914*^9}, 3.8026426292039433`*^9, {
   3.8026440926317043`*^9, 3.8026440962539377`*^9}, 
   3.803082381960183*^9},ExpressionUUID->"09491eae-d6da-48e6-96c6-\
2520894e073f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"biasphericAplanatSolveFiniteWithObjectCoverGlass", "[", 
   RowBox[{"parameters", ":", 
    RowBox[{"{", "__Rule", "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "x1", ",", "x2", ",", "mr", ",", "na", ",", "n", ",", "d", ",", "m1", 
      ",", "m2", ",", "oi", ",", "beta", ",", "mc", ",", "dc", ",", "nc", ",",
       "shps", ",", "secpnts", ",", "ana"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mr", ",", "na", ",", "n", ",", "d", ",", "m2"}], "}"}], "=", 
      RowBox[{"commonParameters", "[", "parameters", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"oi", "=", 
      RowBox[{"mechanicalObjectImageDistance", "/.", "parameters"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"m1", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"NumericQ", "[", "oi", "]"}], ",", 
        RowBox[{"oi", "-", "m2", "-", "d"}], ",", 
        RowBox[{"mechanicalObjectDistance", "/.", "parameters"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"beta", "=", 
      RowBox[{
       RowBox[{"-", "lateralMagnification"}], "/.", "parameters"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dc", "=", 
      RowBox[{"objectSideCoverGlassThickness", "/.", "parameters"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mc", "=", 
      RowBox[{"objectSideCoverGlassMediumSymbol", "/.", "parameters"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"nc", "=", 
      RowBox[{"refractiveIndexValue", "[", 
       RowBox[{"mc", ",", 
        RowBox[{"designWavelength", "/.", "parameters"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1", ",", "x2"}], "}"}], "=", 
      RowBox[{"SolveFiniteWithObjectSpaceCoverGlass", "[", 
       RowBox[{
        RowBox[{"mr", "*", "na", "*", "beta"}], ",", "n", ",", "d", ",", "m1",
         ",", "m2", ",", "beta", ",", "dc", ",", "nc", ",", 
        RowBox[{"filterNDSolveOptions", "[", "parameters", "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"secpnts", "=", 
      RowBox[{"interpolationSectionPoints", "[", "x1", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ana", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Last", "[", "secpnts", "]"}], "/", "mr"}], "/", "beta"}], "/.",
        "parameters"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"frontSurfaceShapeFunction", "->", 
         RowBox[{"Interpolation", "[", 
          RowBox[{"mirroredData", "[", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"#", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"1", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"#", "^", "2"}]}], "]"}]}], ")"}]}], "+", 
                    RowBox[{"1", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"nc", "^", "2"}], "-", 
                    RowBox[{"#", "^", "2"}]}], "]"}]}]}], ")"}], "*", "dc"}], 
                   "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"m1", "+", 
                    RowBox[{"x1", "[", "#", "]"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"#", "^", "2"}]}], "]"}]}]}], ")"}]}], ",", 
                RowBox[{"x1", "[", "#", "]"}]}], "}"}], "&"}], ",", 
             "secpnts"}], "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"backSurfaceShapeFunction", "->", 
         RowBox[{"Interpolation", "[", 
          RowBox[{"mirroredData", "[", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#", "*", 
                   RowBox[{"(", 
                    RowBox[{"m2", "-", 
                    RowBox[{"x2", "[", "#", "]"}]}], ")"}]}], ")"}], "/", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{
                   RowBox[{"beta", "^", "2"}], "-", 
                   RowBox[{"#", "^", "2"}]}], "]"}]}], ",", 
                RowBox[{"d", "+", 
                 RowBox[{"x2", "[", "#", "]"}]}]}], "}"}], "&"}], ",", 
             "secpnts"}], "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"numericalAperture", "\[Rule]", "ana"}], ",", "parameters"}], 
       "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802641755348037*^9, 3.802641756439723*^9}, {
   3.802641816863825*^9, 3.8026418234907503`*^9}, {3.8026420829892*^9, 
   3.802642092481812*^9}, {3.8026421302610903`*^9, 3.802642142174259*^9}, {
   3.802642601653593*^9, 3.802642625424856*^9}, {3.802644103624955*^9, 
   3.8026441063344307`*^9}, {3.802729220708632*^9, 3.802729268171052*^9}, {
   3.802743594695499*^9, 3.802743633843041*^9}, {3.802743697755184*^9, 
   3.802743708004837*^9}, 
   3.803082381961537*^9},ExpressionUUID->"4f748ab2-3234-4f33-b00d-\
0a3560bfe68b"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "biasphericAplanatSolveFiniteWithBothImageAndObjectCoverGlass", "[", 
    RowBox[{"parameters", ":", 
     RowBox[{"{", "__Rule", "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "x1", ",", "x2", ",", "mr", ",", "na", ",", "n", ",", "d", ",", "m1", 
       ",", "m2", ",", "oi", ",", "beta", ",", "mc1", ",", "dc1", ",", "nc1", 
       ",", "mc2", ",", "nc2", ",", "dc2", ",", "shps", ",", "secpnts", ",", 
       "ana"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mr", ",", "na", ",", "n", ",", "d", ",", "m2"}], "}"}], "=", 
       
       RowBox[{"commonParameters", "[", "parameters", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"oi", "=", 
       RowBox[{"mechanicalObjectImageDistance", "/.", "parameters"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"m1", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"NumericQ", "[", "oi", "]"}], ",", 
         RowBox[{"oi", "-", "m2", "-", "d"}], ",", 
         RowBox[{"mechanicalObjectDistance", "/.", "parameters"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"beta", "=", 
       RowBox[{
        RowBox[{"-", "lateralMagnification"}], "/.", "parameters"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dc2", "=", 
       RowBox[{"coverGlassThickness", "/.", "parameters"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mc2", "=", 
       RowBox[{"coverGlassMediumSymbol", "/.", "parameters"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nc2", "=", 
       RowBox[{"refractiveIndexValue", "[", 
        RowBox[{"mc2", ",", 
         RowBox[{"designWavelength", "/.", "parameters"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dc1", "=", 
       RowBox[{"objectSideCoverGlassThickness", "/.", "parameters"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mc1", "=", 
       RowBox[{"objectSideCoverGlassMediumSymbol", "/.", "parameters"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"nc1", "=", 
       RowBox[{"refractiveIndexValue", "[", 
        RowBox[{"mc1", ",", 
         RowBox[{"designWavelength", "/.", "parameters"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1", ",", "x2"}], "}"}], "=", 
       RowBox[{"SolveFiniteWithBothSpaceCoverGlass", "[", 
        RowBox[{
         RowBox[{"mr", "*", "na", "*", "beta"}], ",", "n", ",", "d", ",", 
         "m1", ",", "m2", ",", "beta", ",", "dc1", ",", "nc1", ",", "dc2", 
         ",", "nc2", ",", 
         RowBox[{"filterNDSolveOptions", "[", "parameters", "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"secpnts", "=", 
       RowBox[{"interpolationSectionPoints", "[", "x1", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ana", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Last", "[", "secpnts", "]"}], "/", "mr"}], "/", "beta"}], "/.",
         "parameters"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"frontSurfaceShapeFunction", "->", 
          RowBox[{"Interpolation", "[", 
           RowBox[{"mirroredData", "[", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"dc1", "/", 
                    RowBox[{"(", 
                    RowBox[{"nc1", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"#", "^", "2"}], "/", 
                    RowBox[{"nc1", "^", "2"}]}]}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "dc1"}], "+", "m1"}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"#", "^", "2"}]}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"x1", "[", "#", "]"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"#", "^", "2"}]}], "]"}]}]}], ")"}]}], ",", 
                 RowBox[{"x1", "[", "#", "]"}]}], "}"}], "&"}], ",", 
              "secpnts"}], "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"backSurfaceShapeFunction", "->", 
          RowBox[{"Interpolation", "[", 
           RowBox[{"mirroredData", "[", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"dc2", "/", 
                    RowBox[{"(", 
                    RowBox[{"beta", "*", "nc2", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"#", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"beta", "^", "2"}], "*", 
                    RowBox[{"nc2", "^", "2"}]}], ")"}]}]}], "]"}]}], ")"}]}], 
                    "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "dc2"}], "+", "m2"}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"beta", "^", "2"}], "-", 
                    RowBox[{"#", "^", "2"}]}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"x2", "[", "#", "]"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"beta", "^", "2"}], "-", 
                    RowBox[{"#", "^", "2"}]}], "]"}]}]}], ")"}]}], ",", 
                 RowBox[{"d", "+", 
                  RowBox[{"x2", "[", "#", "]"}]}]}], "}"}], "&"}], ",", 
              "secpnts"}], "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"numericalAperture", "\[Rule]", "ana"}], ",", "parameters"}],
         "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802473633660241*^9, 3.802473709956484*^9}, {
   3.8024738042004547`*^9, 3.8024738084541388`*^9}, {3.802474909542385*^9, 
   3.802474941514369*^9}, {3.802481258551177*^9, 3.802481286167738*^9}, 
   3.8024813210656776`*^9, {3.802481351247974*^9, 3.802481352756673*^9}, {
   3.8024814057794724`*^9, 3.8024814093120947`*^9}, {3.8024927928805656`*^9, 
   3.8024928013753157`*^9}, {3.802492849953521*^9, 3.8024928909614887`*^9}, {
   3.8024932608428707`*^9, 3.8024932700463867`*^9}, {3.8024934398920403`*^9, 
   3.802493446044735*^9}, {3.8024942848251266`*^9, 3.802494314050439*^9}, {
   3.802494438919032*^9, 3.802494482094445*^9}, {3.802494521167807*^9, 
   3.802494622879307*^9}, {3.8024947029356823`*^9, 3.8024947045079517`*^9}, {
   3.8024948778880243`*^9, 3.8024949673808527`*^9}, {3.802495014902197*^9, 
   3.8024951090656557`*^9}, {3.802495408312211*^9, 3.8024954085676947`*^9}, {
   3.802495442509974*^9, 3.802495454997752*^9}, {3.802495501214038*^9, 
   3.802495508546978*^9}, {3.8024957573117*^9, 3.802495760236515*^9}, {
   3.8024958681151953`*^9, 3.802495870565724*^9}, {3.8024959698493843`*^9, 
   3.802496000742865*^9}, {3.802550941063429*^9, 3.802550954381898*^9}, {
   3.802551231792245*^9, 3.802551340184362*^9}, 3.802551433930855*^9, {
   3.802552115771781*^9, 3.80255212513028*^9}, {3.802552384368813*^9, 
   3.8025523905531797`*^9}, {3.802552874425517*^9, 3.802552886281713*^9}, {
   3.802553087817971*^9, 3.802553229391675*^9}, {3.802553425598302*^9, 
   3.802553425813101*^9}, {3.8025535285342484`*^9, 3.802553577505382*^9}, {
   3.8025536301152563`*^9, 3.80255365366017*^9}, 3.802553699719733*^9, {
   3.8025706751317472`*^9, 3.802570896748526*^9}, {3.802641280903267*^9, 
   3.802641466791754*^9}, {3.802642188681847*^9, 3.8026423399860153`*^9}, {
   3.802642517661323*^9, 3.802642568048218*^9}, {3.8026426072331953`*^9, 
   3.802642619010499*^9}, {3.802644120433662*^9, 3.802644122916834*^9}, {
   3.802647347293783*^9, 3.802647351445055*^9}, 
   3.8030823819639597`*^9},ExpressionUUID->"dacc8fa5-e511-4d0a-b462-\
2aa312800083"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SolveInfinite", "[", 
   RowBox[{"na_", ",", "n_", ",", "d_", ",", "m_", ",", "f_", ",", "opt___"}],
    "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fn", ",", "x1", ",", "x2", ",", "t", ",", "sols"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fn", "=", 
      RowBox[{"f", "*", "n"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sols", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"x1", "'"}], "[", "t", "]"}], "==", 
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"fn", "*", "t", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "m"}], "+", 
                   RowBox[{"f", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                   RowBox[{"x2", "[", "t", "]"}]}], ")"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Sqrt", "[", 
                  RowBox[{"1", "-", 
                   RowBox[{"t", "^", "2"}]}], "]"}], "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"d", "*", "n"}], ")"}]}], "+", 
                   RowBox[{"n", "*", 
                    RowBox[{"x1", "[", "t", "]"}]}], "-", 
                   RowBox[{"n", "*", 
                    RowBox[{"x2", "[", "t", "]"}]}], "+", 
                   RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "*", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "m"}], "+", 
                    RowBox[{"f", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "^", "2"}]}], 
                    ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"t", "^", "2"}]}], ")"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"d", "-", 
                    RowBox[{"x1", "[", "t", "]"}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "^", "2"}]}], 
                    "]"}]}], ")"}]}], ")"}]}], ")"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"x2", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"t", "*", 
               RowBox[{"(", 
                RowBox[{"m", "-", 
                 RowBox[{"x2", "[", "t", "]"}]}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"n", 
                  RowBox[{"(", 
                   RowBox[{"m", "-", 
                    RowBox[{"f", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "-", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}], "*", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "*", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "m"}], "+", 
                    RowBox[{"f", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "^", "2"}]}], 
                    ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"t", "^", "2"}]}], ")"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"d", "-", 
                    RowBox[{"x1", "[", "t", "]"}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "^", "2"}]}], 
                   "]"}]}]}], ")"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"t", "^", "2"}]}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"n", "*", 
                  RowBox[{"(", 
                   RowBox[{"d", "-", 
                    RowBox[{"d", "*", 
                    RowBox[{"t", "^", "2"}]}], "-", 
                    RowBox[{"m", "*", 
                    RowBox[{"t", "^", "2"}]}], "+", 
                    RowBox[{"f", "*", 
                    RowBox[{"t", "^", "2"}], "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"t", "^", "2"}]}], ")"}], "*", 
                    RowBox[{"x1", "[", "t", "]"}]}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}]}], "-", 
                 RowBox[{
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}], "*", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "*", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "m"}], "+", 
                    RowBox[{"f", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "^", "2"}]}], 
                    ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"t", "^", "2"}]}], ")"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"d", "-", 
                    RowBox[{"x1", "[", "t", "]"}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "^", "2"}]}], 
                   "]"}]}]}], ")"}]}], ")"}]}]}], ",", 
           RowBox[{
            RowBox[{"x1", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{"x2", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x1", ",", "x2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "na"}], "}"}], ",", "opt"}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "/.", "sols"}], ",", 
       RowBox[{"x2", "/.", "sols"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802492923023226*^9, 3.802493022520153*^9}, {
   3.802493053661192*^9, 3.802493079288872*^9}, {3.80249316963913*^9, 
   3.802493233168931*^9}, {3.8024932812861137`*^9, 3.8024933128980303`*^9}, {
   3.802493466984057*^9, 3.8024934725738773`*^9}, {3.8024935600018167`*^9, 
   3.802493569920363*^9}, 3.8024940714765167`*^9, {3.802494167597471*^9, 
   3.802494179545762*^9}, {3.802494228855542*^9, 3.802494346070163*^9}, {
   3.802552188728506*^9, 3.802552201091013*^9}, {3.802553025044333*^9, 
   3.8025530278110867`*^9}, {3.824776012323435*^9, 3.824776061132947*^9}, 
   3.8247761654826117`*^9},ExpressionUUID->"cbb13df1-f95c-4f5b-ae20-\
c7d99140eda5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SolveInfiniteWithCoverGlass", "[", 
   RowBox[{
   "na_", ",", "n_", ",", "d_", ",", "m_", ",", "f_", ",", "dc_", ",", "nc_", 
    ",", "opt___"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x1", ",", "x2", ",", "t", ",", "sols"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sols", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"x1", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"f", "*", "n", "*", "t", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "f"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"m", "-", "dc"}], ")"}], "/", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                 RowBox[{"dc", "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"nc", "^", "2"}]}]}], "]"}], "*", "nc"}], ")"}]}],
                  "-", 
                 RowBox[{
                  RowBox[{"x2", "[", "t", "]"}], "/", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}]}], ")"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{"n", "*", 
                  RowBox[{"(", 
                   RowBox[{"d", "-", 
                    RowBox[{"x1", "[", "t", "]"}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}]}], ")"}]}], "+", 
               RowBox[{"Sqrt", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"d", "-", 
                    RowBox[{"x1", "[", "t", "]"}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "^", "2"}], "+", 
                 RowBox[{
                  RowBox[{"t", "^", "2"}], "*", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"f", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "m"}], "+", "dc"}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "-", 
                    RowBox[{"dc", "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"nc", "^", "2"}]}]}], "]"}], "*", "nc"}], ")"}]}],
                     "+", 
                    RowBox[{
                    RowBox[{"x2", "[", "t", "]"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}]}], ")"}], "^", 
                   "2"}]}]}], "]"}]}], ")"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"x2", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"t", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"m", "-", "dc"}], ")"}], "/", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"3", "/", "2"}], ")"}]}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "*", "dc"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"nc", "^", "2"}]}]}], ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"3", "/", "2"}], ")"}]}], "*", 
                    RowBox[{"nc", "^", "3"}]}], ")"}]}], "+", 
                   RowBox[{"dc", "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"nc", "^", "2"}]}]}], "]"}], "*", "nc"}], ")"}]}],
                    "-", 
                   RowBox[{
                    RowBox[{"x2", "[", "t", "]"}], "/", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"3", "/", "2"}], ")"}]}]}]}], ")"}], "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"f", "*", "n"}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "m"}], "+", "dc"}], ")"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "*", "dc"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"nc", "^", "2"}]}]}], "]"}], "*", "nc"}], ")"}]}],
                    "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "*", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "-", 
                   RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"d", "-", 
                    RowBox[{"x1", "[", "t", "]"}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "*", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"f", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "m"}], "+", "dc"}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "-", 
                    RowBox[{"dc", "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"nc", "^", "2"}]}]}], "]"}], "*", "nc"}], ")"}]}],
                     "+", 
                    RowBox[{
                    RowBox[{"x2", "[", "t", "]"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}]}], ")"}], "^", 
                    "2"}]}]}], "]"}]}], ")"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{"n", "*", 
                    RowBox[{"(", 
                    RowBox[{"d", "-", 
                    RowBox[{"x1", "[", "t", "]"}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"n", "*", 
                    RowBox[{"t", "^", "2"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "f"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"m", "-", "dc"}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                    RowBox[{"dc", "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"nc", "^", "2"}]}]}], "]"}], "*", "nc"}], ")"}]}],
                     "-", 
                    RowBox[{
                    RowBox[{"x2", "[", "t", "]"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}]}], ")"}]}], ")"}], "/", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"Sqrt", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"d", "-", 
                    RowBox[{"x1", "[", "t", "]"}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "*", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"f", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "m"}], "+", "dc"}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "-", 
                    RowBox[{"dc", "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"nc", "^", "2"}]}]}], "]"}], "*", "nc"}], ")"}]}],
                     "+", 
                    RowBox[{
                    RowBox[{"x2", "[", "t", "]"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}]}], ")"}], "^", 
                    "2"}]}]}], "]"}], "/", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}]}], ")"}]}], ")"}]}]}], 
           ",", 
           RowBox[{
            RowBox[{"x1", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{"x2", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x1", ",", "x2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "na"}], "}"}], ",", "opt"}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "/.", "sols"}], ",", 
       RowBox[{"x2", "/.", "sols"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802492923023226*^9, 3.802493022520153*^9}, {
   3.802493053661192*^9, 3.802493079288872*^9}, {3.80249316963913*^9, 
   3.802493233168931*^9}, {3.8024932812861137`*^9, 3.8024933128980303`*^9}, {
   3.802493466984057*^9, 3.8024934725738773`*^9}, {3.8024935600018167`*^9, 
   3.802493569920363*^9}, 3.8024940714765167`*^9, {3.802494167597471*^9, 
   3.802494179545762*^9}, {3.802494228855542*^9, 3.802494346070163*^9}, {
   3.802552188728506*^9, 3.802552201091013*^9}, {3.802553025044333*^9, 
   3.8025530582516117`*^9}},
 CellLabel->
  "In[417]:=",ExpressionUUID->"53533be8-f38c-49f5-a959-d26a2c240e99"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SolveFinite", "[", 
   RowBox[{
   "na_", ",", "n_", ",", "d_", ",", "m1_", ",", "m2_", ",", "beta_", ",", 
    "opt___"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x1", ",", "x2", ",", "t", ",", "sols"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sols", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"x1", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"m1", "+", 
                   RowBox[{"x1", "[", "t", "]"}]}], ")"}], "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"n", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "m1"}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "m2"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x1", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}]}], ")"}]}], ")"}]}], "+", 
                   RowBox[{"t", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"d", "-", 
                    RowBox[{"x1", "[", "t", "]"}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "m1"}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "m2"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x1", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}]}], ")"}], "^", "2"}]}], "]"}]}]}], ")"}]}], ")"}],
                "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], ")"}], "^", 
                  RowBox[{"(", 
                   RowBox[{"3", "/", "2"}], ")"}]}], "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"n", "*", 
                    RowBox[{"(", 
                    RowBox[{"d", "-", 
                    RowBox[{"x1", "[", "t", "]"}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}]}], ")"}]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "*", "t", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "m1"}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "m2"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x1", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}]}], ")"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"d", "-", 
                    RowBox[{"x1", "[", "t", "]"}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "m1"}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "m2"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x1", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}]}], ")"}], "^", "2"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}]}], ")"}]}], ")"}]}], 
              ")"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"x2", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"beta", "^", "2"}], "*", 
                 RowBox[{"(", 
                  RowBox[{"m2", "-", 
                   RowBox[{"x2", "[", "t", "]"}]}], ")"}], "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"n", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "m1"}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "m2"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x1", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}]}], ")"}]}], ")"}]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"d", "-", 
                    RowBox[{"x1", "[", "t", "]"}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "m1"}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "m2"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x1", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}]}], ")"}], "^", "2"}]}], "]"}]}], ")"}], "/", 
                    "beta"}]}], ")"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"t", "^", "2"}]}], "+", 
                    RowBox[{"beta", "^", "2"}]}], ")"}], "^", 
                  RowBox[{"(", 
                   RowBox[{"3", "/", "2"}], ")"}]}], "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"n", "*", 
                    RowBox[{"(", 
                    RowBox[{"d", "-", 
                    RowBox[{"x1", "[", "t", "]"}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}]}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "*", 
                    RowBox[{"t", "^", "2"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta", "*", 
                    "m1"}], "-", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}], "*", "m2"}], "+", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta", "*", 
                    RowBox[{"x1", "[", "t", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}], "*", 
                    RowBox[{"x2", "[", "t", "]"}]}]}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "-", 
                    RowBox[{"beta", "^", "2"}]}], ")"}]}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"d", "-", 
                    RowBox[{"x1", "[", "t", "]"}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "m1"}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "m2"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x1", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}]}], ")"}], "^", "2"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}]}]}], ")"}]}], 
                ")"}]}], ")"}]}]}], ",", 
           RowBox[{
            RowBox[{"x1", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{"x2", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x1", ",", "x2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "na"}], "}"}], ",", "opt"}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "/.", "sols"}], ",", 
       RowBox[{"x2", "/.", "sols"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.80257054464987*^9, 3.802570565294935*^9}, {
  3.802570623268918*^9, 3.802570637162609*^9}, {3.802571052605739*^9, 
  3.802571084665509*^9}, {3.8025728668109503`*^9, 3.802572869446506*^9}},
 CellLabel->
  "In[418]:=",ExpressionUUID->"30cac84d-a09c-4724-9d2f-9238a32d51a4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SolveFiniteWithCoverGlass", "[", 
   RowBox[{
   "na_", ",", "n_", ",", "d_", ",", "m1_", ",", "m2_", ",", "beta_", ",", 
    "dc_", ",", "nc_", ",", "opt___"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x1", ",", "x2", ",", "t", ",", "sols"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sols", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"x1", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"m1", "+", 
                   RowBox[{"x1", "[", "t", "]"}]}], ")"}], "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "*", "t", "*", "m1"}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "*", "t", "*", 
                    RowBox[{"(", 
                    RowBox[{"dc", "-", "m2"}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "*", "t", "*", "dc"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"beta", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"beta", "^", "2"}], "*", 
                    RowBox[{"nc", "^", "2"}]}], ")"}]}]}], "]"}], "*", "nc"}],
                     ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "*", "t", "*", 
                    RowBox[{"x1", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "*", "t", "*", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}], "+", 
                   RowBox[{"t", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"d", "-", 
                    RowBox[{"x1", "[", "t", "]"}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "m1"}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"(", 
                    RowBox[{"dc", "-", "m2"}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "dc"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"beta", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"beta", "^", "2"}], "*", 
                    RowBox[{"nc", "^", "2"}]}], ")"}]}]}], "]"}], "*", "nc"}],
                     ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x1", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}]}], ")"}], "^", "2"}]}], "]"}]}]}], ")"}]}], ")"}],
                "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], ")"}], "^", 
                  RowBox[{"(", 
                   RowBox[{"3", "/", "2"}], ")"}]}], "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"n", "*", 
                    RowBox[{"(", 
                    RowBox[{"d", "-", 
                    RowBox[{"x1", "[", "t", "]"}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}]}], ")"}]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "*", "t", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "m1"}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "dc"}], "+", "m2"}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "dc"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"beta", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"beta", "^", "2"}], "*", 
                    RowBox[{"nc", "^", "2"}]}], ")"}]}]}], "]"}], "*", "nc"}],
                     ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x1", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}]}], ")"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"d", "-", 
                    RowBox[{"x1", "[", "t", "]"}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "m1"}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"(", 
                    RowBox[{"dc", "-", "m2"}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "dc"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"beta", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"beta", "^", "2"}], "*", 
                    RowBox[{"nc", "^", "2"}]}], ")"}]}]}], "]"}], "*", "nc"}],
                     ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x1", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}]}], ")"}], "^", "2"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}]}], ")"}]}], ")"}]}], 
              ")"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"x2", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"beta", "^", "2"}], "*", 
                 RowBox[{"(", 
                  RowBox[{"m2", "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"dc", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"t", "^", "4"}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"t", "^", "2"}], "*", 
                    RowBox[{"beta", "^", "2"}], "*", 
                    RowBox[{"nc", "^", "2"}]}], "+", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", 
                    RowBox[{"beta", "^", "2"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "-", 
                    RowBox[{"beta", "^", "2"}]}], ")"}], "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"beta", "^", "2"}], "*", 
                    RowBox[{"nc", "^", "2"}]}], ")"}]}]}], "]"}], "*", 
                    RowBox[{"nc", "^", "3"}]}], "+", 
                    RowBox[{
                    RowBox[{"beta", "^", "4"}], "*", 
                    RowBox[{"nc", "^", "4"}]}]}], ")"}]}], ")"}], "/", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"beta", "^", "2"}], "*", 
                    RowBox[{"nc", "^", "2"}]}]}], ")"}], "^", "2"}]}], "-", 
                   RowBox[{"x2", "[", "t", "]"}]}], ")"}], "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "*", "t", "*", "m1"}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "*", "t", "*", 
                    RowBox[{"(", 
                    RowBox[{"dc", "-", "m2"}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "*", "t", "*", "dc"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"beta", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"beta", "^", "2"}], "*", 
                    RowBox[{"nc", "^", "2"}]}], ")"}]}]}], "]"}], "*", "nc"}],
                     ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "*", "t", "*", 
                    RowBox[{"x1", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "*", "t", "*", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"d", "-", 
                    RowBox[{"x1", "[", "t", "]"}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "m1"}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"(", 
                    RowBox[{"dc", "-", "m2"}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "dc"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"beta", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"beta", "^", "2"}], "*", 
                    RowBox[{"nc", "^", "2"}]}], ")"}]}]}], "]"}], "*", "nc"}],
                     ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x1", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}]}], ")"}], "^", "2"}]}], "]"}]}], ")"}], "/", 
                    "beta"}]}], ")"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"t", "^", "2"}]}], "+", 
                    RowBox[{"beta", "^", "2"}]}], ")"}], "^", 
                  RowBox[{"(", 
                   RowBox[{"3", "/", "2"}], ")"}]}], "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"n", "*", 
                    RowBox[{"(", 
                    RowBox[{"d", "-", 
                    RowBox[{"x1", "[", "t", "]"}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}]}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "*", "t", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "m1"}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "dc"}], "+", "m2"}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "dc"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"beta", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"beta", "^", "2"}], "*", 
                    RowBox[{"nc", "^", "2"}]}], ")"}]}]}], "]"}], "*", "nc"}],
                     ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x1", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}]}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"d", "-", 
                    RowBox[{"x1", "[", "t", "]"}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "m1"}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"(", 
                    RowBox[{"dc", "-", "m2"}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "dc"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"beta", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"beta", "^", "2"}], "*", 
                    RowBox[{"nc", "^", "2"}]}], ")"}]}]}], "]"}], "*", "nc"}],
                     ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x1", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}]}], ")"}], "^", "2"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}]}]}], ")"}]}], 
                ")"}]}], ")"}]}]}], ",", 
           RowBox[{
            RowBox[{"x1", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{"x2", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x1", ",", "x2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "na"}], "}"}], ",", "opt"}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "/.", "sols"}], ",", 
       RowBox[{"x2", "/.", "sols"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802640462701559*^9, 3.80264054786607*^9}, {
   3.8026407537273073`*^9, 3.802640757067181*^9}, 3.8026409594563932`*^9},
 CellLabel->
  "In[419]:=",ExpressionUUID->"77b9237a-cb3a-4c09-8197-510e54cf2ee4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SolveFiniteWithObjectSpaceCoverGlass", "[", 
   RowBox[{
   "na_", ",", "n_", ",", "d_", ",", "m1_", ",", "m2_", ",", "beta_", ",", 
    "dc_", ",", "nc_", ",", "opt___"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x1", ",", "x2", ",", "t", ",", "sols"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sols", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"x1", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "dc"}], "+", "m1"}], ")"}], "/", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"3", "/", "2"}], ")"}]}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"dc", "*", 
                    RowBox[{"t", "^", "2"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"nc", "^", "3"}], "*", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"nc", "^", "2"}]}]}], ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"3", "/", "2"}], ")"}]}]}], ")"}]}], "+", 
                   RowBox[{"dc", "/", 
                    RowBox[{"(", 
                    RowBox[{"nc", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"nc", "^", "2"}]}]}], "]"}]}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"x1", "[", "t", "]"}], "/", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"3", "/", "2"}], ")"}]}]}]}], ")"}], "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "dc"}], "+", "m1"}], ")"}], "*", "n", "*", 
                    "t"}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"m2", "*", "n", "*", "t"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"beta", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}]}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"dc", "*", "n", "*", "t"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"nc", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"nc", "^", "2"}]}]}], "]"}]}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "*", "t", "*", 
                    RowBox[{"x1", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "*", "t", "*", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"beta", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}]}], ")"}]}], "+", 
                   RowBox[{"t", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"d", "-", 
                    RowBox[{"x1", "[", "t", "]"}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "dc"}], "+", "m1"}], ")"}], "*", "t"}], 
                    ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"m2", "*", "t"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"beta", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"dc", "*", "t"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"nc", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"nc", "^", "2"}]}]}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x1", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"beta", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}]}], ")"}]}]}], ")"}],
                     "^", "2"}]}], "]"}]}]}], ")"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{"n", "*", 
                    RowBox[{"(", 
                    RowBox[{"d", "-", 
                    RowBox[{"x1", "[", "t", "]"}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}]}], ")"}]}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"n", "*", "t", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"dc", "-", "m1"}], ")"}], "*", "t"}], ")"}], "/", 
                    
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"m2", "*", "t"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"beta", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"dc", "*", "t"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"nc", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"nc", "^", "2"}]}]}], "]"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x1", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"beta", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}]}], ")"}]}]}], 
                    ")"}]}], ")"}], "/", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"Sqrt", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"d", "-", 
                    RowBox[{"x1", "[", "t", "]"}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "dc"}], "+", "m1"}], ")"}], "*", "t"}], 
                    ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"m2", "*", "t"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"beta", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"dc", "*", "t"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"nc", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"nc", "^", "2"}]}]}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x1", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"beta", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}]}], ")"}]}]}], ")"}],
                     "^", "2"}]}], "]"}], "/", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}]}], ")"}]}], ")"}]}]}], 
           ",", 
           RowBox[{
            RowBox[{
             RowBox[{"x2", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"beta", "^", "2"}], "*", 
                 RowBox[{"(", 
                  RowBox[{"m2", "-", 
                   RowBox[{"x2", "[", "t", "]"}]}], ")"}], "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "dc"}], "+", "m1"}], ")"}], "*", "n", "*", 
                    "t"}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"m2", "*", "n", "*", "t"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"beta", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}]}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"dc", "*", "n", "*", "t"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"nc", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"nc", "^", "2"}]}]}], "]"}]}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "*", "t", "*", 
                    RowBox[{"x1", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "*", "t", "*", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"beta", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}]}], ")"}]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"d", "-", 
                    RowBox[{"x1", "[", "t", "]"}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "dc"}], "+", "m1"}], ")"}], "*", "t"}], 
                    ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"m2", "*", "t"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"beta", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"dc", "*", "t"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"nc", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"nc", "^", "2"}]}]}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x1", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"beta", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}]}], ")"}]}]}], ")"}],
                     "^", "2"}]}], "]"}]}], ")"}], "/", "beta"}]}], ")"}]}], 
                ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"beta", "^", "2"}], "-", 
                    RowBox[{"t", "^", "2"}]}], ")"}], "^", 
                  RowBox[{"(", 
                   RowBox[{"3", "/", "2"}], ")"}]}], "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"n", "*", 
                    RowBox[{"(", 
                    RowBox[{"d", "-", 
                    RowBox[{"x1", "[", "t", "]"}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}]}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "*", "t", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"dc", "-", "m1"}], ")"}], "*", "t"}], ")"}], "/", 
                    
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"m2", "*", "t"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"beta", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"dc", "*", "t"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"nc", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"nc", "^", "2"}]}]}], "]"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x1", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"beta", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}]}], ")"}]}]}], 
                    ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"beta", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}]}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"d", "-", 
                    RowBox[{"x1", "[", "t", "]"}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "dc"}], "+", "m1"}], ")"}], "*", "t"}], 
                    ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"m2", "*", "t"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"beta", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"dc", "*", "t"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"nc", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"nc", "^", "2"}]}]}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x1", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"beta", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}]}], ")"}]}]}], ")"}],
                     "^", "2"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}]}]}], ")"}]}], 
                ")"}]}], ")"}]}]}], ",", 
           RowBox[{
            RowBox[{"x1", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{"x2", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x1", ",", "x2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "na"}], "}"}], ",", "opt"}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "/.", "sols"}], ",", 
       RowBox[{"x2", "/.", "sols"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802640783084406*^9, 3.8026407958575773`*^9}, {
  3.802640946452146*^9, 3.80264095468612*^9}, {3.8026410235825357`*^9, 
  3.802641030367177*^9}, {3.802728898634603*^9, 
  3.8027288999114237`*^9}},ExpressionUUID->"e8673842-d67a-4158-9fcc-\
c4fe75be4400"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SolveFiniteWithBothSpaceCoverGlass", "[", 
   RowBox[{
   "na_", ",", "n_", ",", "d_", ",", "m1_", ",", "m2_", ",", "beta_", ",", 
    "dc1_", ",", "nc1_", ",", "dc2_", ",", "nc2_", ",", "opt___"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x1", ",", "x2", ",", "t", ",", "sols"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sols", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"x1", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "dc1"}], "+", "m1"}], ")"}], "/", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"3", "/", "2"}], ")"}]}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "*", "dc1"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"nc1", "^", "2"}]}]}], ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"3", "/", "2"}], ")"}]}], "*", 
                    RowBox[{"nc1", "^", "3"}]}], ")"}]}], "+", 
                   RowBox[{"dc1", "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"nc1", "^", "2"}]}]}], "]"}], "*", "nc1"}], 
                    ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"x1", "[", "t", "]"}], "/", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"3", "/", "2"}], ")"}]}]}]}], ")"}], "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "*", "t", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "dc1"}], "+", "m1"}], ")"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "*", "t", "*", 
                    RowBox[{"(", 
                    RowBox[{"dc2", "-", "m2"}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "*", "t", "*", "dc1"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"nc1", "^", "2"}]}]}], "]"}], "*", "nc1"}], 
                    ")"}]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "*", "t", "*", "dc2"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"beta", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"beta", "^", "2"}], "*", 
                    RowBox[{"nc2", "^", "2"}]}], ")"}]}]}], "]"}], "*", 
                    "nc2"}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "*", "t", "*", 
                    RowBox[{"x1", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "*", "t", "*", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}], "+", 
                   RowBox[{"t", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"d", "-", 
                    RowBox[{"x1", "[", "t", "]"}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"(", 
                    RowBox[{"dc1", "-", "m1"}], ")"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "dc2"}], "+", "m2"}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "dc1"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"nc1", "^", "2"}]}]}], "]"}], "*", "nc1"}], 
                    ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "dc2"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"beta", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"beta", "^", "2"}], "*", 
                    RowBox[{"nc2", "^", "2"}]}], ")"}]}]}], "]"}], "*", 
                    "nc2"}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x1", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}]}], ")"}], "^", "2"}]}], "]"}]}]}], ")"}]}], ")"}],
                "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{"n", "*", 
                    RowBox[{"(", 
                    RowBox[{"d", "-", 
                    RowBox[{"x1", "[", "t", "]"}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}]}], ")"}]}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"n", "*", "t", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"(", 
                    RowBox[{"dc1", "-", "m1"}], ")"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "dc2"}], "+", "m2"}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "dc1"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"nc1", "^", "2"}]}]}], "]"}], "*", "nc1"}], 
                    ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "dc2"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"beta", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"beta", "^", "2"}], "*", 
                    RowBox[{"nc2", "^", "2"}]}], ")"}]}]}], "]"}], "*", 
                    "nc2"}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x1", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}]}], ")"}]}], ")"}], "/", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"Sqrt", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"d", "-", 
                    RowBox[{"x1", "[", "t", "]"}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"(", 
                    RowBox[{"dc1", "-", "m1"}], ")"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "dc2"}], "+", "m2"}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "dc1"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"nc1", "^", "2"}]}]}], "]"}], "*", "nc1"}], 
                    ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "dc2"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"beta", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"beta", "^", "2"}], "*", 
                    RowBox[{"nc2", "^", "2"}]}], ")"}]}]}], "]"}], "*", 
                    "nc2"}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x1", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}]}], ")"}], "^", "2"}]}], "]"}], "/", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}]}], ")"}]}], ")"}]}]}], 
           ",", 
           RowBox[{
            RowBox[{
             RowBox[{"x2", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"beta", "^", "2"}], "*", 
                 RowBox[{"(", 
                  RowBox[{"m2", "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"dc2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"t", "^", "4"}], "-", 
                    RowBox[{"2", "*", 
                    RowBox[{"t", "^", "2"}], "*", 
                    RowBox[{"beta", "^", "2"}], "*", 
                    RowBox[{"nc2", "^", "2"}]}], "+", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", 
                    RowBox[{"beta", "^", "2"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "-", 
                    RowBox[{"beta", "^", "2"}]}], ")"}], "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"beta", "^", "2"}], "*", 
                    RowBox[{"nc2", "^", "2"}]}], ")"}]}]}], "]"}], "*", 
                    RowBox[{"nc2", "^", "3"}]}], "+", 
                    RowBox[{
                    RowBox[{"beta", "^", "4"}], "*", 
                    RowBox[{"nc2", "^", "4"}]}]}], ")"}]}], ")"}], "/", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "-", 
                    RowBox[{
                    RowBox[{"beta", "^", "2"}], "*", 
                    RowBox[{"nc2", "^", "2"}]}]}], ")"}], "^", "2"}]}], "-", 
                   RowBox[{"x2", "[", "t", "]"}]}], ")"}], "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "*", "t", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "dc1"}], "+", "m1"}], ")"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "*", "t", "*", 
                    RowBox[{"(", 
                    RowBox[{"dc2", "-", "m2"}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "*", "t", "*", "dc1"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"nc1", "^", "2"}]}]}], "]"}], "*", "nc1"}], 
                    ")"}]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "*", "t", "*", "dc2"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"beta", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"beta", "^", "2"}], "*", 
                    RowBox[{"nc2", "^", "2"}]}], ")"}]}]}], "]"}], "*", 
                    "nc2"}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "*", "t", "*", 
                    RowBox[{"x1", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "*", "t", "*", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"d", "-", 
                    RowBox[{"x1", "[", "t", "]"}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"(", 
                    RowBox[{"dc1", "-", "m1"}], ")"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "dc2"}], "+", "m2"}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "dc1"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"nc1", "^", "2"}]}]}], "]"}], "*", "nc1"}], 
                    ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "dc2"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"beta", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"beta", "^", "2"}], "*", 
                    RowBox[{"nc2", "^", "2"}]}], ")"}]}]}], "]"}], "*", 
                    "nc2"}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x1", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}]}], ")"}], "^", "2"}]}], "]"}]}], ")"}], "/", 
                    "beta"}]}], ")"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"t", "^", "2"}]}], "+", 
                    RowBox[{"beta", "^", "2"}]}], ")"}], "^", 
                  RowBox[{"(", 
                   RowBox[{"3", "/", "2"}], ")"}]}], "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"n", "*", 
                    RowBox[{"(", 
                    RowBox[{"d", "-", 
                    RowBox[{"x1", "[", "t", "]"}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}]}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "*", "t", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"(", 
                    RowBox[{"dc1", "-", "m1"}], ")"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "dc2"}], "+", "m2"}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "dc1"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"nc1", "^", "2"}]}]}], "]"}], "*", "nc1"}], 
                    ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "dc2"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"beta", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"beta", "^", "2"}], "*", 
                    RowBox[{"nc2", "^", "2"}]}], ")"}]}]}], "]"}], "*", 
                    "nc2"}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x1", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}]}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"d", "-", 
                    RowBox[{"x1", "[", "t", "]"}], "+", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"(", 
                    RowBox[{"dc1", "-", "m1"}], ")"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "dc2"}], "+", "m2"}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "dc1"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"nc1", "^", "2"}]}]}], "]"}], "*", "nc1"}], 
                    ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", "dc2"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"beta", "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"beta", "^", "2"}], "*", 
                    RowBox[{"nc2", "^", "2"}]}], ")"}]}]}], "]"}], "*", 
                    "nc2"}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x1", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"t", "^", "2"}]}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "*", 
                    RowBox[{"x2", "[", "t", "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}], "*", "beta"}], 
                    ")"}]}]}], ")"}], "^", "2"}]}], "]"}], "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"t", "^", "2"}], "/", 
                    RowBox[{"beta", "^", "2"}]}]}], "]"}]}]}], ")"}]}], 
                ")"}]}], ")"}]}]}], ",", 
           RowBox[{
            RowBox[{"x1", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{"x2", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x1", ",", "x2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "na"}], "}"}], ",", "opt"}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "/.", "sols"}], ",", 
       RowBox[{"x2", "/.", "sols"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802640974686212*^9, 3.802641013041882*^9}, {
  3.8026412216190767`*^9, 3.802641236334867*^9}},
 CellLabel->
  "In[421]:=",ExpressionUUID->"2d563416-c8a3-47b9-95dc-30f9da048c35"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mirroredData", "[", 
   RowBox[{"l", ":", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"_", ",", "_"}], "}"}], "..."}], "}"}]}], "]"}], ":=", 
  RowBox[{"Union", "[", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], ",", "l"}], "]"}],
       ",", "l"}], "]"}], ",", 
    RowBox[{"SameTest", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"#1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", 
          RowBox[{"#2", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "<", 
        RowBox[{"10", "^", 
         RowBox[{"-", "10"}]}]}], "&"}], ")"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[422]:=",ExpressionUUID->"9c81b136-b67f-4932-b6e1-338afe13a5d0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "setOpticsFor2DRayTrace", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"tracingWavelength", "\[Rule]", "designWavelength"}], ",", 
     RowBox[{"decenterBetweenAspherics", "\[Rule]", "0"}]}], "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8026483102397203`*^9, 3.802648324303053*^9}},
 CellLabel->
  "In[423]:=",ExpressionUUID->"6a85e04c-e947-4c8e-9efd-3eba66b74176"],

Cell[BoxData[
 RowBox[{
  RowBox[{"setOpticsFor2DRayTrace", "[", 
   RowBox[{"op_Symbol", ",", 
    RowBox[{"solverResult", ":", 
     RowBox[{"{", "__Rule", "}"}]}], ",", "opt___Rule"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"conjugateInfiniteness", "/.", "solverResult"}], ",", 
    RowBox[{"setOpticsFor2DRayTraceInfinite", "[", 
     RowBox[{"op", ",", "solverResult", ",", "opt"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"setOpticsFor2DRayTraceFinite", "[", 
     RowBox[{"op", ",", "solverResult", ",", "opt"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802648336272037*^9, 3.802648457099598*^9}},
 CellLabel->
  "In[424]:=",ExpressionUUID->"62d2bee8-7ac3-4eaa-8f09-f294ed9b65ac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"setOpticsFor2DRayTraceInfinite", "[", 
   RowBox[{"op_Symbol", ",", 
    RowBox[{"solverResult", ":", 
     RowBox[{"{", "__Rule", "}"}]}], ",", "opt___Rule"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "wl", ",", "s1", ",", "pup", ",", "s2", ",", "img", ",", "ref", ",", 
      "cgi", ",", "cgo", ",", "bod", ",", "ncg", ",", "dec", ",", "mrg"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"wl", "=", 
      RowBox[{
       RowBox[{"tracingWavelength", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"tracingWavelength", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"designWavelength", "/.", "solverResult"}], ")"}]}], 
        "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dec", "=", 
      RowBox[{
       RowBox[{"decenterBetweenAspherics", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"Options", "[", "setOpticsFor2DRayTrace", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"createSurface", "[", 
      RowBox[{"s1", ",", 
       RowBox[{"parametricShape", "[", 
        RowBox[{"frontSurfaceShapeFunction", "/.", "solverResult"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"attachAttributeToSurface", "[", 
      RowBox[{
      "s1", ",", "solverAsphericalSurface", ",", 
       "frontSolverAsphericalSurface"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"createSurface", "[", 
      RowBox[{"pup", ",", 
       RowBox[{"planeShape", "[", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"marginalPositionOfSurface", "[", "s1", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"createSurface", "[", 
      RowBox[{"s2", ",", 
       RowBox[{"parametricShape", "[", 
        RowBox[{"backSurfaceShapeFunction", "/.", "solverResult"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"dec", ",", "0"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"attachAttributeToSurface", "[", 
      RowBox[{
      "s2", ",", "solverAsphericalSurface", ",", 
       "backSolverAsphericalSurface"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"createSurface", "[", 
      RowBox[{"img", ",", 
       RowBox[{"planeShape", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "2"}], ",", "2"}], "}"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"lensMediumThickness", "+", "mechanicalImageDistance"}], "/.",
           "solverResult"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"createSurface", "[", 
      RowBox[{"ref", ",", 
       RowBox[{"sphericalShape", "[", 
        RowBox[{
         RowBox[{"1", "/", "focalLength"}], "/.", "solverResult"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{
          "lensMediumThickness", "+", "mechanicalImageDistance", "-", 
           "focalLength"}], "/.", "solverResult"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bod", "=", 
      RowBox[{"lensMediumSymbol", "/.", "solverResult"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", "op", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"coverGlassExistence", "/.", "solverResult"}], ",", 
       RowBox[{
        RowBox[{"createSurface", "[", 
         RowBox[{"cgi", ",", 
          RowBox[{"planeShape", "[", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"lensMediumThickness", "+", 
               RowBox[{"mechanicalImageDistance", "/", "2"}], "-", 
               RowBox[{"coverGlassThickness", "/", "2"}]}], ")"}], "/.", 
             "solverResult"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"createSurface", "[", 
         RowBox[{"cgo", ",", 
          RowBox[{"planeShape", "[", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"lensMediumThickness", "+", 
               RowBox[{"mechanicalImageDistance", "/", "2"}], "+", 
               RowBox[{"coverGlassThickness", "/", "2"}]}], ")"}], "/.", 
             "solverResult"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"ncg", "=", 
         RowBox[{"coverGlassMediumSymbol", "/.", "solverResult"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"createOptics", "[", 
         RowBox[{"op", ",", 
          RowBox[{"{", 
           RowBox[{
           "atmosphere", ",", "s1", ",", "bod", ",", "pup", ",", "bod", ",", 
            "s2", ",", "atmosphere", ",", "cgi", ",", "ncg", ",", "cgo", ",", 
            "atmosphere", ",", "img", ",", "atmosphere", ",", "ref", ",", 
            "atmosphere"}], "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"createOptics", "[", 
        RowBox[{"op", ",", 
         RowBox[{"{", 
          RowBox[{
          "atmosphere", ",", "s1", ",", "bod", ",", "pup", ",", "bod", ",", 
           "s2", ",", "atmosphere", ",", "img", ",", "atmosphere", ",", "ref",
            ",", "atmosphere"}], "}"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mrg", "=", 
      RowBox[{
       RowBox[{"numericalAperture", "*", "focalLength"}], "/.", 
       "solverResult"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"traceRay", "[", "op", "]"}], "[", 
      RowBox[{
       RowBox[{"markRayAsDomainDefinedMarginal", "[", 
        RowBox[{"raySet", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"mrg", ",", 
            RowBox[{"-", "0.3"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "]"}], ",", "wl"}], "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"setPupil", "[", 
      RowBox[{"op", ",", "pup"}], "]"}], ";", "\[IndentingNewLine]", "op"}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.802560836795944*^9, {3.8025609162665997`*^9, 3.8025609459205017`*^9}, {
   3.8025609945883293`*^9, 3.80256101390462*^9}, {3.8025610583553257`*^9, 
   3.802561061212162*^9}, 3.802561103086725*^9, 3.8025611351500053`*^9, {
   3.8025612883240223`*^9, 3.8025612984229507`*^9}, 3.802561486472291*^9, {
   3.802561670778687*^9, 3.802561674956798*^9}, {3.802647950180484*^9, 
   3.80264795196666*^9}, {3.802648461824551*^9, 3.80264850918898*^9}, {
   3.8026492562156363`*^9, 3.802649258451746*^9}, {3.802649445149558*^9, 
   3.8026494461281233`*^9}, {3.802657790399048*^9, 3.802657790948554*^9}, {
   3.8026584338981953`*^9, 3.8026584516187077`*^9}, {3.802658482230357*^9, 
   3.802658522641061*^9}, {3.802658572073309*^9, 3.802658580580208*^9}, 
   3.8026591646980057`*^9, {3.80273586017523*^9, 3.802735860387867*^9}, {
   3.802736077303792*^9, 3.80273608912811*^9}, {3.8027361868564777`*^9, 
   3.8027361912913437`*^9}, 
   3.803082381965807*^9},ExpressionUUID->"6281a8c2-8df3-4c7b-b4bd-\
d7623e0d7e45"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"setOpticsFor2DRayTraceFinite", "[", 
   RowBox[{"op_Symbol", ",", 
    RowBox[{"solverResult", ":", 
     RowBox[{"{", "__Rule", "}"}]}], ",", "opt___Rule"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "wl", ",", "s1", ",", "pup", ",", "s2", ",", "img", ",", "ref", ",", 
      "cg1i", ",", "cg1o", ",", "cg2i", ",", "cg2o", ",", "bod", ",", "ncg1", 
      ",", "ncg2", ",", "do", ",", "oplis", ",", "dec", ",", "mrg"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"wl", "=", 
      RowBox[{
       RowBox[{"tracingWavelength", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"tracingWavelength", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"designWavelength", "/.", "solverResult"}], ")"}]}], 
        "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dec", "=", 
      RowBox[{
       RowBox[{"decenterBetweenAspherics", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"Options", "[", "setOpticsFor2DRayTrace", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"oplis", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"objectSideCoverGlassExistence", "/.", "solverResult"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"createSurface", "[", 
          RowBox[{"cg1i", ",", 
           RowBox[{"planeShape", "[", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "mechanicalObjectDistance"}], "/", "2"}], "-", 
                RowBox[{"objectSideCoverGlassThickness", "/", "2"}]}], ")"}], 
              "/.", "solverResult"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"createSurface", "[", 
          RowBox[{"cg1o", ",", 
           RowBox[{"planeShape", "[", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "mechanicalObjectDistance"}], "/", "2"}], "+", 
                RowBox[{"objectSideCoverGlassThickness", "/", "2"}]}], ")"}], 
              "/.", "solverResult"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ncg1", "=", 
          RowBox[{
          "objectSideCoverGlassMediumSymbol", "/.", "solverResult"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
          "atmosphere", ",", "cg1i", ",", "ncg1", ",", "cg1o", ",", 
           "atmosphere"}], "}"}]}], ",", 
        RowBox[{"{", "atmosphere", "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"createSurface", "[", 
      RowBox[{"s1", ",", 
       RowBox[{"parametricShape", "[", 
        RowBox[{"frontSurfaceShapeFunction", "/.", "solverResult"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"attachAttributeToSurface", "[", 
      RowBox[{
      "s1", ",", "solverAsphericalSurface", ",", 
       "frontSolverAsphericalSurface"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"createSurface", "[", 
      RowBox[{"pup", ",", 
       RowBox[{"planeShape", "[", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"marginalPositionOfSurface", "[", "s1", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"createSurface", "[", 
      RowBox[{"s2", ",", 
       RowBox[{"parametricShape", "[", 
        RowBox[{"backSurfaceShapeFunction", "/.", "solverResult"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"dec", ",", "0"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"attachAttributeToSurface", "[", 
      RowBox[{
      "s2", ",", "solverAsphericalSurface", ",", 
       "backSolverAsphericalSurface"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"createSurface", "[", 
      RowBox[{"img", ",", 
       RowBox[{"planeShape", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "2"}], ",", "2"}], "}"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"lensMediumThickness", "+", "mechanicalImageDistance"}], "/.",
           "solverResult"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"createSurface", "[", 
      RowBox[{"ref", ",", 
       RowBox[{"sphericalShape", "[", 
        RowBox[{
         RowBox[{"1", "/", "focalLength"}], "/.", "solverResult"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{
          "lensMediumThickness", "+", "mechanicalImageDistance", "-", 
           "focalLength"}], "/.", "solverResult"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bod", "=", 
      RowBox[{"lensMediumSymbol", "/.", "solverResult"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"oplis", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{
        "oplis", ",", "s1", ",", "bod", ",", "pup", ",", "bod", ",", "s2", 
         ",", "atmosphere"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"coverGlassExistence", "/.", "solverResult"}], ",", 
       RowBox[{
        RowBox[{"createSurface", "[", 
         RowBox[{"cg2i", ",", 
          RowBox[{"planeShape", "[", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"lensMediumThickness", "+", 
               RowBox[{"mechanicalImageDistance", "/", "2"}], "-", 
               RowBox[{"coverGlassThickness", "/", "2"}]}], ")"}], "/.", 
             "solverResult"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"createSurface", "[", 
         RowBox[{"cg2o", ",", 
          RowBox[{"planeShape", "[", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"lensMediumThickness", "+", 
               RowBox[{"mechanicalImageDistance", "/", "2"}], "+", 
               RowBox[{"coverGlassThickness", "/", "2"}]}], ")"}], "/.", 
             "solverResult"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"ncg2", "=", 
         RowBox[{"coverGlassMediumSymbol", "/.", "solverResult"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"oplis", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{
           "oplis", ",", "cg2i", ",", "ncg2", ",", "cg2o", ",", 
            "atmosphere"}], "}"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"createSurface", "[", 
      RowBox[{"img", ",", 
       RowBox[{"planeShape", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "2"}], ",", "2"}], "}"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"lensMediumThickness", "+", "mechanicalImageDistance"}], "/.",
           "solverResult"}]}], "}"}]}], "]"}], ";", 
     RowBox[{"oplis", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{
        "oplis", ",", "img", ",", "atmosphere", ",", "ref", ",", 
         "atmosphere"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", "op", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"createOptics", "[", 
      RowBox[{"op", ",", "oplis"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"mrg", "=", 
      RowBox[{"ArcSin", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "numericalAperture"}], "*", "lateralMagnification"}], "/.",
         "solverResult"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"do", "=", 
      RowBox[{"mechanicalObjectDistance", "/.", "solverResult"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"traceRay", "[", "op", "]"}], "[", 
      RowBox[{
       RowBox[{"markRayAsDomainDefinedMarginal", "[", 
        RowBox[{"raySet", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "do"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Sin", "[", "mrg", "]"}], ",", 
            RowBox[{"Cos", "[", "mrg", "]"}]}], "}"}]}], "]"}], "]"}], ",", 
       "wl"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"setPupil", "[", 
      RowBox[{"op", ",", "pup"}], "]"}], ";", "\[IndentingNewLine]", "op"}]}],
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"frontAsphericalSurfacePosition", "[", 
    RowBox[{"op_", "?", "opticsQ"}], "]"}], ":=", 
   RowBox[{"positionOfAttributedSurface", "[", 
    RowBox[{
    "op", ",", "solverAsphericalSurface", ",", 
     "frontSolverAsphericalSurface"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"backAsphericalSurfacePosition", "[", 
    RowBox[{"op_", "?", "opticsQ"}], "]"}], ":=", 
   RowBox[{"positionOfAttributedSurface", "[", 
    RowBox[{
    "op", ",", "solverAsphericalSurface", ",", 
     "backSolverAsphericalSurface"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8025732793907127`*^9, 3.802573281753797*^9}, {
   3.8025733439674177`*^9, 3.802573422504634*^9}, {3.802577386451874*^9, 
   3.802577424712134*^9}, {3.802644234765541*^9, 3.8026442390858393`*^9}, {
   3.802646444872563*^9, 3.802646977566687*^9}, {3.8026470753879538`*^9, 
   3.802647087874679*^9}, {3.802647429094676*^9, 3.802647429238945*^9}, 
   3.80264846616967*^9, {3.802648516669373*^9, 3.802648532363287*^9}, {
   3.802649262402165*^9, 3.802649265010326*^9}, {3.8026494534842567`*^9, 
   3.80264945437272*^9}, {3.802658532732291*^9, 3.802658564458713*^9}, {
   3.802659147994339*^9, 3.802659155362913*^9}, {3.8027362012632732`*^9, 
   3.8027362116408663`*^9}, {3.8027362453261538`*^9, 3.802736313725919*^9}, 
   3.803082381967602*^9},ExpressionUUID->"808816cb-7619-4b09-bebd-\
53cd3f2d9cf4"],

Cell[CellGroupData[{

Cell["messages", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.8023992766159*^9, 
  3.8023992819014263`*^9}},ExpressionUUID->"907889f9-868e-4852-9b69-\
dd85d2d12726"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"biasphericAplanatSolve", "::", "usesetup"}], "=", 
   "\"\<use 'setupBiasphericAplanatParameters' function to set parameter \
arguments.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"setupBiasphericAplanatParameters", "::", "needslambda"}], "=", 
   "\"\<design wavelength should be specified by 'designWavelength->x' with \
unit in milli meters.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"setupBiasphericAplanatParameters", "::", "notmedium"}], "=", 
   "\"\<`1` symbol for `2` is not a medium symbol.\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802399286816321*^9, 3.802399287189041*^9}, {
  3.802399358514987*^9, 3.802399369405016*^9}, {3.802399724853754*^9, 
  3.802399763836274*^9}, {3.8024717442728643`*^9, 3.802471801083934*^9}},
 CellLabel->
  "In[427]:=",ExpressionUUID->"a4999d4c-6706-40ec-bfca-fcc36820dbd1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["End of this package", "Section",
 AutoGeneratedPackage->Automatic,
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.797739167479363*^9, 
  3.7977391750151367`*^9}},ExpressionUUID->"6eee3bb1-f758-4993-bcb7-\
d9269738b74a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]}], "Input",
 AutoGeneratedPackage->Automatic,
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.797739178210627*^9, 
  3.797739185814768*^9}},ExpressionUUID->"f275cb89-6114-40ce-8d49-\
f93fef53863e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Demonstrations", "Title",
 CellChangeTimes->{{3.802407658960683*^9, 3.802407662760621*^9}, {
  3.802744601028328*^9, 
  3.8027446048387957`*^9}},ExpressionUUID->"372e56f2-6c59-4e9c-8798-\
e5ebdeed3a2e"],

Cell[BoxData[{
 RowBox[{"<<", "\"\<AplanaticSinglet`BiasphericAplanatSolver`\>\""}], "\n", 
 RowBox[{"<<", "\"\<AplanaticSinglet`RayTrace2D`\>\""}], "\n", 
 RowBox[{"<<", "\"\<AplanaticSinglet`GoldenSectionSearch`\>\""}], "\n", 
 RowBox[{"<<", 
  "\"\<AplanaticSinglet`AsphericalFittingForInterpolated`\>\""}], "\n", 
 RowBox[{"<<", 
  "\"\<AplanaticSinglet`BiasphericAplanatZemaxOutput`\>\""}], "\n", 
 RowBox[{
  RowBox[{"createMediumsFromAGFFile", "[", 
   RowBox[{"FindFile", "[", "\"\<AplanaticSinglet/SCHOTT.AGF\>\"", "]"}], 
   "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"bk7", "=", 
   RowBox[{"mediumCatalog", "[", "\"\<N-BK7\>\"", "]"}]}], 
  ";"}], "\n", "biasphericAplanatParameterSymbols"}], "Input",
 CellChangeTimes->{{3.802464929122532*^9, 3.8024649311330643`*^9}, {
   3.802649328809033*^9, 3.8026493302723227`*^9}, {3.802745370652904*^9, 
   3.80274537403329*^9}, {3.818461718118906*^9, 3.818461723528449*^9}, 
   3.818463011001348*^9},ExpressionUUID->"00b1e10c-b6b0-4e6f-8355-\
4da313b9effa"],

Cell[CellGroupData[{

Cell["infinite conjugate", "Section",
 CellChangeTimes->{{3.802726488369731*^9, 3.802726493043899*^9}, {
  3.8027303712708397`*^9, 
  3.802730374044735*^9}},ExpressionUUID->"daf9c55f-c473-4236-8a4c-\
13c22df2f12e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"parms", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"designWavelength", "\[Rule]", "0.00064"}], ",", 
     RowBox[{"numericalApertureTarget", "\[Rule]", "0.6"}], ",", 
     RowBox[{"lensMediumSymbol", "\[Rule]", "bk7"}], ",", 
     RowBox[{"lensMediumThickness", "\[Rule]", "2."}], ",", 
     RowBox[{"mechanicalImageDistance", "\[Rule]", "1.8"}], ",", 
     RowBox[{"focalLength", "\[Rule]", "3."}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.802662809297719*^9, 3.8026628237883787`*^9}, {
   3.802662938653576*^9, 3.8026630029373913`*^9}, {3.802663048826034*^9, 
   3.8026631065942993`*^9}, {3.802726531896865*^9, 3.802726571644683*^9}, {
   3.802734227454708*^9, 3.802734269865632*^9}, 
   3.803082449734329*^9},ExpressionUUID->"bc4fe511-d964-4ccf-98e8-\
57814c699eb1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bp", "=", 
   RowBox[{"setupBiasphericAplanatParameters", "[", "parms", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8024028961038303`*^9, 3.802402971693659*^9}, {
   3.8024030312855597`*^9, 3.802403048666213*^9}, {3.802403110363926*^9, 
   3.802403119948415*^9}, {3.802465506409964*^9, 3.802465540148797*^9}, {
   3.802466298570651*^9, 3.802466302538443*^9}, {3.8024663438519173`*^9, 
   3.802466345189536*^9}, {3.802469005541379*^9, 3.802469007754079*^9}, 
   3.8024690440383463`*^9, {3.8024690791970377`*^9, 3.802469082704455*^9}, 
   3.802469116172703*^9, {3.802469193574894*^9, 3.802469217414486*^9}, {
   3.80247258188396*^9, 3.802472601480641*^9}, {3.8024726504627666`*^9, 
   3.8024726521261873`*^9}, {3.8024933566973667`*^9, 3.802493370432547*^9}, 
   3.802562666872698*^9},
 CellLabel->
  "In[262]:=",ExpressionUUID->"e77dd041-d1ce-497b-a5ba-44810c05f8a6"],

Cell[BoxData[
 RowBox[{"result", "=", 
  RowBox[{"biasphericAplanatSolve", "[", "bp", "]"}]}]], "Input",
 CellChangeTimes->{{3.8024749562335863`*^9, 3.802474960303338*^9}, {
   3.802474993030712*^9, 3.802474993929435*^9}, {3.802475389959963*^9, 
   3.802475397844284*^9}, {3.8024933743601637`*^9, 3.80249337451613*^9}, {
   3.8024947693573847`*^9, 3.8024947699633617`*^9}, {3.802552464987968*^9, 
   3.802552472195608*^9}, {3.8025525088174963`*^9, 3.802552508881857*^9}, {
   3.802552550455061*^9, 3.802552566900506*^9}, {3.802552615502922*^9, 
   3.8025526462031593`*^9}, {3.802561550687337*^9, 3.80256155301455*^9}, 
   3.802561631604712*^9, {3.802561779984407*^9, 3.80256179723851*^9}, 
   3.802562648368477*^9, {3.802568391248456*^9, 3.8025683957930403`*^9}, {
   3.802568429196652*^9, 3.802568465577532*^9}, {3.802568526556056*^9, 
   3.802568539233897*^9}, {3.8025685756736526`*^9, 3.8025685926369743`*^9}, 
   3.8027265044257603`*^9},
 CellLabel->
  "In[263]:=",ExpressionUUID->"2c67d04a-364a-4780-9e6c-c2f30482c9e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"setOpticsFor2DRayTrace", "[", 
   RowBox[{"op", ",", "result"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.802561036890874*^9, 3.802561046338497*^9}, 
   3.802561557729261*^9, 3.8025616835473013`*^9, 3.802573430110076*^9, {
   3.802649209827622*^9, 3.802649222956531*^9}, {3.8026500110689297`*^9, 
   3.802650012540464*^9}, {3.802650074733077*^9, 3.802650078296258*^9}, 
   3.8030048906681147`*^9},
 CellLabel->
  "In[265]:=",ExpressionUUID->"9203869c-ce1e-4d7a-9a37-4bc549836dfd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rs", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"traceRay", "[", "op", "]"}], "[", 
       RowBox[{"#", ",", 
        RowBox[{"designWavelength", "/.", "result"}]}], "]"}], "&"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"raySet", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"h", ",", 
           RowBox[{"-", "0.3"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"h", ",", 
           RowBox[{
            RowBox[{"-", "numericalAperture"}], "*", "focalLength"}], ",", 
           RowBox[{"numericalAperture", "*", "focalLength"}], ",", 
           RowBox[{"numericalAperture", "*", 
            RowBox[{"focalLength", "/", "128"}]}]}], "}"}], "/.", "result"}], 
        "]"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8025613511725063`*^9, 3.802561376767507*^9}, {
  3.8025615006244287`*^9, 3.802561502568904*^9}, {3.802561561238893*^9, 
  3.802561562621828*^9}, {3.80257353427649*^9, 3.802573592383542*^9}, {
  3.802573635616823*^9, 3.802573678410727*^9}, {3.802642753509259*^9, 
  3.802642769122691*^9}, {3.8026441571651506`*^9, 3.802644188222295*^9}, {
  3.8026442727818832`*^9, 3.802644351642558*^9}, {3.802647494210556*^9, 
  3.802647512556836*^9}, {3.80266211436497*^9, 3.802662115218219*^9}, {
  3.802662897150975*^9, 3.802662920291087*^9}, {3.803082464472941*^9, 
  3.803082464474284*^9}},ExpressionUUID->"37e1f7a2-5c8f-4778-be81-\
d6a89ecaf316"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"rayCongruenceGraphics", "[", 
    RowBox[{"rs", ",", 
     RowBox[{"removeLast", "\[Rule]", "True"}], ",", 
     RowBox[{"rayCount", "\[Rule]", "16"}]}], "]"}], ",", 
   RowBox[{"opticsGraphics", "[", 
    RowBox[{"op", ",", 
     RowBox[{"showUselessSurface", "\[Rule]", "False"}]}], "]"}], ",", 
   RowBox[{"Axes", "\[Rule]", "True"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQzfOLLeV8yBtHjYRjqSBahfN6DoiWq7TOA9GfJGxr
QbSPfz2YfqZwJuwKiB/WEwGi7Wq5Eq8C6YB8BzCdMf/GVBCtxTt5OohuOWKn
9h1Ir/u0CUzv//TS/SeQZs9p9ADRfc/WhIFolS2/wbRAx8xMEH2v5wKYznvt
IvgfSO/5tAJMV827oAei9VZtNgTRO/PLbEH0pNbTjiCaYaZKCIiuO70QTB9J
2L+IIfSNo83us2DasCubjxFIe1WtA9NNDSclQfSZy9fB9AJHxRQQfcQoHEx7
n2LnVwDS7AmSYHqtr8af5UD6VoQZmAYAgJKiCQ==
  "],
 CellLabel->
  "In[267]:=",ExpressionUUID->"d32b4f2d-8fc1-4ee8-af2e-cdcf01aa3d34"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"o", "=", 
     RowBox[{
      RowBox[{"lensMediumThickness", "+", "mechanicalImageDistance"}], "/.", 
      "result"}]}], "}"}], ",", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#", "-", 
          RowBox[{"{", 
           RowBox[{"o", ",", "0"}], "}"}]}], ")"}], "&"}], ",", 
       RowBox[{"longitudinalSphericalAberration", "[", 
        RowBox[{"rs", ",", "op"}], "]"}]}], "]"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "Automatic"}]}], "]"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.802661477613614*^9, 3.802661481944735*^9}, {
  3.802661581700254*^9, 3.802661588956521*^9}, {3.8026616380631227`*^9, 
  3.8026616413023033`*^9}, {3.802661675618143*^9, 3.802661730485537*^9}, {
  3.8026631693166037`*^9, 3.802663187101768*^9}, {3.80266431749046*^9, 
  3.8026643394363613`*^9}, {3.803004910062228*^9, 3.8030049147983427`*^9}},
 CellLabel->
  "In[269]:=",ExpressionUUID->"3040eaf2-b4eb-4d74-9240-2b0087f800b1"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"f", "=", 
     RowBox[{"focalLength", "/.", "result"}]}], "}"}], ",", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"oscValueReversed", "[", 
           RowBox[{"#", ",", "f"}], "]"}], "&"}], ",", "rs"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "\[GreaterEqual]", "0"}], 
        "&"}]}], "]"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "Automatic"}]}], "]"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.802663720553502*^9, 3.802663831985589*^9}, {
  3.802663917849958*^9, 3.802663991410904*^9}, {3.802664034006493*^9, 
  3.802664048890761*^9}, {3.8026643620489264`*^9, 3.802664365062904*^9}, {
  3.802664440544999*^9, 3.802664440676655*^9}, {3.802726592918989*^9, 
  3.802726622358799*^9}, {3.803004920141593*^9, 3.803004933867437*^9}},
 CellLabel->
  "In[270]:=",ExpressionUUID->"0a366386-67cd-45b4-a819-155f6dc71233"],

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"opticalPathDifference", "[", 
    RowBox[{"rs", ",", "op"}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.802661856643248*^9, 3.802661862380897*^9}, {
  3.802661965141198*^9, 3.8026619701804333`*^9}, {3.8026631478395433`*^9, 
  3.802663150257286*^9}},
 CellLabel->
  "In[271]:=",ExpressionUUID->"d9691390-26a5-4f9a-8a8a-736417941f74"],

Cell[BoxData[
 RowBox[{
  RowBox[{"decoptim", "[", "mid_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"parms", ",", "bp", ",", "result", ",", "op", ",", "rs"}], "}"}],
     ",", 
    RowBox[{
     RowBox[{"parms", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"designWavelength", "\[Rule]", "0.00064"}], ",", 
        RowBox[{"numericalApertureTarget", "\[Rule]", "0.6"}], ",", 
        RowBox[{"lensMediumSymbol", "\[Rule]", "bk7"}], ",", 
        RowBox[{"lensMediumThickness", "\[Rule]", "2."}], ",", 
        RowBox[{"mechanicalImageDistance", "\[Rule]", "mid"}], ",", 
        RowBox[{"focalLength", "\[Rule]", "3."}]}], "}"}]}], ";", "\n", 
     RowBox[{"bp", "=", 
      RowBox[{"setupBiasphericAplanatParameters", "[", "parms", "]"}]}], ";", 
     "\n", 
     RowBox[{"result", "=", 
      RowBox[{"biasphericAplanatSolve", "[", "bp", "]"}]}], ";", "\n", 
     RowBox[{"setOpticsFor2DRayTrace", "[", 
      RowBox[{"op", ",", "result", ",", 
       RowBox[{"decenterBetweenAspherics", "\[Rule]", "0.005"}]}], "]"}], ";",
      "\n", 
     RowBox[{"rs", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"traceRay", "[", "op", "]"}], "[", 
          RowBox[{"#", ",", 
           RowBox[{"designWavelength", "/.", "result"}]}], "]"}], "&"}], ",", 
        
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"raySet", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"h", ",", 
              RowBox[{"-", "0.3"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"h", ",", 
              RowBox[{
               RowBox[{"-", "numericalAperture"}], "*", "focalLength"}], ",", 
              
              RowBox[{"numericalAperture", "*", "focalLength"}], ",", 
              RowBox[{"numericalAperture", "*", 
               RowBox[{"focalLength", "/", "128"}]}]}], "}"}], "/.", 
            "result"}], "]"}]}], "]"}]}], "]"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"RootMeanSquare", "[", 
       RowBox[{"Map", "[", 
        RowBox[{"Last", ",", 
         RowBox[{"opticalPathDifference", "[", 
          RowBox[{"rs", ",", "op"}], "]"}]}], "]"}], "]"}], "/", 
      RowBox[{"(", 
       RowBox[{"designWavelength", "/.", "result"}], ")"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.802662809297719*^9, 3.8026628237883787`*^9}, {
  3.802662938653576*^9, 3.8026630029373913`*^9}, {3.802663048826034*^9, 
  3.8026631065942993`*^9}, {3.802726531896865*^9, 3.802726571644683*^9}, {
  3.802730619683182*^9, 3.802730731080948*^9}, {3.803082448531658*^9, 
  3.8030824636299562`*^9}},ExpressionUUID->"dc865e29-f46a-429b-9bb8-\
4f49c5df6174"],

Cell[BoxData[
 RowBox[{"decoptim", "[", "1.86", "]"}]], "Input",
 CellChangeTimes->{{3.802730747089591*^9, 3.802730765541275*^9}, {
  3.802730800460602*^9, 3.802730800685161*^9}, {3.8027308780654507`*^9, 
  3.802730879031207*^9}},
 CellLabel->
  "In[273]:=",ExpressionUUID->"7e05a895-f404-4f8f-b181-1bcbbab3fcb6"],

Cell[BoxData[
 RowBox[{"decresult", "=", 
  RowBox[{"goldenSectionSearch", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"decoptim", "[", "#", "]"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"1.8", ",", "1.9"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8027307062719183`*^9, 3.802730735952194*^9}, {
  3.802730890305677*^9, 3.8027308909229517`*^9}, {3.802730937320157*^9, 
  3.80273094589118*^9}},
 CellLabel->
  "In[274]:=",ExpressionUUID->"877a4e4a-a293-41c8-85bf-e0825e212f0f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"parms", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"designWavelength", "\[Rule]", "0.00064"}], ",", 
     RowBox[{"numericalApertureTarget", "\[Rule]", "0.6"}], ",", 
     RowBox[{"lensMediumSymbol", "\[Rule]", "bk7"}], ",", 
     RowBox[{"lensMediumThickness", "\[Rule]", "2."}], ",", 
     RowBox[{"mechanicalImageDistance", "\[Rule]", 
      RowBox[{"decresult", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     RowBox[{"focalLength", "\[Rule]", "3."}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.802662809297719*^9, 3.8026628237883787`*^9}, {
   3.802662938653576*^9, 3.8026630029373913`*^9}, {3.802663048826034*^9, 
   3.8026631065942993`*^9}, {3.802726531896865*^9, 3.802726571644683*^9}, {
   3.802730953755083*^9, 3.80273095489041*^9}, 
   3.8030824485346813`*^9},ExpressionUUID->"eb57b8f8-9b44-4784-9043-\
3a4a996709d6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bp", "=", 
   RowBox[{"setupBiasphericAplanatParameters", "[", "parms", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8024028961038303`*^9, 3.802402971693659*^9}, {
   3.8024030312855597`*^9, 3.802403048666213*^9}, {3.802403110363926*^9, 
   3.802403119948415*^9}, {3.802465506409964*^9, 3.802465540148797*^9}, {
   3.802466298570651*^9, 3.802466302538443*^9}, {3.8024663438519173`*^9, 
   3.802466345189536*^9}, {3.802469005541379*^9, 3.802469007754079*^9}, 
   3.8024690440383463`*^9, {3.8024690791970377`*^9, 3.802469082704455*^9}, 
   3.802469116172703*^9, {3.802469193574894*^9, 3.802469217414486*^9}, {
   3.80247258188396*^9, 3.802472601480641*^9}, {3.8024726504627666`*^9, 
   3.8024726521261873`*^9}, {3.8024933566973667`*^9, 3.802493370432547*^9}, 
   3.802562666872698*^9},
 CellLabel->
  "In[276]:=",ExpressionUUID->"44fc1428-07bf-4318-8c76-63c46a6ceede"],

Cell[BoxData[
 RowBox[{"result", "=", 
  RowBox[{"biasphericAplanatSolve", "[", "bp", "]"}]}]], "Input",
 CellChangeTimes->{{3.8024749562335863`*^9, 3.802474960303338*^9}, {
   3.802474993030712*^9, 3.802474993929435*^9}, {3.802475389959963*^9, 
   3.802475397844284*^9}, {3.8024933743601637`*^9, 3.80249337451613*^9}, {
   3.8024947693573847`*^9, 3.8024947699633617`*^9}, {3.802552464987968*^9, 
   3.802552472195608*^9}, {3.8025525088174963`*^9, 3.802552508881857*^9}, {
   3.802552550455061*^9, 3.802552566900506*^9}, {3.802552615502922*^9, 
   3.8025526462031593`*^9}, {3.802561550687337*^9, 3.80256155301455*^9}, 
   3.802561631604712*^9, {3.802561779984407*^9, 3.80256179723851*^9}, 
   3.802562648368477*^9, {3.802568391248456*^9, 3.8025683957930403`*^9}, {
   3.802568429196652*^9, 3.802568465577532*^9}, {3.802568526556056*^9, 
   3.802568539233897*^9}, {3.8025685756736526`*^9, 3.8025685926369743`*^9}, 
   3.8027265044257603`*^9},
 CellLabel->
  "In[277]:=",ExpressionUUID->"315b8443-4a40-48c5-8d89-e5c5099b3095"],

Cell[BoxData[
 RowBox[{
  RowBox[{"setOpticsFor2DRayTrace", "[", 
   RowBox[{"op", ",", "result"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.802561036890874*^9, 3.802561046338497*^9}, 
   3.802561557729261*^9, 3.8025616835473013`*^9, 3.802573430110076*^9, {
   3.802649209827622*^9, 3.802649222956531*^9}, {3.8026500110689297`*^9, 
   3.802650012540464*^9}, {3.802650074733077*^9, 3.802650078296258*^9}, 
   3.802734331776071*^9},
 CellLabel->
  "In[278]:=",ExpressionUUID->"5ff77b97-06b1-45a9-82a5-ff86594b0278"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rs", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"traceRay", "[", "op", "]"}], "[", 
       RowBox[{"#", ",", 
        RowBox[{"designWavelength", "/.", "result"}]}], "]"}], "&"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"raySet", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"h", ",", 
           RowBox[{"-", "0.3"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"h", ",", 
           RowBox[{
            RowBox[{"-", "numericalAperture"}], "*", "focalLength"}], ",", 
           RowBox[{"numericalAperture", "*", "focalLength"}], ",", 
           RowBox[{"numericalAperture", "*", 
            RowBox[{"focalLength", "/", "128"}]}]}], "}"}], "/.", "result"}], 
        "]"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8025613511725063`*^9, 3.802561376767507*^9}, {
  3.8025615006244287`*^9, 3.802561502568904*^9}, {3.802561561238893*^9, 
  3.802561562621828*^9}, {3.80257353427649*^9, 3.802573592383542*^9}, {
  3.802573635616823*^9, 3.802573678410727*^9}, {3.802642753509259*^9, 
  3.802642769122691*^9}, {3.8026441571651506`*^9, 3.802644188222295*^9}, {
  3.8026442727818832`*^9, 3.802644351642558*^9}, {3.802647494210556*^9, 
  3.802647512556836*^9}, {3.80266211436497*^9, 3.802662115218219*^9}, {
  3.802662897150975*^9, 3.802662920291087*^9}, {3.8030824636321774`*^9, 
  3.803082463633432*^9}},ExpressionUUID->"5c33d8e6-4d6e-4e67-a6b6-\
5ded7783c2c2"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"rayCongruenceGraphics", "[", 
    RowBox[{"rs", ",", 
     RowBox[{"removeLast", "\[Rule]", "True"}], ",", 
     RowBox[{"rayCount", "\[Rule]", "20"}]}], "]"}], ",", 
   RowBox[{"opticsGraphics", "[", 
    RowBox[{"op", ",", 
     RowBox[{"showUselessSurface", "\[Rule]", "False"}]}], "]"}], ",", 
   RowBox[{"Axes", "\[Rule]", "True"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQzfOLLeV8yBtHjYRjqSBahfN6DoiWq7TOA9GfJGxr
QbSPfz2YfqZwJuwKiB/WEwGi7Wq5Eq8C6YB8BzCdMf/GVBCtxTt5OohuOWKn
9h1Ir/u0CUzv//TS/SeQZs9p9ADRfc/WhIFolS2/wbRAx8xMEH2v5wKYznvt
IvgfSO/5tAJMV827oAei9VZtNgTRO/PLbEH0pNbTjiCaYaZKCIiuO70QTB9J
2L+IIfSNo83us2DasCubjxFIe1WtA9NNDSclQfSZy9fB9AJHxRQQfcQoHEx7
n2LnVwDS7AmSYBoAoQ2ZNA==
  "],
 CellLabel->
  "In[280]:=",ExpressionUUID->"d26c00b6-9ccd-4838-8270-542ac2dccbda"],

Cell[BoxData[
 RowBox[{"fit1result", "=", 
  RowBox[{"fitAsphericalFormula", "[", 
   RowBox[{
    RowBox[{"frontSurfaceShapeFunction", "/.", "result"}], ",", 
    RowBox[{"frontSurfaceCurvature", "/.", "result"}], ",", "14", ",", 
    RowBox[{"conicSuggestion", "\[Rule]", 
     RowBox[{"-", "1."}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.802731612700083*^9, {3.802731665069541*^9, 3.802731680325223*^9}, {
   3.802731730931447*^9, 3.802731761427844*^9}, {3.802731859723213*^9, 
   3.8027318822791*^9}},
 CellLabel->
  "In[281]:=",ExpressionUUID->"f4d8962a-8dd7-4cbf-8e55-89c78a3816ae"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"fitAsphericalFormula", "[", "fit1result", "]"}], "[", "y", 
      "]"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"frontSurfaceShapeFunction", "/.", "result"}], ")"}], "[", "y",
       "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", "0", ",", 
     RowBox[{
      RowBox[{"interpolationDomain", "[", 
       RowBox[{"(", 
        RowBox[{"frontSurfaceShapeFunction", "/.", "result"}], ")"}], "]"}], 
      "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.802731767445895*^9, 3.802731853206667*^9}, {
  3.802731886047453*^9, 3.8027318872499647`*^9}},
 CellLabel->
  "In[282]:=",ExpressionUUID->"9c2904d7-069e-4201-8bdb-ce50643ecc9e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"attachAsphericalFormulaToSurface", "[", 
   RowBox[{"op", ",", "1", ",", "fit1result"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.802732083864037*^9, 3.802732104305263*^9}},
 CellLabel->
  "In[283]:=",ExpressionUUID->"e5a4611d-23c1-45b5-a83c-a7ecf85e39cb"],

Cell[BoxData[
 RowBox[{"fit2result", "=", 
  RowBox[{"fitAsphericalFormula", "[", 
   RowBox[{
    RowBox[{"backSurfaceShapeFunction", "/.", "result"}], ",", 
    RowBox[{"backSurfaceCurvature", "/.", "result"}], ",", "12"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.802731894550857*^9, 3.802731935446147*^9}},
 CellLabel->
  "In[284]:=",ExpressionUUID->"b33cf0dc-05e9-42fe-a51d-72fea1ff5a20"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"fitAsphericalFormula", "[", "fit2result", "]"}], "[", "y", 
      "]"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"backSurfaceShapeFunction", "/.", "result"}], ")"}], "[", "y", 
      "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", "0", ",", 
     RowBox[{
      RowBox[{"interpolationDomain", "[", 
       RowBox[{"(", 
        RowBox[{"backSurfaceShapeFunction", "/.", "result"}], ")"}], "]"}], 
      "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.802731921764933*^9, 3.802731931361342*^9}},
 CellLabel->
  "In[285]:=",ExpressionUUID->"406cdbd6-a9da-4e78-85c3-9ae640fb75d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"attachAsphericalFormulaToSurface", "[", 
   RowBox[{"op", ",", "3", ",", "fit2result"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.80273211477947*^9, 3.802732116095841*^9}, 
   3.802732342439581*^9},
 CellLabel->
  "In[286]:=",ExpressionUUID->"28c9bf7f-6c9c-43e1-aeb1-2e8fc2e9785a"],

Cell[BoxData[
 RowBox[{"zmxStringFromSolvedBiasphericAplanat", "[", 
  RowBox[{"op", ",", "result"}], "]"}]], "Input",
 CellChangeTimes->{{3.802732124274851*^9, 3.802732134522723*^9}},
 CellLabel->
  "In[287]:=",ExpressionUUID->"6c97499f-85ab-4ff2-b8ac-5091ee3819d0"]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{862, 911},
WindowMargins->{{Automatic, 419}, {Automatic, 47}},
FrontEndVersion->"12.2 for Mac OS X x86 (64-bit) (2021\:5e742\:67082\:65e5)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]]}, Visible -> False, 
  FrontEndVersion -> 
  "12.2 for Mac OS X x86 (64-bit) (2021\:5e742\:67082\:65e5)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"c83d767a-a925-41a4-b5e5-da3f3f903aa0"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 252, 5, 98, "Title",ExpressionUUID->"5e707cf1-c910-4771-8628-e24c8fb264ae",
 InitializationCell->True],
Cell[835, 29, 333, 8, 83, "Author",ExpressionUUID->"a19537de-9694-4b54-b2d7-641111eca191"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1205, 42, 181, 4, 98, "Title",ExpressionUUID->"b7adee4b-1cb9-43f1-9962-916916d9d57b",
 InitializationCell->True],
Cell[1389, 48, 632, 14, 68, "Input",ExpressionUUID->"359f29c9-0be4-4fa2-a9a5-dd809bf456d2",
 InitializationCell->True],
Cell[2024, 64, 903, 19, 194, "Input",ExpressionUUID->"1bf9be8d-7c53-4e8c-98e1-f5fc2e92d260",
 InitializationCell->True],
Cell[2930, 85, 1962, 33, 656, "Input",ExpressionUUID->"ad382fdf-2d76-41d4-84b9-d2356492a4d4",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[4917, 122, 188, 4, 67, "Section",ExpressionUUID->"785042fc-242d-4456-87cd-749bdaa6e4cf",
 InitializationCell->True],
Cell[5108, 128, 425, 8, 89, "Input",ExpressionUUID->"e28e69eb-fb91-464f-b3b9-eb0753db129a",
 InitializationCell->True],
Cell[5536, 138, 410, 8, 89, "Input",ExpressionUUID->"e19fc59d-a943-47d2-b579-f2d8f1284e59",
 InitializationCell->True],
Cell[5949, 148, 448, 9, 110, "Input",ExpressionUUID->"52caf16a-6b77-4307-a6af-b02a11561041",
 InitializationCell->True],
Cell[6400, 159, 517, 12, 110, "Input",ExpressionUUID->"09c5b9a8-ff5f-4f9b-ae1d-da7ddb4fa190",
 InitializationCell->True],
Cell[6920, 173, 664, 12, 173, "Input",ExpressionUUID->"90137011-fdaa-44a8-be86-2cc939ad4d72",
 InitializationCell->True],
Cell[7587, 187, 594, 11, 152, "Input",ExpressionUUID->"37e44015-824a-47f1-b973-893ac97dee9a",
 InitializationCell->True],
Cell[8184, 200, 500, 10, 110, "Input",ExpressionUUID->"a94ffd6c-0a66-4a9c-b74f-37f96e27c509",
 InitializationCell->True],
Cell[8687, 212, 455, 9, 110, "Input",ExpressionUUID->"8e72a694-11cb-4841-a763-d78431fe6991",
 InitializationCell->True],
Cell[9145, 223, 602, 12, 131, "Input",ExpressionUUID->"d72be07f-e718-4ae5-b9bf-4a6c6211810d",
 InitializationCell->True],
Cell[9750, 237, 537, 12, 110, "Input",ExpressionUUID->"c87294b7-4046-497f-a3db-df2833017ce3",
 InitializationCell->True],
Cell[10290, 251, 427, 10, 89, "Input",ExpressionUUID->"315b6aff-a6d8-4f8d-ab8c-7a6a39ddddb6",
 InitializationCell->True],
Cell[10720, 263, 346, 8, 68, "Input",ExpressionUUID->"119fb63c-d1c9-43f2-8744-8f0754a1393c",
 InitializationCell->True],
Cell[11069, 273, 415, 9, 89, "Input",ExpressionUUID->"cc98feaa-9be4-4656-ac72-9e3da282c37f",
 InitializationCell->True],
Cell[11487, 284, 491, 9, 110, "Input",ExpressionUUID->"17047ab0-9e17-465a-867c-0ddbb1ef7634",
 InitializationCell->True],
Cell[11981, 295, 488, 9, 110, "Input",ExpressionUUID->"0c26a406-47fb-4759-a930-f2373e250ae1",
 InitializationCell->True],
Cell[12472, 306, 669, 13, 131, "Input",ExpressionUUID->"50affa45-a2f9-4a08-ade6-c915df79d02e",
 InitializationCell->True],
Cell[13144, 321, 486, 10, 89, "Input",ExpressionUUID->"2d14b8ca-ac61-4ca6-aae3-65915ee9b230",
 InitializationCell->True],
Cell[13633, 333, 592, 13, 131, "Input",ExpressionUUID->"5742395c-c581-4828-9038-a57a82d74cab",
 InitializationCell->True],
Cell[14228, 348, 393, 8, 89, "Input",ExpressionUUID->"503eeee6-735c-48a9-b6b6-976e6f4e6c32",
 InitializationCell->True],
Cell[14624, 358, 408, 8, 89, "Input",ExpressionUUID->"cda3b684-fef6-4a1d-b0b8-7b71ec17e727",
 InitializationCell->True],
Cell[15035, 368, 596, 12, 131, "Input",ExpressionUUID->"ff528956-a7d6-4296-b81e-0e84b967f777",
 InitializationCell->True],
Cell[15634, 382, 482, 11, 89, "Input",ExpressionUUID->"6afec121-59f0-4960-8faa-14207e7e9689",
 InitializationCell->True],
Cell[16119, 395, 484, 11, 89, "Input",ExpressionUUID->"9d0301eb-5353-4fff-aa6f-5b5dd1bcb4f7",
 InitializationCell->True],
Cell[16606, 408, 1171, 25, 278, "Input",ExpressionUUID->"fedb3f80-47de-4ec4-886a-e308ad9a3f75",
 InitializationCell->True],
Cell[17780, 435, 882, 16, 173, "Input",ExpressionUUID->"9cd3e17c-59da-4169-934f-f6b08d34f6dc",
 InitializationCell->True],
Cell[18665, 453, 1580, 34, 236, "Input",ExpressionUUID->"40e1d1b0-4bbc-44a1-b783-9717b71b9132",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[20270, 491, 196, 4, 54, "Subsection",ExpressionUUID->"15091470-efc8-486d-b9fc-206bd21d8926",
 InitializationCell->True],
Cell[20469, 497, 2312, 32, 845, "Input",ExpressionUUID->"a42dd351-ad62-40f2-a95b-5748f5f37c57",
 InitializationCell->True],
Cell[22784, 531, 507, 12, 89, "Input",ExpressionUUID->"04677b2f-acd8-418b-ae57-611b8238bed4",
 InitializationCell->True],
Cell[23294, 545, 1418, 35, 236, "Input",ExpressionUUID->"cf6c962f-b779-4496-a52d-b18a88bb1f53",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[24761, 586, 198, 4, 67, "Section",ExpressionUUID->"61d116e8-3fd1-40e1-9860-08d499f273ac",
 InitializationCell->True],
Cell[24962, 592, 266, 5, 46, "Input",ExpressionUUID->"85ec62f6-ee45-4c9a-8329-6e5c5b416683",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[25265, 602, 187, 4, 67, "Section",ExpressionUUID->"76ee2710-ca4b-4daf-ae54-a8abb19ff956",
 InitializationCell->True],
Cell[25455, 608, 1240, 24, 152, "Input",ExpressionUUID->"dbcee280-d251-495b-8229-8cc7ae715cd1",
 InitializationCell->True],
Cell[26698, 634, 308, 7, 46, "Input",ExpressionUUID->"4e7a85bf-3a97-47fd-b4c3-9536fb911fcd",
 InitializationCell->True],
Cell[27009, 643, 1462, 40, 194, "Input",ExpressionUUID->"12e66b62-170c-4fb9-863b-9ae79dee2139",
 InitializationCell->True],
Cell[28474, 685, 1589, 31, 110, "Input",ExpressionUUID->"4ac9502a-3cfe-40c4-88d1-bde27bc59542",
 InitializationCell->True],
Cell[30066, 718, 8850, 195, 845, "Input",ExpressionUUID->"aa186a62-df25-4f77-ab09-c50c716130fc",
 InitializationCell->True],
Cell[38919, 915, 1535, 39, 173, "Input",ExpressionUUID->"db1571c6-6d2d-4b1f-8d92-bfaedf6403b0",
 InitializationCell->True],
Cell[40457, 956, 1651, 43, 173, "Input",ExpressionUUID->"d31fe10d-f2fc-4a2c-89fa-49e53ac1811d",
 InitializationCell->True],
Cell[42111, 1001, 1925, 44, 215, "Input",ExpressionUUID->"19a05a73-3eed-4709-82b7-dde6d6cd2cb1",
 InitializationCell->True],
Cell[44039, 1047, 201, 4, 46, "Input",ExpressionUUID->"200e5e24-d7a2-4dce-bf09-000180eaf815",
 InitializationCell->True],
Cell[44243, 1053, 3660, 91, 425, "Input",ExpressionUUID->"b1aa4135-0971-4313-8716-cfc751769a08",
 InitializationCell->True],
Cell[47906, 1146, 1769, 42, 194, "Input",ExpressionUUID->"f38cd959-e1e1-4c41-a45e-fc36f7987752",
 InitializationCell->True],
Cell[49678, 1190, 1083, 24, 131, "Input",ExpressionUUID->"3f44786d-46f4-4d8b-99fb-8db4dd93ab09",
 InitializationCell->True],
Cell[50764, 1216, 520, 13, 68, "Input",ExpressionUUID->"c7860b4a-247e-4e75-8a6d-5e24e152b411",
 InitializationCell->True],
Cell[51287, 1231, 4499, 97, 299, "Input",ExpressionUUID->"667a96d3-fc84-4744-a9a8-5ebc5828b7da",
 InitializationCell->True],
Cell[55789, 1330, 5813, 126, 425, "Input",ExpressionUUID->"7f3a6f61-86db-4c0c-88f1-a9c79dbc8944",
 InitializationCell->True],
Cell[61605, 1458, 5984, 127, 383, "Input",ExpressionUUID->"4ecacb49-dd94-4783-991a-c6d349b32928",
 InitializationCell->True],
Cell[67592, 1587, 7129, 155, 530, "Input",ExpressionUUID->"09491eae-d6da-48e6-96c6-2520894e073f",
 InitializationCell->True],
Cell[74724, 1744, 5518, 132, 509, "Input",ExpressionUUID->"4f748ab2-3234-4f33-b00d-0a3560bfe68b",
 InitializationCell->True],
Cell[80245, 1878, 8507, 184, 719, "Input",ExpressionUUID->"dacc8fa5-e511-4d0a-b462-2aa312800083",
 InitializationCell->True],
Cell[88755, 2064, 8703, 211, 425, "Input",ExpressionUUID->"cbb13df1-f95c-4f5b-ae20-c7d99140eda5",
 InitializationCell->True],
Cell[97461, 2277, 12694, 307, 593, "Input",ExpressionUUID->"53533be8-f38c-49f5-a959-d26a2c240e99",
 InitializationCell->True],
Cell[110158, 2586, 19537, 472, 782, "Input",ExpressionUUID->"30cac84d-a09c-4724-9d2f-9238a32d51a4",
 InitializationCell->True],
Cell[129698, 3060, 26760, 640, 1118, "Input",ExpressionUUID->"77b9237a-cb3a-4c09-8197-510e54cf2ee4",
 InitializationCell->True],
Cell[156461, 3702, 24980, 596, 950, "Input",ExpressionUUID->"e8673842-d67a-4158-9fcc-c4fe75be4400",
 InitializationCell->True],
Cell[181444, 4300, 32560, 779, 1265, "Input",ExpressionUUID->"2d563416-c8a3-47b9-95dc-30f9da048c35",
 InitializationCell->True],
Cell[214007, 5081, 1138, 37, 68, "Input",ExpressionUUID->"9c81b136-b67f-4932-b6e1-338afe13a5d0",
 InitializationCell->True],
Cell[215148, 5120, 471, 12, 68, "Input",ExpressionUUID->"6a85e04c-e947-4c8e-9efd-3eba66b74176",
 InitializationCell->True],
Cell[215622, 5134, 784, 18, 131, "Input",ExpressionUUID->"62d2bee8-7ac3-4eaa-8f09-f294ed9b65ac",
 InitializationCell->True],
Cell[216409, 5154, 7319, 170, 698, "Input",ExpressionUUID->"6281a8c2-8df3-4c7b-b4bd-d7623e0d7e45",
 InitializationCell->True],
Cell[223731, 5326, 10266, 249, 1034, "Input",ExpressionUUID->"808816cb-7619-4b09-bebd-53cd3f2d9cf4",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[234022, 5579, 183, 4, 54, "Subsection",ExpressionUUID->"907889f9-868e-4852-9b69-dd85d2d12726",
 InitializationCell->True],
Cell[234208, 5585, 953, 20, 152, "Input",ExpressionUUID->"a4999d4c-6706-40ec-bfca-fcc36820dbd1",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[235210, 5611, 255, 6, 67, "Section",ExpressionUUID->"6eee3bb1-f758-4993-bcb7-d9269738b74a",
 InitializationCell->True,
 InitializationGroup->True],
Cell[235468, 5619, 363, 10, 68, "Input",ExpressionUUID->"f275cb89-6114-40ce-8d49-f93fef53863e",
 InitializationCell->True,
 InitializationGroup->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[235880, 5635, 208, 4, 98, "Title",ExpressionUUID->"372e56f2-6c59-4e9c-8798-e5ebdeed3a2e"],
Cell[236091, 5641, 1009, 20, 178, "Input",ExpressionUUID->"00b1e10c-b6b0-4e6f-8355-4da313b9effa"],
Cell[CellGroupData[{
Cell[237125, 5665, 214, 4, 67, "Section",ExpressionUUID->"daf9c55f-c473-4236-8a4c-13c22df2f12e"],
Cell[237342, 5671, 819, 16, 52, "Input",ExpressionUUID->"bc4fe511-d964-4ccf-98e8-57814c699eb1"],
Cell[238164, 5689, 907, 16, 30, "Input",ExpressionUUID->"e77dd041-d1ce-497b-a5ba-44810c05f8a6"],
Cell[239074, 5707, 1024, 16, 30, "Input",ExpressionUUID->"2c67d04a-364a-4780-9e6c-c2f30482c9e2"],
Cell[240101, 5725, 520, 10, 30, "Input",ExpressionUUID->"9203869c-ce1e-4d7a-9a37-4bc549836dfd"],
Cell[240624, 5737, 1637, 38, 94, "Input",ExpressionUUID->"37e1f7a2-5c8f-4778-be81-d6a89ecaf316"],
Cell[242264, 5777, 941, 21, 52, "Input",ExpressionUUID->"d32b4f2d-8fc1-4ee8-af2e-cdcf01aa3d34"],
Cell[243208, 5800, 1095, 27, 73, "Input",ExpressionUUID->"3040eaf2-b4eb-4d74-9240-2b0087f800b1"],
Cell[244306, 5829, 1129, 29, 52, "Input",ExpressionUUID->"0a366386-67cd-45b4-a819-155f6dc71233"],
Cell[245438, 5860, 455, 10, 30, "Input",ExpressionUUID->"d9691390-26a5-4f9a-8a8a-736417941f74"],
Cell[245896, 5872, 2878, 70, 262, "Input",ExpressionUUID->"dc865e29-f46a-429b-9bb8-4f49c5df6174"],
Cell[248777, 5944, 313, 6, 30, "Input",ExpressionUUID->"7e05a895-f404-4f8f-b181-1bcbbab3fcb6"],
Cell[249093, 5952, 490, 12, 30, "Input",ExpressionUUID->"877a4e4a-a293-41c8-85bf-e0825e212f0f"],
Cell[249586, 5966, 886, 18, 52, "Input",ExpressionUUID->"eb57b8f8-9b44-4784-9043-3a4a996709d6"],
Cell[250475, 5986, 907, 16, 30, "Input",ExpressionUUID->"44fc1428-07bf-4318-8c76-63c46a6ceede"],
Cell[251385, 6004, 1024, 16, 30, "Input",ExpressionUUID->"315b8443-4a40-48c5-8d89-e5c5099b3095"],
Cell[252412, 6022, 518, 10, 30, "Input",ExpressionUUID->"5ff77b97-06b1-45a9-82a5-ff86594b0278"],
Cell[252933, 6034, 1639, 38, 94, "Input",ExpressionUUID->"5c33d8e6-4d6e-4e67-a6b6-5ded7783c2c2"],
Cell[254575, 6074, 925, 21, 52, "Input",ExpressionUUID->"d26c00b6-9ccd-4838-8270-542ac2dccbda"],
Cell[255503, 6097, 595, 13, 52, "Input",ExpressionUUID->"f4d8962a-8dd7-4cbf-8e55-89c78a3816ae"],
Cell[256101, 6112, 846, 24, 52, "Input",ExpressionUUID->"9c2904d7-069e-4201-8bdb-ce50643ecc9e"],
Cell[256950, 6138, 296, 6, 30, "Input",ExpressionUUID->"e5a4611d-23c1-45b5-a83c-a7ecf85e39cb"],
Cell[257249, 6146, 397, 9, 52, "Input",ExpressionUUID->"b33cf0dc-05e9-42fe-a51d-72fea1ff5a20"],
Cell[257649, 6157, 793, 23, 52, "Input",ExpressionUUID->"406cdbd6-a9da-4e78-85c3-9ae640fb75d1"],
Cell[258445, 6182, 321, 7, 30, "Input",ExpressionUUID->"28c9bf7f-6c9c-43e1-aeb1-2e8fc2e9785a"],
Cell[258769, 6191, 267, 5, 30, "Input",ExpressionUUID->"6c97499f-85ab-4ff2-b8ac-5091ee3819d0"]
}, Open  ]]
}, Open  ]]
}
]
*)

