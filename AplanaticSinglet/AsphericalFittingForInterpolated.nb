(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     38963,        945]
NotebookOptionsPosition[     35147,        864]
NotebookOutlinePosition[     35625,        882]
CellTagsIndexPosition[     35582,        879]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["AsphericalFittingForInterpolated", "Title",
 CellChangeTimes->{{3.817423978837092*^9, 
  3.817423987461358*^9}},ExpressionUUID->"9c213115-8372-4661-ac5b-\
69e47ed27a83"],

Cell["\<\
Takatoshi Yamada@Ayase corporation
e - mail : takatoshi.yamada@ayasecorporation.com
web cite : https : // www.ayasecorporation.com\
\>", "Author",
 CellChangeTimes->{{3.817423896747398*^9, 3.8174239195219517`*^9}, {
  3.817432333562894*^9, 
  3.817432334218192*^9}},ExpressionUUID->"b989a3f8-7774-4a0c-95fd-\
db179a13a6ca"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Package definitions", "Title",
 InitializationCell->True,
 CellChangeTimes->{{3.799464463020203*^9, 
  3.799464469352387*^9}},ExpressionUUID->"303f3cf2-acc8-476d-a8d3-\
b899067af727"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeginPackage", "[", 
   RowBox[{
   "\"\<AplanaticSinglet`AsphericalFittingForInterpolated`\>\"", ",", 
    RowBox[{"{", "\"\<AplanaticSinglet`RayTrace2D`\>\"", "}"}]}], "]"}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.799376616843014*^9, 3.7993766174281387`*^9}, {
   3.799463892374659*^9, 3.799463901385004*^9}, {3.799463943191332*^9, 
   3.7994639601568813`*^9}, {3.8012811158639307`*^9, 
   3.8012811169214573`*^9}, {3.8174240039931507`*^9, 3.817424033523466*^9}, 
   3.818461706512961*^9, 3.818462988174159*^9, 
   3.818716671788349*^9},ExpressionUUID->"4043c8ee-1d59-49ae-8c73-\
ad62cd3e16d0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "AsphericalFittingForInterpolatedVersion", "=", 
   "\"\<AsphericalFittingForInterpolated 0.1A by Takatoshi Yamada, Ayase \
corp.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.799376616843014*^9, 3.7993766174281387`*^9}, {
  3.799463892374659*^9, 3.799463901385004*^9}, {3.799463943191332*^9, 
  3.7994639601568813`*^9}, {3.8012811158639307`*^9, 3.8012811169214573`*^9}, {
  3.8174240039931507`*^9, 
  3.817424176588312*^9}},ExpressionUUID->"c8fd9fd9-7c9e-4d77-a1b8-\
27719a1d8f44"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "AsphericalFittingForInterpolatedDescrciption", "=", 
   "\"\<AsphericalFittingForInterpolatedVersion package for converting a lens \
shape expressed by interpolation function into a function in aspherical \
formula.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.799376616843014*^9, 3.7993766174281387`*^9}, {
  3.799463892374659*^9, 3.799463901385004*^9}, {3.799463943191332*^9, 
  3.7994639601568813`*^9}, {3.8012811158639307`*^9, 3.8012811169214573`*^9}, {
  3.8174240039931507`*^9, 
  3.817424176588312*^9}},ExpressionUUID->"bbc5044c-136a-4b47-8da4-\
3554fb318d61"],

Cell[CellGroupData[{

Cell["usage messages", "Section",
 AutoGeneratedPackage->Automatic,
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.797038752561654*^9, 
  3.797038760521872*^9}},ExpressionUUID->"a34487c9-01c0-4e9c-8bba-\
4dd39b98017b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "AsphericalFittingForInterpolatedVersion", "=", "\"\<version0.1A\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7994639900829077`*^9, 3.799464273324094*^9}, 
   3.7994643343914957`*^9, {3.799464782800934*^9, 
   3.799464832573166*^9}},ExpressionUUID->"27f1b0a2-9b0d-4d52-8e72-\
cb35df6f70b0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "AsphericalFittingForInterpolatedUsage", "=", 
   "\"\<type '?fitAsphericalFomura' and '?elliminateConstantOffset' to show \
usage texts.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7994639900829077`*^9, 3.799464273324094*^9}, 
   3.7994643343914957`*^9, {3.799464782800934*^9, 
   3.799464864816637*^9}},ExpressionUUID->"28ec5eb9-3e28-4ec0-b43a-\
e3af8b9e10a5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fitAsphericalFormula", "::", "usage"}], "=", 
   "\"\<fitAsphericalFormula[if_InterpolatingFunction,explicitCurvature_?\
NumericQ,heighestOrder_,opt___] returns coefficients of aspherical formura \
from InterpolationFunction. This call needs to specify paraxial curvature of \
the function.\nfitAsphericalFormula[\\\"output\\\"] returns tag symbols of \
fitted coefficients.\nfitAsphericalFormula[fittedResult:{_Rule...}][y_] \
returns a Mathematica function for variable 'y' to give a result of fitted \
coefficients.\nfitAsphericalFormula[\\\"formula\\\"][y_] returns aspherical \
formula for variable y.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7994639900829077`*^9, 3.799464273324094*^9}, 
   3.7994643343914957`*^9, {3.799464782800934*^9, 3.799464795289186*^9}, {
   3.799465664049143*^9, 3.7994656808489733`*^9}, {3.799465712381198*^9, 
   3.799465712931284*^9}, {3.7994657834949102`*^9, 3.799465846586969*^9}, {
   3.799466376383222*^9, 3.7994663834931507`*^9}, {3.80042989956811*^9, 
   3.8004299117685328`*^9}},ExpressionUUID->"c93fb3c5-c197-4729-94de-\
3d4f3a337cfb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"forceParabolic", "::", "usage"}], "=", 
   "\"\<forceParabolic is an option of fitAsphericalFormula. Fitting will be \
tried using conic constant = -1.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7994639900829077`*^9, 3.799464273324094*^9}, 
   3.7994643343914957`*^9, {3.799464782800934*^9, 3.799464795289186*^9}, {
   3.799465664049143*^9, 3.7994656808489733`*^9}, {3.799465712381198*^9, 
   3.799465712931284*^9}, {3.7994657834949102`*^9, 3.799465846586969*^9}, {
   3.799466376383222*^9, 3.7994663834931507`*^9}, {3.80042989956811*^9, 
   3.800430050733425*^9}},ExpressionUUID->"e7e93f2f-6665-4f3f-b095-\
ce43db045491"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"conicSuggestion", "::", "usage"}], "=", 
   "\"\<conicSuggestion is an option of fitAsphericalFormula. It specifies \
initial value for conic constant. The default value is 0.0.\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7994639900829077`*^9, 3.799464273324094*^9}, 
   3.7994643343914957`*^9, {3.799464782800934*^9, 3.799464795289186*^9}, {
   3.799465664049143*^9, 3.7994656808489733`*^9}, {3.799465712381198*^9, 
   3.799465712931284*^9}, {3.7994657834949102`*^9, 3.799465846586969*^9}, {
   3.799466376383222*^9, 3.7994663834931507`*^9}, {3.80042989956811*^9, 
   3.800430050733425*^9}, {3.800433588866008*^9, 3.80043362845278*^9}, {
   3.800433675150461*^9, 
   3.800433714577826*^9}},ExpressionUUID->"13667e46-2cfb-49de-8590-\
bf904ac2bf29"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"outputMathematicaFunction", "::", "usage"}], "=", 
   "\"\<outputMathematicaFunction is an option of fitAsphericalFormula. If it \
is specified True, fitAsphericalFormula returns Mathematica Function.\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7994639900829077`*^9, 3.799464273324094*^9}, 
   3.7994643343914957`*^9, {3.799464782800934*^9, 3.799464795289186*^9}, {
   3.799465664049143*^9, 3.7994656808489733`*^9}, {3.799465712381198*^9, 
   3.799465712931284*^9}, {3.7994657834949102`*^9, 3.799465846586969*^9}, {
   3.799466376383222*^9, 3.7994663834931507`*^9}, {3.80042989956811*^9, 
   3.800430050733425*^9}, {3.800433588866008*^9, 3.80043362845278*^9}, {
   3.800433675150461*^9, 
   3.800433741065751*^9}},ExpressionUUID->"304103de-a0df-4cec-bc3a-\
b84f72f2c00c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"elliminateConstantOffset", "::", "usage"}], "=", 
   "\"\<fitAsphericalFomura[elliminateConstantOffset[fittedResult]][y_] \
returns a Mathematica function without constant offset value.\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.799464285125814*^9, 3.799464331994883*^9}, {
  3.799465396862075*^9, 3.799465399730226*^9}, {3.800581777757348*^9, 
  3.800581797094202*^9}},ExpressionUUID->"94896291-ce92-4f25-ba5b-\
1a2f24ada307"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"asphericalFormulaFitting", "::", "usage"}], "=", 
   "\"\<asphericalFormulaFitting is a tag for surface attribute.\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.799464285125814*^9, 3.799464331994883*^9}, {
  3.799465396862075*^9, 3.799465399730226*^9}, {3.800581777757348*^9, 
  3.800581797094202*^9}},ExpressionUUID->"68898247-02f2-4a93-81aa-\
81313d35b870"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
   "constantOffset", ",", "curvature", ",", "conicConstant", ",", 
    "powerSeriesCoefficients", ",", "normalizationRadius"}], "}"}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.799464285125814*^9, 3.799464331994883*^9}, {
  3.799465396862075*^9, 3.799465402655944*^9}, {3.800480468860016*^9, 
  3.800480471784136*^9}, {3.8004805164124813`*^9, 
  3.8004805257634497`*^9}},ExpressionUUID->"f44f6f92-c81c-45f6-b60e-\
93a0199f0b9d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Private section", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.799464349266911*^9, 3.799464361089664*^9}, {
  3.7994644177522287`*^9, 
  3.799464423496195*^9}},ExpressionUUID->"4fdf72d2-f746-4576-bc30-\
284c0c7a9867"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 AutoGeneratedPackage->Automatic,
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.797738391152273*^9, 3.797738402558744*^9}, {
  3.799464409766488*^9, 
  3.79946441775991*^9}},ExpressionUUID->"eed464b7-4e67-4af5-b0c8-\
9515eadc5613"],

Cell[BoxData[
 RowBox[{
  RowBox[{"minimize2ndCoefficient", "[", 
   RowBox[{
    RowBox[{"pnts", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"_", ",", "_"}], "}"}], "..."}], "}"}]}], ",", "func_", ",", 
    RowBox[{"{", 
     RowBox[{"coef_Symbol", "->", 
      RowBox[{"ival_", "?", "NumberQ"}]}], "}"}], ",", "v_Symbol"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "fv"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"FindMinimum", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"fv", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Fit", "[", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                   RowBox[{"(", 
                    RowBox[{"func", "/.", 
                    RowBox[{"v", "->", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}]}]}], "}"}], 
                "&"}], ",", "pnts"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", "^", "2"}], "}"}], ",", "x"}], "]"}], "/.", 
           RowBox[{"x", "\[Rule]", "1"}]}], ")"}], "^", "2"}]}], ")"}], ",", 
      RowBox[{"{", 
       RowBox[{"coef", ",", "ival"}], "}"}]}], "]"}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.798405368992572*^9, 3.798405395306839*^9}, {
   3.798405543914464*^9, 3.7984056283586884`*^9}, {3.798405664866147*^9, 
   3.7984057866514797`*^9}, {3.798405852198748*^9, 3.798405861377537*^9}, {
   3.798405946713623*^9, 3.798405946970686*^9}, {3.7984059813980722`*^9, 
   3.798405988664853*^9}, {3.798421266812101*^9, 3.7984212742675858`*^9}, {
   3.798421332837021*^9, 3.798421348509074*^9}, {3.798421430503022*^9, 
   3.7984214814777403`*^9}, {3.798421613364019*^9, 3.798421656712294*^9}, {
   3.798421707847538*^9, 3.798421712226532*^9}, {3.7984217442205153`*^9, 
   3.798421783550233*^9}, {3.7984218323339863`*^9, 3.79842194154106*^9}, {
   3.798422001802589*^9, 3.798422070821813*^9}, {3.798422146299717*^9, 
   3.798422167899931*^9}, {3.798422307847753*^9, 3.798422344227665*^9}, {
   3.7984223755279016`*^9, 3.7984223857425632`*^9}, {3.798422506528998*^9, 
   3.7984225284991293`*^9}, {3.798422784358247*^9, 3.798422882607255*^9}, 
   3.7984230907659397`*^9, 3.798423309932597*^9},
 CellLabel->"In[2]:=",ExpressionUUID->"83de4e14-0f2a-424f-9162-9ad7145f04bd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "fitAsphericalFormula", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fitAsphericalFormula", "[", "\"\<formula\>\"", "]"}], "[", "y_", 
    "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"curvature", "*", 
       RowBox[{"y", "^", "2"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"curvature", "^", "2"}], "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", "conicConstant"}], ")"}], "*", 
          RowBox[{"y", "^", "2"}]}]}], "]"}]}], ")"}]}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"powerSeriesCoefficients", "[", "i", "]"}], 
       RowBox[{"y", "^", "i"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "4", ",", "10", ",", "2"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fitAsphericalFormula", "[", "\"\<output\>\"", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
    "constantOffset", ",", "curvature", ",", "conicConstant", ",", 
     "powerSeriesCoefficients"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fitAsphericalFormula", "::", "cantfindk"}], "=", 
   "\"\<can not find proper conic constant value. Try to specify suggestions.\
\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7993766823112307`*^9, 3.799376710222033*^9}, {
   3.799376740712891*^9, 3.7993768492772923`*^9}, {3.799376882161489*^9, 
   3.799376900502791*^9}, {3.79937716770998*^9, 3.799377206827203*^9}, {
   3.799377270201777*^9, 3.799377456721095*^9}, {3.799377869998048*^9, 
   3.7993779057268753`*^9}, {3.7993779595075293`*^9, 3.799377979732443*^9}, {
   3.799378038913011*^9, 3.7993781060524282`*^9}, {3.79937826257036*^9, 
   3.799378338295493*^9}, {3.7993783868215733`*^9, 3.799378387966238*^9}, {
   3.799378547544991*^9, 3.7993785761971684`*^9}, {3.799378669690095*^9, 
   3.79937868641782*^9}, {3.799378872716448*^9, 3.799378977295354*^9}, {
   3.799379029531514*^9, 3.799379043335432*^9}, {3.799459991137082*^9, 
   3.799460008043045*^9}, 3.799464754428479*^9, {3.799465531126861*^9, 
   3.799465531631467*^9}, {3.7994657223508244`*^9, 3.799465730313931*^9}, {
   3.799465853922785*^9, 3.799465862146867*^9}, {3.799465896530439*^9, 
   3.799465897890705*^9}, {3.799466053717691*^9, 3.799466116790778*^9}, {
   3.7994663671034613`*^9, 3.799466368249782*^9}, 3.799466425525176*^9, {
   3.799466505673889*^9, 3.7994665079912777`*^9}, {3.7994667954190207`*^9, 
   3.799466851367737*^9}},ExpressionUUID->"fc0177a7-f6ee-4c0e-8eff-\
47136fb43014"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "fitAsphericalFormula", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"forceParabolic", "\[Rule]", "False"}], ",", 
     RowBox[{"conicSuggestion", "\[Rule]", "0"}], ",", 
     RowBox[{"outputMathematicaFunction", "\[Rule]", "False"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fitAsphericalFormula", "[", 
    RowBox[{"fittedResult", ":", 
     RowBox[{"{", 
      RowBox[{"_Rule", "..."}], "}"}]}], "]"}], "[", "y_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"orders", ",", "quad", ",", "pw"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"quad", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"curvature", "*", 
           RowBox[{"y", "^", "2"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"1", "-", 
             RowBox[{
              RowBox[{"curvature", "^", "2"}], "*", 
              RowBox[{"(", 
               RowBox[{"1", "+", "conicConstant"}], ")"}], "*", 
              RowBox[{"y", "^", "2"}]}]}], "]"}]}], ")"}]}], "/.", 
        "fittedResult"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"orders", "=", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{"First", ",", "fittedResult"}], "]"}], ",", 
         RowBox[{
          RowBox[{"powerSeriesCoefficients", "[", "i_", "]"}], "\[Rule]", 
          "i"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pw", "=", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"powerSeriesCoefficients", "[", "#", "]"}], 
             RowBox[{"y", "^", "#"}]}], ")"}], "&"}], ",", "orders"}], "]"}], 
        "/.", "fittedResult"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"quad", "+", 
       RowBox[{"Apply", "[", 
        RowBox[{"Plus", ",", "pw"}], "]"}], "+", 
       RowBox[{"(", 
        RowBox[{"constantOffset", "/.", "fittedResult"}], ")"}]}]}]}], 
    "\[IndentingNewLine]", "]"}], "/;", 
   RowBox[{"(", 
    RowBox[{"!", " ", 
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{"First", ",", "fittedResult"}], "]"}], ",", 
       "normalizationRadius"}], "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fitAsphericalFormula", "[", 
     RowBox[{"fittedResult", ":", 
      RowBox[{"{", 
       RowBox[{"_Rule", "..."}], "}"}]}], "]"}], "[", "y_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"orders", ",", "quad", ",", "pw", ",", "rad"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rad", "=", 
        RowBox[{"normalizationRadius", "/.", "fittedResult"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"quad", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"curvature", "*", 
            RowBox[{"y", "^", "2"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"1", "-", 
              RowBox[{
               RowBox[{"curvature", "^", "2"}], "*", 
               RowBox[{"(", 
                RowBox[{"1", "+", "conicConstant"}], ")"}], "*", 
               RowBox[{"y", "^", "2"}]}]}], "]"}]}], ")"}]}], "/.", 
         "fittedResult"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"orders", "=", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{"First", ",", "fittedResult"}], "]"}], ",", 
          RowBox[{
           RowBox[{"powerSeriesCoefficients", "[", "i_", "]"}], "\[Rule]", 
           "i"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pw", "=", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"powerSeriesCoefficients", "[", "#", "]"}], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"y", "/", "rad"}], ")"}], "^", "#"}]}], ")"}], "&"}], 
           ",", "orders"}], "]"}], "/.", "fittedResult"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"quad", "+", 
        RowBox[{"Apply", "[", 
         RowBox[{"Plus", ",", "pw"}], "]"}], "+", 
        RowBox[{"(", 
         RowBox[{"constantOffset", "/.", "fittedResult"}], ")"}]}]}]}], 
     "\[IndentingNewLine]", "]"}], "/;", 
    RowBox[{"MemberQ", "[", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{"First", ",", "fittedResult"}], "]"}], ",", 
      "normalizationRadius"}], "]"}]}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fitAsphericalFormula", "[", 
   RowBox[{"if_InterpolatingFunction", ",", 
    RowBox[{"explicitCurvature_", "?", "NumericQ"}], ",", 
    RowBox[{"heighestOrder_", "?", "IntegerQ"}], ",", "opt___Rule"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "orgv", ",", "quad", ",", "quadk", ",", "y", ",", "surfpnts", ",", "k", 
      ",", "kini", ",", "ksol", ",", "fk", ",", "ppnt", ",", "spow", ",", 
      "kval", ",", "csug", ",", "para", ",", "normr", ",", "ret"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"csug", "=", 
      RowBox[{
       RowBox[{"conicSuggestion", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"Options", "[", "fitAsphericalFormula", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"para", "=", 
      RowBox[{
       RowBox[{"forceParabolic", "/.", 
        RowBox[{"{", "opt", "}"}]}], "/.", 
       RowBox[{"Options", "[", "fitAsphericalFormula", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"quad", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"explicitCurvature", "*", 
         RowBox[{"y", "^", "2"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "-", 
           RowBox[{
            RowBox[{"explicitCurvature", "^", "2"}], "*", 
            RowBox[{"(", 
             RowBox[{"1", "+", "k"}], ")"}], "*", 
            RowBox[{"y", "^", "2"}]}]}], "]"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"orgv", "=", 
      RowBox[{"if", "[", "0", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"surfpnts", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{"if", "[", "#", "]"}], "-", "orgv"}]}], "}"}], "&"}], ",", 
        RowBox[{"interpolationSectionPoints", "[", "if", "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"ksol", "=", 
      RowBox[{"If", "[", 
       RowBox[{"para", ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"k", "\[Rule]", 
           RowBox[{"-", "1"}]}], "}"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"kini", "=", 
          RowBox[{"Check", "[", 
           RowBox[{
            RowBox[{"FindFit", "[", 
             RowBox[{"surfpnts", ",", "quad", ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"k", ",", "csug"}], "}"}], "}"}], ",", "y"}], "]"}], 
            ",", 
            RowBox[{
             RowBox[{"Message", "[", 
              RowBox[{"fitAsphericalFormula", "::", "cantfindk"}], "]"}], ";", 
             RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"minimize2ndCoefficient", "[", 
          RowBox[{"surfpnts", ",", "quad", ",", "kini", ",", "y"}], "]"}]}]}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"quadk", "=", 
      RowBox[{"quad", "/.", 
       RowBox[{"ksol", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"kval", "=", 
      RowBox[{"k", "/.", 
       RowBox[{"ksol", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ppnt", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", "quadk"}], "/.", 
            RowBox[{"y", "\[Rule]", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}]}], "}"}], "&"}], ",", 
        "surfpnts"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"spow", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"heighestOrder", "<", "4"}], ",", 
        RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"heighestOrder", "\[LessEqual]", "16"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"CoefficientList", "[", 
           RowBox[{
            RowBox[{"Fit", "[", 
             RowBox[{"ppnt", ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"y", "^", "n"}], ",", 
                RowBox[{"{", 
                 RowBox[{"n", ",", "4", ",", "heighestOrder", ",", "2"}], 
                 "}"}]}], "]"}], ",", "y"}], "]"}], ",", "y"}], "]"}], ",", 
          RowBox[{
           RowBox[{"normr", "=", 
            RowBox[{"Max", "[", 
             RowBox[{"Abs", "[", 
              RowBox[{"interpolationDomain", "[", "if", "]"}], "]"}], "]"}]}],
            ";", 
           RowBox[{"CoefficientList", "[", 
            RowBox[{
             RowBox[{"Fit", "[", 
              RowBox[{
               RowBox[{"normalizeRadius", "[", 
                RowBox[{"ppnt", ",", "normr"}], "]"}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"y", "^", "n"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"n", ",", "4", ",", "heighestOrder", ",", "2"}], 
                  "}"}]}], "]"}], ",", "y"}], "]"}], ",", "y"}], "]"}]}]}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ret", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"constantOffset", "\[Rule]", "orgv"}], ",", 
         RowBox[{"curvature", "->", "explicitCurvature"}], ",", 
         RowBox[{"conicConstant", "->", "kval"}], ",", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"MapIndexed", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"powerSeriesCoefficients", "[", 
                RowBox[{
                 RowBox[{"#2", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], "]"}], 
               "\[Rule]", "#1"}], "&"}], ",", "spow"}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], "=!=", "0"}], "&"}]}], 
          "]"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"NumericQ", "[", "normr", "]"}], ",", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"ret", ",", 
         RowBox[{"normalizationRadius", "\[Rule]", "normr"}]}], "]"}], ",", 
       "ret"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"outputMathematicaFunction", "/.", 
          RowBox[{"{", "opt", "}"}]}], "/.", 
         RowBox[{"Options", "[", "fitAsphericalFormula", "]"}]}], ")"}], ",", 
       
       RowBox[{
        RowBox[{
         RowBox[{"fitAsphericalFormula", "[", "ret", "]"}], "[", "#", "]"}], 
        "&"}], ",", "ret"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7993766823112307`*^9, 3.799376710222033*^9}, {
   3.799376740712891*^9, 3.7993768492772923`*^9}, {3.799376882161489*^9, 
   3.799376900502791*^9}, {3.79937716770998*^9, 3.799377206827203*^9}, {
   3.799377270201777*^9, 3.799377456721095*^9}, {3.799377869998048*^9, 
   3.7993779057268753`*^9}, {3.7993779595075293`*^9, 3.799377979732443*^9}, {
   3.799378038913011*^9, 3.7993781060524282`*^9}, {3.79937826257036*^9, 
   3.799378338295493*^9}, {3.7993783868215733`*^9, 3.799378387966238*^9}, {
   3.799378547544991*^9, 3.7993785761971684`*^9}, {3.799378669690095*^9, 
   3.79937868641782*^9}, {3.799378872716448*^9, 3.799378977295354*^9}, {
   3.799379029531514*^9, 3.799379043335432*^9}, {3.799459991137082*^9, 
   3.799460008043045*^9}, 3.799464754428479*^9, {3.799465531126861*^9, 
   3.799465531631467*^9}, {3.7994657223508244`*^9, 3.799465730313931*^9}, {
   3.799465853922785*^9, 3.799465862146867*^9}, {3.799465896530439*^9, 
   3.799465897890705*^9}, {3.799466053717691*^9, 3.799466116790778*^9}, 
   3.799466324893013*^9, {3.799466510276249*^9, 3.799466511490961*^9}, {
   3.799466780019012*^9, 3.799466786801298*^9}, {3.799466860120941*^9, 
   3.799466871878336*^9}, {3.799467289057617*^9, 3.7994672949065723`*^9}, 
   3.799467390862627*^9, {3.8003160522671003`*^9, 3.800316053763832*^9}, {
   3.800316095748131*^9, 3.800316149907585*^9}, {3.800429681268589*^9, 
   3.800429718204364*^9}, {3.800429778312052*^9, 3.800429875257509*^9}, {
   3.800433482049526*^9, 3.800433529722747*^9}, {3.8004335710452137`*^9, 
   3.800433580061185*^9}, {3.80043374708189*^9, 3.800433751938497*^9}, {
   3.800479814481847*^9, 3.8004798340278387`*^9}, 3.8004800046694613`*^9, {
   3.8004800997196712`*^9, 3.8004801808124*^9}, {3.800480251046618*^9, 
   3.8004803082970533`*^9}, {3.8004807867074614`*^9, 3.800480801213922*^9}, {
   3.800480836945915*^9, 3.800480843550069*^9}, {3.800480876153596*^9, 
   3.800481014855089*^9}, {3.800481049438452*^9, 3.800481072388671*^9}, {
   3.800481165541788*^9, 3.8004812534381027`*^9}, {3.8004813069769897`*^9, 
   3.800481383354836*^9}, {3.80048149638623*^9, 3.800481595881042*^9}, {
   3.800481631757516*^9, 3.800481677806662*^9}, {3.800481783277479*^9, 
   3.8004818730287247`*^9}, {3.800481944028378*^9, 3.8004819460657263`*^9}, {
   3.800482010506287*^9, 3.800482011135631*^9}, {3.802731723482095*^9, 
   3.802731724473131*^9}, {3.823402848601729*^9, 3.8234028592620077`*^9}, 
   3.823403717226782*^9, {3.823405059803841*^9, 3.823405078234453*^9}, {
   3.8234052568882236`*^9, 3.823405258456314*^9}, {3.8234178946867723`*^9, 
   3.8234178961983213`*^9}, {3.823417927391914*^9, 3.823417937796124*^9}, {
   3.823417973878295*^9, 
   3.8234179749104156`*^9}},ExpressionUUID->"c1b57fb5-143f-4a0a-ba90-\
ec2e8cc0def0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"normalizeRadius", "[", 
   RowBox[{
    RowBox[{"pnts", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"_", ",", "_"}], "}"}], "..."}], "}"}]}], ",", "rad_"}], 
   "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "/", "rad"}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], ",", "pnts"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7993766823112307`*^9, 3.799376710222033*^9}, {
   3.799376740712891*^9, 3.7993768492772923`*^9}, {3.799376882161489*^9, 
   3.799376900502791*^9}, {3.79937716770998*^9, 3.799377206827203*^9}, {
   3.799377270201777*^9, 3.799377456721095*^9}, {3.799377869998048*^9, 
   3.7993779057268753`*^9}, {3.7993779595075293`*^9, 3.799377979732443*^9}, {
   3.799378038913011*^9, 3.7993781060524282`*^9}, {3.79937826257036*^9, 
   3.799378338295493*^9}, {3.7993783868215733`*^9, 3.799378387966238*^9}, {
   3.799378547544991*^9, 3.7993785761971684`*^9}, {3.799378669690095*^9, 
   3.79937868641782*^9}, {3.799378872716448*^9, 3.799378977295354*^9}, {
   3.799379029531514*^9, 3.799379043335432*^9}, {3.799459991137082*^9, 
   3.799460008043045*^9}, 3.799464754428479*^9, {3.799465531126861*^9, 
   3.799465531631467*^9}, {3.7994657223508244`*^9, 3.799465730313931*^9}, {
   3.799465853922785*^9, 3.799465862146867*^9}, {3.799465896530439*^9, 
   3.799465897890705*^9}, {3.799466053717691*^9, 3.799466116790778*^9}, 
   3.799466324893013*^9, {3.799466510276249*^9, 3.799466511490961*^9}, {
   3.799466780019012*^9, 3.799466786801298*^9}, {3.799466860120941*^9, 
   3.799466871878336*^9}, {3.799467289057617*^9, 3.7994672949065723`*^9}, 
   3.799467390862627*^9, {3.8003160522671003`*^9, 3.800316053763832*^9}, {
   3.800316095748131*^9, 3.800316149907585*^9}, {3.800429681268589*^9, 
   3.800429718204364*^9}, {3.800429778312052*^9, 3.800429875257509*^9}, {
   3.800433482049526*^9, 3.800433529722747*^9}, {3.8004335710452137`*^9, 
   3.800433580061185*^9}, {3.80043374708189*^9, 3.800433751938497*^9}, {
   3.800479814481847*^9, 3.8004798340278387`*^9}, 3.8004800046694613`*^9, {
   3.8004800997196712`*^9, 3.8004801808124*^9}, {3.800480251046618*^9, 
   3.8004803082970533`*^9}, {3.8004807867074614`*^9, 3.800480801213922*^9}, {
   3.800480836945915*^9, 3.800480843550069*^9}, {3.800480876153596*^9, 
   3.800481014855089*^9}, {3.800481049438452*^9, 3.800481072388671*^9}, {
   3.800481165541788*^9, 3.8004812534381027`*^9}, 
   3.8004813069769897`*^9},ExpressionUUID->"0244ec50-da29-4c7c-bd7f-\
d9b836eb1572"],

Cell[BoxData[
 RowBox[{
  RowBox[{"elliminateConstantOffset", "[", 
   RowBox[{"result", ":", 
    RowBox[{"{", 
     RowBox[{"_Rule", "..."}], "}"}]}], "]"}], ":=", 
  RowBox[{"Prepend", "[", 
   RowBox[{"result", ",", 
    RowBox[{"constantOffset", "\[Rule]", "0"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7993766823112307`*^9, 3.799376710222033*^9}, {
   3.799376740712891*^9, 3.7993768492772923`*^9}, {3.799376882161489*^9, 
   3.799376900502791*^9}, {3.79937716770998*^9, 3.799377206827203*^9}, {
   3.799377270201777*^9, 3.799377456721095*^9}, {3.799377869998048*^9, 
   3.7993779057268753`*^9}, {3.7993779595075293`*^9, 3.799377979732443*^9}, {
   3.799378038913011*^9, 3.7993781060524282`*^9}, {3.79937826257036*^9, 
   3.799378338295493*^9}, {3.7993783868215733`*^9, 3.799378387966238*^9}, {
   3.799378547544991*^9, 3.7993785761971684`*^9}, {3.799378669690095*^9, 
   3.79937868641782*^9}, {3.799378872716448*^9, 3.799378977295354*^9}, {
   3.799379029531514*^9, 3.799379043335432*^9}, {3.799459991137082*^9, 
   3.799460008043045*^9}, 
   3.799464754428479*^9},ExpressionUUID->"914f8428-dc4a-4925-ae24-\
6ac71c05282d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["End of this package", "Section",
 AutoGeneratedPackage->Automatic,
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.797739167479363*^9, 
  3.7977391750151367`*^9}},ExpressionUUID->"d8e8f5c0-2a56-4c3d-a820-\
67e027708ce4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]}], "Input",
 AutoGeneratedPackage->Automatic,
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.797739178210627*^9, 
  3.797739185814768*^9}},ExpressionUUID->"00daad8f-b090-4652-8725-\
3208c5705a50"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examples", "Title",
 CellChangeTimes->{{3.799464487320484*^9, 
  3.799464515443858*^9}},ExpressionUUID->"f11cf3a2-a2e4-4bf1-85c9-\
3574cf39ab17"],

Cell[BoxData[
 RowBox[{"Needs", "[", 
  "\"\<AplanaticSinglet`AsphericalFittingForInterpolated`\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.79946512916848*^9, 3.799465131778091*^9}, 
   3.801281153777872*^9, 
   3.8184629908619328`*^9},ExpressionUUID->"7a1952c8-0fb7-4e1d-9e56-\
a17a698a9cc3"]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{808, 911},
WindowMargins->{{Automatic, 254}, {Automatic, 58}},
TaggingRules->{"TryRealOnly" -> False},
FrontEndVersion->"12.2 for Mac OS X x86 (64-bit) (2021\:5e742\:67082\:65e5)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"4eb82563-a667-4f57-8292-072568bdf13b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 175, 3, 98, "Title",ExpressionUUID->"9c213115-8372-4661-ac5b-69e47ed27a83"],
Cell[758, 27, 333, 8, 83, "Author",ExpressionUUID->"b989a3f8-7774-4a0c-95fd-db179a13a6ca"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1128, 40, 189, 4, 98, "Title",ExpressionUUID->"303f3cf2-acc8-476d-a8d3-b899067af727",
 InitializationCell->True],
Cell[1320, 46, 661, 14, 68, "Input",ExpressionUUID->"4043c8ee-1d59-49ae-8c73-ad62cd3e16d0",
 InitializationCell->True],
Cell[1984, 62, 547, 12, 68, "Input",ExpressionUUID->"c8fd9fd9-7c9e-4d77-a1b8-27719a1d8f44",
 InitializationCell->True],
Cell[2534, 76, 634, 13, 110, "Input",ExpressionUUID->"bbc5044c-136a-4b47-8da4-3554fb318d61",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[3193, 93, 248, 6, 67, "Section",ExpressionUUID->"a34487c9-01c0-4e9c-8bba-4dd39b98017b",
 InitializationCell->True,
 InitializationGroup->True],
Cell[3444, 101, 359, 9, 46, "Input",ExpressionUUID->"27f1b0a2-9b0d-4d52-8e72-cb35df6f70b0",
 InitializationCell->True],
Cell[3806, 112, 429, 10, 68, "Input",ExpressionUUID->"28ec5eb9-3e28-4ec0-b43a-e3af8b9e10a5",
 InitializationCell->True],
Cell[4238, 124, 1157, 19, 215, "Input",ExpressionUUID->"c93fb3c5-c197-4729-94de-3d4f3a337cfb",
 InitializationCell->True],
Cell[5398, 145, 700, 13, 89, "Input",ExpressionUUID->"e7e93f2f-6665-4f3f-b095-ce43db045491",
 InitializationCell->True],
Cell[6101, 160, 828, 16, 89, "Input",ExpressionUUID->"13667e46-2cfb-49de-8590-bf904ac2bf29",
 InitializationCell->True],
Cell[6932, 178, 851, 16, 89, "Input",ExpressionUUID->"304103de-a0df-4cec-bc3a-b84f72f2c00c",
 InitializationCell->True],
Cell[7786, 196, 508, 11, 89, "Input",ExpressionUUID->"94896291-ce92-4f25-ba5b-1a2f24ada307",
 InitializationCell->True],
Cell[8297, 209, 437, 10, 68, "Input",ExpressionUUID->"68898247-02f2-4a93-81aa-81313d35b870",
 InitializationCell->True],
Cell[8737, 221, 507, 12, 68, "Input",ExpressionUUID->"f44f6f92-c81c-45f6-b60e-93a0199f0b9d",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[9281, 238, 238, 5, 67, "Section",ExpressionUUID->"4fdf72d2-f746-4576-bc30-284c0c7a9867",
 InitializationCell->True],
Cell[9522, 245, 355, 9, 46, "Input",ExpressionUUID->"eed464b7-4e67-4af5-b0c8-9515eadc5613",
 InitializationCell->True,
 InitializationGroup->True],
Cell[9880, 256, 2751, 62, 152, "Input",ExpressionUUID->"83de4e14-0f2a-424f-9162-9ad7145f04bd",
 InitializationCell->True],
Cell[12634, 320, 2704, 61, 194, "Input",ExpressionUUID->"fc0177a7-f6ee-4c0e-8eff-47136fb43014",
 InitializationCell->True],
Cell[15341, 383, 14768, 360, 1076, "Input",ExpressionUUID->"c1b57fb5-143f-4a0a-ba90-ec2e8cc0def0",
 InitializationCell->True],
Cell[30112, 745, 2698, 51, 46, "Input",ExpressionUUID->"0244ec50-da29-4c7c-bd7f-d9b836eb1572",
 InitializationCell->True],
Cell[32813, 798, 1160, 22, 46, "Input",ExpressionUUID->"914f8428-dc4a-4925-ae24-6ac71c05282d",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[34010, 825, 255, 6, 67, "Section",ExpressionUUID->"d8e8f5c0-2a56-4c3d-a820-67e027708ce4",
 InitializationCell->True,
 InitializationGroup->True],
Cell[34268, 833, 363, 10, 68, "Input",ExpressionUUID->"00daad8f-b090-4652-8725-3208c5705a50",
 InitializationCell->True,
 InitializationGroup->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[34680, 849, 151, 3, 98, "Title",ExpressionUUID->"f11cf3a2-a2e4-4bf1-85c9-3574cf39ab17"],
Cell[34834, 854, 297, 7, 30, "Input",ExpressionUUID->"7a1952c8-0fb7-4e1d-9e56-a17a698a9cc3"]
}, Open  ]]
}
]
*)

